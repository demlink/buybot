var Yo=Object.defineProperty,Xo=Object.defineProperties;var Ho=Object.getOwnPropertyDescriptors;var Zn=Object.getOwnPropertySymbols;var Qo=Object.prototype.hasOwnProperty,zo=Object.prototype.propertyIsEnumerable;var Fe=Math.pow,jn=(p,e,t)=>e in p?Yo(p,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):p[e]=t,U=(p,e)=>{for(var t in e||(e={}))Qo.call(e,t)&&jn(p,t,e[t]);if(Zn)for(var t of Zn(e))zo.call(e,t)&&jn(p,t,e[t]);return p},oe=(p,e)=>Xo(p,Ho(e));var _=(p,e,t)=>new Promise((n,i)=>{var r=a=>{try{s(t.next(a))}catch(m){i(m)}},o=a=>{try{s(t.throw(a))}catch(m){i(m)}},s=a=>a.done?n(a.value):Promise.resolve(a.value).then(r,o);s((t=t.apply(p,e)).next())});import{AccountLayout as Di,TOKEN_PROGRAM_ID as Ni}from"@solana/spl-token";import{Keypair as Rs,SystemProgram as xs}from"@solana/web3.js";import dr from"big.js";import cn from"bn.js";import{PublicKey as mi}from"@solana/web3.js";import{BN as $o}from"bn.js";import{PublicKey as At,SystemProgram as jo}from"@solana/web3.js";import{PublicKey as Jo}from"@solana/web3.js";var wn="1.1.0-beta.6";import"@colors/colors";var $n=!1,ei=!1,$t={debug:1,default:2,info:2,warning:3,error:4,off:5},ti={},Ln;function Zo(){try{let p=[];if(["NFD","NFC","NFKD","NFKC"].forEach(e=>{try{if("test".normalize(e)!=="test")throw new Error("bad normalize")}catch(t){p.push(e)}}),p.length)throw new Error("missing "+p.join(", "));if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw new Error("broken implementation")}catch(p){if(p instanceof Error)return p.message}return""}var ni=Zo(),oi=(r=>(r.DEBUG="DEBUG",r.INFO="INFO",r.WARNING="WARNING",r.ERROR="ERROR",r.OFF="OFF",r))(oi||{}),ri=(b=>(b.UNKNOWN_ERROR="UNKNOWN_ERROR",b.NOT_IMPLEMENTED="NOT_IMPLEMENTED",b.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",b.NETWORK_ERROR="NETWORK_ERROR",b.RPC_ERROR="RPC_ERROR",b.TIMEOUT="TIMEOUT",b.BUFFER_OVERRUN="BUFFER_OVERRUN",b.NUMERIC_FAULT="NUMERIC_FAULT",b.MISSING_NEW="MISSING_NEW",b.INVALID_ARGUMENT="INVALID_ARGUMENT",b.MISSING_ARGUMENT="MISSING_ARGUMENT",b.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",b.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",b))(ri||{}),ii="0123456789abcdef";function si(p,e=!1){let t=p;try{if(p instanceof Uint8Array){let n="";for(let i=0;i<p.length;i++)n+=ii[p[i]>>4],n+=ii[p[i]&15];t=`Uint8Array(0x${n})`}else if(p instanceof Jo)t=`PublicKey(${p.toBase58()})`;else if(p instanceof Object&&!e){let n={};Object.entries(p).forEach(([i,r])=>{n[i]=si(r,!0)}),t=JSON.stringify(n)}else e||(t=JSON.stringify(p))}catch(n){t=JSON.stringify(p.toString())}return t}var de=class{constructor(e){this.version=wn;this.moduleName=e}_log(e,t){let n=e.toLowerCase();$t[n]==null&&this.throwArgumentError("invalid log level name","logLevel",e),!((ti[this.moduleName]||$t.default)>$t[n])&&console.log(...t)}debug(...e){this._log(de.levels.DEBUG,["[DEBUG]".blue,...e])}info(...e){this._log(de.levels.INFO,["[INFO]".green,...e])}warn(...e){this._log(de.levels.WARNING,["[WARN]".yellow,...e])}makeError(e,t,n){if(ei)return this.makeError("censored error",t,{});t||(t=de.errors.UNKNOWN_ERROR),n||(n={});let i=[];Object.entries(n).forEach(([s,a])=>{i.push(`${s}=${si(a)})`)}),i.push(`code=${t}`),i.push(`module=${this.moduleName}`),i.push(`version=${this.version}`);let r=e;i.length&&(e+=" ("+i.join(", ")+")");let o=new Error(e);return o.reason=r,o.code=t,Object.entries(n).forEach(([s,a])=>{o[s]=a}),o}throwError(e,t,n){throw this.makeError(e,t,n)}throwArgumentError(e,t,n){return this.throwError(e,de.errors.INVALID_ARGUMENT,{argument:t,value:n})}assert(e,t,n,i){e||this.throwError(t,n,i)}assertArgument(e,t,n,i){e||this.throwArgumentError(t,n,i)}checkNormalize(e){e==null&&(e="platform missing String.prototype.normalize"),ni&&this.throwError("platform missing String.prototype.normalize",de.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:ni})}checkSafeUint53(e,t){typeof e=="number"&&(t==null&&(t="value not safe"),(e<0||e>=9007199254740991)&&this.throwError(t,de.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:e}),e%1&&this.throwError(t,de.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:e}))}checkArgumentCount(e,t,n){n?n=": "+n:n="",e<t&&this.throwError("missing argument"+n,de.errors.MISSING_ARGUMENT,{count:e,expectedCount:t}),e>t&&this.throwError("too many arguments"+n,de.errors.UNEXPECTED_ARGUMENT,{count:e,expectedCount:t})}checkNew(e,t){(e===Object||e==null)&&this.throwError("missing new",de.errors.MISSING_NEW,{name:t.name})}checkAbstract(e,t){e===t?this.throwError("cannot instantiate abstract class "+JSON.stringify(t.name)+" directly; use a sub-class",de.errors.UNSUPPORTED_OPERATION,{name:e.name,operation:"new"}):(e===Object||e==null)&&this.throwError("missing new",de.errors.MISSING_NEW,{name:t.name})}static globalLogger(){return Ln||(Ln=new de(wn)),Ln}static setCensorship(e,t){if(!e&&t&&this.globalLogger().throwError("cannot permanently disable censorship",de.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),$n){if(!e)return;this.globalLogger().throwError("error censorship permanent",de.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}ei=!!e,$n=!!t}static setLogLevel(e,t){let n=$t[t.toLowerCase()];if(n==null){de.globalLogger().warn("invalid log level - "+t);return}ti[e]=n}static from(e){return new de(e)}},z=de;z.errors=ri,z.levels=oi;import{ASSOCIATED_TOKEN_PROGRAM_ID as ci,TOKEN_PROGRAM_ID as W}from"@solana/spl-token";import{SYSVAR_CLOCK_PUBKEY as Nt,SYSVAR_RENT_PUBKEY as Oe}from"@solana/web3.js";var ai=z.from("common/pubkey"),pe=jo.programId,Va=new At("Memo1UhkJRfHyvLMcVucJwxXeuD728EqVDDwQDxFMNo"),en=new At("SysvarRent111111111111111111111111111111111"),Dt=new At("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s");function it(p){if(p instanceof At)return p;if(typeof p=="string")try{return new At(p)}catch(e){return ai.throwArgumentError("invalid public key","publicKey",p)}return ai.throwArgumentError("invalid public key","publicKey",p)}function ne(p,e){let[t,n]=At.findProgramAddressSync(p,e);return{publicKey:t,nonce:n}}function S(p,e){return{pubkey:p,isWritable:!0,isSigner:e}}function w(p,e){return{pubkey:p,isWritable:!1,isSigner:e}}var er=[q,mi,re,$o,We,me,le,Ae];function li(p){return typeof p=="object"&&p!==null&&!er.some(e=>typeof e=="object"&&p instanceof e)}function xe(p){return typeof p=="string"?it(p):Array.isArray(p)?p.map(e=>xe(e)):li(p)?Object.fromEntries(Object.entries(p).map(([e,t])=>[e,xe(t)])):p}function ui(p){return p instanceof mi?p.toBase58():Array.isArray(p)?p.map(e=>ui(e)):li(p)?Object.fromEntries(Object.entries(p).map(([e,t])=>[e,ui(t)])):p}import{PublicKey as tr}from"@solana/web3.js";import nr from"bn.js";function ir(){tr.prototype.inspect=function(){return`<PublicKey: ${this.toString()}>`}}function or(){nr.prototype.inspect=function(){return`<${this.red?"BN-R":"BN"}: ${this.toString()}>`}}function Ha(){ir(),or()}function di(p,e=1,t=[]){let n=[...p];if(e<=0)return t;for(;n.length;)t.push(n.splice(0,e));return t}function za(p,...e){return p.filter(t=>e.every(n=>n.includes(t)))}function Ja(p,...e){return p.filter(t=>e.every(n=>!n.includes(t)))}function Za(p){return[...new Set(p)]}import{PublicKey as In,Transaction as Ot}from"@solana/web3.js";var _e=z.from("common/web3");function Ee(p,e,t){return _(this,null,function*(){let{batchRequest:n,commitment:i}=U({batchRequest:!1},t),r=di(e,100),o=new Array(r.length).fill([]);if(n){let s=r.map(m=>({methodName:"getMultipleAccounts",args:p._buildArgs([m.map(f=>f.toBase58())],i,"base64")}));o=(yield p._rpcBatchRequest(s)).map(m=>m.error?_e.throwError("failed to get info for multiple accounts",z.errors.RPC_ERROR,{message:m.error.message}):m.result.value.map(u=>{if(u){let{data:f,executable:l,lamports:b,owner:y,rentEpoch:d}=u;return f.length!==2&&f[1]!=="base64"?_e.throwError("info must be base64 encoded",z.errors.RPC_ERROR):{data:Buffer.from(f[0],"base64"),executable:l,lamports:b,owner:new In(y),rentEpoch:d}}else return null}))}else try{o=yield Promise.all(r.map(s=>p.getMultipleAccountsInfo(s,i)))}catch(s){if(s instanceof Error)return _e.throwError("failed to get info for multiple accounts",z.errors.RPC_ERROR,{message:s.message})}return o.flat()})}function _t(p,e,t){return _(this,null,function*(){let n=yield Ee(p,e.map(i=>i.pubkey),t);return e.map((i,r)=>oe(U({},i),{accountInfo:n[r]}))})}function ct(p,e){if(p.length<1)return _e.throwArgumentError("no instructions provided","instructions",p);if(e.length<1)return _e.throwArgumentError("no signers provided","signers",e);let t=new Ot({recentBlockhash:"11111111111111111111111111111111",feePayer:e[0]});t.add(...p);try{return t.serialize({verifySignatures:!1}),!0}catch(n){return!1}}function tn(p,e,t,n=!0){return _(this,null,function*(){let i=new In("RaydiumSimuLateTransaction11111111111111111"),r=[],o=new Ot;o.feePayer=i;for(let m of e)ct([...o.instructions,m],[i])||(r.push(o),o=new Ot,o.feePayer=i),o.add(m);o.instructions.length>0&&r.push(o);let s=[];try{if(s=yield rr(p,r,n),s.find(m=>m.err!==null))throw Error("rpc simulateTransaction error")}catch(m){if(m instanceof Error)return _e.throwError("failed to simulate for instructions",z.errors.RPC_ERROR,{message:m.message})}let a=[];for(let m of s)if(_e.debug("simulate result:",m),m.logs){let u=m.logs.filter(f=>f&&f.includes(t));_e.debug("filteredLog:",a),_e.assertArgument(u.length!==0,"simulate log not match keyword","keyword",t),a.push(...u)}return a})}function nn(p,e){let t=p.match(/{["\w:,]+}/g);return!t||t.length!==1?_e.throwArgumentError("simulate log fail to match json","keyword",e):t[0]}function ge(p,e){let n=new RegExp(`"${e}":(\\d+)`,"g").exec(p);return!n||n.length!==2?_e.throwArgumentError("simulate log fail to match key","key",e):n[1]}function rr(p,e,t){return _(this,null,function*(){let n=[];if(t){let i=yield p.getLatestBlockhash(),r=[];for(let m of e){m.recentBlockhash=i.blockhash,m.lastValidBlockHeight=i.lastValidBlockHeight;let f=m._compile().serialize(),b=m._serialize(f).toString("base64");r.push(b)}let o=r.map(m=>({methodName:"simulateTransaction",args:p._buildArgs([m],void 0,"base64")})),s=[],a=20;for(let m=0;m<Math.ceil(o.length/a);m++)s.push(o.slice(m*a,(m+1)*a));n=yield(yield Promise.all(s.map(m=>_(this,null,function*(){return(yield p._rpcBatchRequest(m)).map(u=>u.result.value)})))).flat()}else try{n=yield Promise.all(e.map(i=>_(this,null,function*(){return yield(yield p.simulateTransaction(i)).value})))}catch(i){if(i instanceof Error)return _e.throwError("failed to get info for multiple accounts",z.errors.RPC_ERROR,{message:i.message})}return n})}function gt({instructions:p,signers:e,payer:t}){let n={};for(let o of e)n[o.publicKey.toString()]=o;let i=[],r=[];for(let o of p){let s=[...r,o],a=new Set(s.map(u=>u.keys.filter(f=>f.isSigner).map(f=>f.pubkey.toString())).flat()),m=[...a.values()].map(u=>new In(u));ct(s,[t,...m])?r.push(o):(i.push({transaction:new Ot().add(...r),signer:[...a.values()].map(u=>n[u]).filter(u=>u!==void 0)}),r=[o])}if(r.length>0){let o=new Set(r.map(s=>s.keys.filter(a=>a.isSigner).map(a=>a.pubkey.toString())).flat());i.push({transaction:new Ot().add(...r),signer:[...o.values()].map(s=>n[s]).filter(s=>s!==void 0)})}return i}import on from"bn.js";import Xe from"bn.js";var hn=(n=>(n[n.ROUND_DOWN=0]="ROUND_DOWN",n[n.ROUND_HALF_UP=1]="ROUND_HALF_UP",n[n.ROUND_UP=2]="ROUND_UP",n))(hn||{}),v=new Xe(0),ie=new Xe(1),Tc=new Xe(2),kc=new Xe(3),wc=new Xe(5),He=new Xe(10),pi=new Xe(100),Lc=new Xe(1e3),Ic=new Xe(1e4);var rn=z.from("entity/bignumber"),fi=9007199254740991;function E(p){return p instanceof on?p:typeof p=="string"?p.match(/^-?[0-9]+$/)?new on(p):rn.throwArgumentError("invalid BigNumberish string","value",p):typeof p=="number"?p%1?rn.throwArgumentError("BigNumberish number underflow","value",p):p>=fi||p<=-fi?rn.throwArgumentError("BigNumberish number overflow","value",p):new on(String(p)):typeof p=="bigint"?new on(p.toString()):rn.throwArgumentError("invalid BigNumberish value","value",p)}function Rn(p){return He.pow(E(p))}function xn(p,e){let t=p.divmod(e);return t.mod.isZero()?t.div:t.div.isNeg()?t.div.isubn(1):t.div.iaddn(1)}var St={symbol:"SOL",name:"Solana",decimals:9},fe={symbol:"WSOL",name:"Wrapped SOL",mint:"So11111111111111111111111111111111111111112",decimals:9,extensions:{coingeckoId:"solana"}};var c={WSOL:U({},fe),BTC:{symbol:"BTC",name:"Bitcoin",mint:"9n4nbM75f5Ui33ZbPYXn59EwSgE8CGsHtAeTH5YFeJ9E",decimals:6,extensions:{coingeckoId:"bitcoin"}},ETH:{symbol:"ETH",name:"Ethereum",mint:"2FPyTwcZLUg1MDrwsyoP4D6s1tM7hAkHYRjkNb5w6Pxk",decimals:6,extensions:{coingeckoId:"ethereum"}},USDT:{symbol:"USDT",name:"Tether",mint:"Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB",decimals:6,extensions:{coingeckoId:"tether"}},WUSDT:{symbol:"WUSDT",name:"Wrapped USDT",mint:"BQcdHdAQW1hczDbBi9hiegXAR7A98Q9jx3X3iBBBDiq4",decimals:6,extensions:{coingeckoId:"tether"}},USDC:{symbol:"USDC",name:"USD Coin",mint:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",decimals:6,extensions:{coingeckoId:"usd-coin"}},WUSDC:{symbol:"WUSDC",name:"Wrapped USDC",mint:"BXXkv6z8ykpG1yuvUDPgh732wzVHB69RnB9YgSYh3itW",decimals:6,extensions:{coingeckoId:"usd-coin"}},YFI:{symbol:"YFI",name:"YFI",mint:"3JSf5tPeuscJGtaCp5giEiDhv51gQ4v3zWg8DGgyLfAB",decimals:6,extensions:{coingeckoId:"yearn-finance"}},LINK:{symbol:"LINK",name:"Chainlink",mint:"CWE8jPTUYhdCTZYWPTe1o5DFqfdjzWKc9WKz6rSjQUdG",decimals:6,extensions:{coingeckoId:"chainlink"}},XRP:{symbol:"XRP",name:"XRP",mint:"Ga2AXHpfAF6mv2ekZwcsJFqu7wB4NV331qNH7fW9Nst8",decimals:6,extensions:{coingeckoId:"ripple"}},SUSHI:{symbol:"SUSHI",name:"SUSHI",mint:"AR1Mtgh7zAtxuxGd2XPovXPVjcSdY3i4rQYisNadjfKy",decimals:6,extensions:{coingeckoId:"sushi"}},ALEPH:{symbol:"ALEPH",name:"ALEPH",mint:"CsZ5LZkDS7h9TDKjrbL7VAwQZ9nsRu8vJLhRYfmGaN8K",decimals:6,extensions:{coingeckoId:"aleph"}},SXP:{symbol:"SXP",name:"SXP",mint:"SF3oTvfWzEP3DTwGSvUXRrGTvr75pdZNnBLAH9bzMuX",decimals:6,extensions:{coingeckoId:"swipe"}},HGET:{symbol:"HGET",name:"HGET",mint:"BtZQfWqDGbk9Wf2rXEiWyQBdBY1etnUUn6zEphvVS7yN",decimals:6,extensions:{coingeckoId:"hedget"}},CREAM:{symbol:"CREAM",name:"CREAM",mint:"5Fu5UUgbjpUvdBveb3a1JTNirL8rXtiYeSMWvKjtUNQv",decimals:6,extensions:{coingeckoId:"cream-2"}},UNI:{symbol:"UNI",name:"UNI",mint:"DEhAasscXF4kEGxFgJ3bq4PpVGp5wyUxMRvn6TzGVHaw",decimals:6,extensions:{coingeckoId:"uniswap"}},SRM:{symbol:"SRM",name:"Serum",mint:"SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt",decimals:6,extensions:{coingeckoId:"serum"}},FTT:{symbol:"FTT",name:"FTX Token",mint:"AGFEad2et2ZJif9jaGpdMixQqvW5i81aBdvKe7PHNfz3",decimals:6,extensions:{coingeckoId:"ftx-token"}},MSRM:{symbol:"MSRM",name:"MegaSerum",mint:"MSRMcoVyrFxnSgo5uXwone5SKcGhT1KEJMFEkMEWf9L",decimals:0,extensions:{coingeckoId:"megaserum"}},TOMO:{symbol:"TOMO",name:"TOMO",mint:"GXMvfY2jpQctDqZ9RoU3oWPhufKiCcFEfchvYumtX7jd",decimals:6,extensions:{coingeckoId:"tomochain"}},KARMA:{symbol:"KARMA",name:"KARMA",mint:"EcqExpGNFBve2i1cMJUTR4bPXj4ZoqmDD2rTkeCcaTFX",decimals:4,extensions:{coingeckoId:"karma-dao"}},LUA:{symbol:"LUA",name:"LUA",mint:"EqWCKXfs3x47uVosDpTRgFniThL9Y8iCztJaapxbEaVX",decimals:6,extensions:{coingeckoId:"lua-token"}},MATH:{symbol:"MATH",name:"MATH",mint:"GeDS162t9yGJuLEHPWXXGrb1zwkzinCgRwnT8vHYjKza",decimals:6,extensions:{coingeckoId:"math"}},KEEP:{symbol:"KEEP",name:"KEEP",mint:"GUohe4DJUA5FKPWo3joiPgsB7yzer7LpDmt1Vhzy3Zht",decimals:6,extensions:{coingeckoId:"keep-network"}},SWAG:{symbol:"SWAG",name:"SWAG",mint:"9F9fNTT6qwjsu4X4yWYKZpsbw5qT7o6yR2i57JF2jagy",decimals:6,extensions:{coingeckoId:"swag-finance"}},FIDA:{symbol:"FIDA",name:"Bonfida",mint:"EchesyfXePKdLtoiZSL8pBe8Myagyy8ZRqsACNCFGnvp",decimals:6,extensions:{coingeckoId:"bonfida"}},KIN:{symbol:"KIN",name:"Kin",mint:"kinXdEcpDQeHPEuQnqmUgtYykqKGVFq6CeVX5iAHJq6",decimals:5,extensions:{coingeckoId:"kin"}},MAPS:{symbol:"MAPS",name:"MAPS",mint:"MAPS41MDahZ9QdKXhVa4dWB9RuyfV4XqhyAZ8XcYepb",decimals:6,extensions:{coingeckoId:"maps"}},OXY:{symbol:"OXY",name:"Oxygen",mint:"z3dn17yLaGMKffVogeFHQ9zWVcXgqgf3PQnDsNs2g6M",decimals:6,extensions:{coingeckoId:"oxygen"}},RAY:{symbol:"RAY",name:"Raydium",mint:"4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R",decimals:6,extensions:{coingeckoId:"raydium"}},xCOPE:{symbol:"xCOPE",name:"xCOPE",mint:"3K6rftdAaQYMPunrtNRHgnK2UAtjm2JwyT2oCiTDouYE",decimals:0,extensions:{coingeckoId:"cope"}},COPE:{symbol:"COPE",name:"Cope",mint:"8HGyAAB1yoM1ttS7pXjHMa3dukTFGQggnFFH3hJZgzQh",decimals:6,extensions:{coingeckoId:"cope"}},STEP:{symbol:"STEP",name:"Step Finance",mint:"StepAscQoEioFxxWGnh2sLBDFp9d8rvKz2Yp39iDpyT",decimals:9,extensions:{coingeckoId:"step-finance"}},MEDIA:{symbol:"MEDIA",name:"Media Network",mint:"ETAtLmCmsoiEEKfNrHKJ2kYy3MoABhU6NQvpSfij5tDs",decimals:6,extensions:{coingeckoId:"media-network"}},ROPE:{symbol:"ROPE",name:"Rope Token",mint:"8PMHT4swUMtBzgHnh5U564N5sjPSiUz2cjEQzFnnP1Fo",decimals:9,extensions:{coingeckoId:"rope-token"}},MER:{symbol:"MER",name:"Mercurial",mint:"MERt85fc5boKw3BW1eYdxonEuJNvXbiMbs6hvheau5K",decimals:6,extensions:{coingeckoId:"mercurial"}},TULIP:{symbol:"TULIP",name:"Tulip Protocol",mint:"TuLipcqtGVXP9XR62wM8WWCm6a9vhLs7T1uoWBk6FDs",decimals:6,extensions:{coingeckoId:"solfarm"}},SNY:{symbol:"SNY",name:"SNY",mint:"4dmKkXNHdgYsXqBHCuMikNQWwVomZURhYvkkX5c4pQ7y",decimals:6,extensions:{coingeckoId:"synthetify-token"}},SLRS:{symbol:"SLRS",name:"SLRS",mint:"SLRSSpSLUTP7okbCUBYStWCo1vUgyt775faPqz8HUMr",decimals:6,extensions:{coingeckoId:"solrise-finance"}},WOO:{symbol:"WOO",name:"WOO Network",mint:"E5rk3nmgLUuKUiS94gg4bpWwWwyjCMtddsAXkTFLtHEy",decimals:6,extensions:{coingeckoId:"woo-network"}},BOP:{symbol:"BOP",name:"Boring Protocol",mint:"BLwTnYKqf7u4qjgZrrsKeNs2EzWkMLqVCu6j8iHyrNA3",decimals:8,extensions:{coingeckoId:"boring-protocol"}},SAMO:{symbol:"SAMO",name:"Samoyedcoin",mint:"7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU",decimals:9,extensions:{coingeckoId:"samoyedcoin"}},renBTC:{symbol:"renBTC",name:"renBTC",mint:"CDJWUqTcYTVAKXAVXoQZFes5JUFc7owSeq7eMQcDSbo5",decimals:8,extensions:{coingeckoId:"renbtc"}},renDOGE:{symbol:"renDOGE",name:"renDOGE",mint:"ArUkYE2XDKzqy77PRRGjo4wREWwqk6RXTfM9NeqzPvjU",decimals:8,extensions:{coingeckoId:"rendoge"}},LIKE:{symbol:"LIKE",name:"Only1",mint:"3bRTivrVsitbmCTGtqwp7hxXPsybkjn4XLNtPsHqa3zR",decimals:9,extensions:{coingeckoId:"only1"}},DXL:{symbol:"DXL",name:"Dexlab",mint:"GsNzxJfFn6zQdJGeYsupJWzUAm57Ba7335mfhWvFiE9Z",decimals:6,extensions:{coingeckoId:"dexlab"}},mSOL:{symbol:"mSOL",name:"Marinade staked SOL",mint:"mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So",decimals:9,extensions:{coingeckoId:"msol"}},PAI:{symbol:"PAI",name:"Parrot USD",mint:"Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS",decimals:6,extensions:{coingeckoId:"parrot-usd"}},PORT:{symbol:"PORT",name:"Port Finance",mint:"PoRTjZMPXb9T7dyU7tpLEZRQj7e6ssfAE62j2oQuc6y",decimals:6,extensions:{coingeckoId:"port-finance"}},MNGO:{symbol:"MNGO",name:"Mango",mint:"MangoCzJ36AjZyKwVj3VnYU4GTonjfVEnJmvvWaxLac",decimals:6,extensions:{coingeckoId:"mango-markets"}},CRP:{symbol:"CRP",name:"CropperFinance",mint:"DubwWZNWiNGMMeeQHPnMATNj77YZPZSAz2WVR5WjLJqz",decimals:9,extensions:{coingeckoId:"cropperfinance"}},ATLAS:{symbol:"ATLAS",name:"Star Atlas",mint:"ATLASXmbPQxBUYbxPsV97usA3fPQYEqzQBUHgiFCUsXx",decimals:8,extensions:{coingeckoId:"star-atlas"}},POLIS:{symbol:"POLIS",name:"Star Atlas DAO",mint:"poLisWXnNRwC6oBu1vHiuKQzFjGL4XDSu4g9qjz9qVk",decimals:8,extensions:{coingeckoId:"star-atlas-dao"}},GRAPE:{symbol:"GRAPE",name:"Grape Protocol",mint:"8upjSpvjcdpuzhfR1zriwg5NXkwDruejqNE9WNbPRtyA",decimals:6,extensions:{coingeckoId:"grape-2"}},GENE:{symbol:"GENE",name:"Genopets",mint:"GENEtH5amGSi8kHAtQoezp1XEXwZJ8vcuePYnXdKrMYz",decimals:9,extensions:{coingeckoId:"genopets"}},DFL:{symbol:"DFL",name:"DeFi Land",mint:"DFL1zNkaGPWm1BqAVqRjCZvHmwTFrEaJtbzJWgseoNJh",decimals:9,extensions:{coingeckoId:"defi-land"}},CHEEMS:{symbol:"CHEEMS",name:"Cheems",mint:"3FoUAsGDbvTD6YZ4wVKJgTB76onJUKz7GPEBNiR5b8wc",decimals:4,extensions:{coingeckoId:"cheems"}},stSOL:{symbol:"stSOL",name:"Lido Staked SOL",mint:"7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj",decimals:9,extensions:{coingeckoId:"lido-staked-sol"}},LARIX:{symbol:"LARIX",name:"Larix",mint:"Lrxqnh6ZHKbGy3dcrCED43nsoLkM1LTzU2jRfWe8qUC",decimals:6,extensions:{coingeckoId:"larix"}},RIN:{symbol:"RIN",name:"Aldrin",mint:"E5ndSkaB17Dm7CsD22dvcjfrYSDLCxFcMd6z8ddCk5wp",decimals:9,extensions:{coingeckoId:"aldrin"}},APEX:{symbol:"APEX",name:"ApeXit Finance",mint:"51tMb3zBKDiQhNwGqpgwbavaGH54mk8fXFzxTc1xnasg",decimals:9,extensions:{coingeckoId:"apexit-finance"}},MNDE:{symbol:"MNDE",name:"Marinade",mint:"MNDEFzGvMt87ueuHvVU9VcTqsAP5b3fTGPsHuuPA5ey",decimals:9,extensions:{coingeckoId:"marinade"}},LIQ:{symbol:"LIQ",name:"LIQ Protocol",mint:"4wjPQJ6PrkC4dHhYghwJzGBVP78DkBzA2U3kHoFNBuhj",decimals:6,extensions:{coingeckoId:"liq-protocol"}},WAG:{symbol:"WAG",name:"Waggle Network",mint:"5tN42n9vMi6ubp67Uy4NnmM5DMZYN8aS8GeB3bEDHr6E",decimals:9,extensions:{coingeckoId:"waggle-network"}},wLDO:{symbol:"wLDO",name:"wLDO",mint:"HZRCwxP2Vq9PCpPXooayhJ2bxTpo5xfpQrwB1svh332p",decimals:8,extensions:{}},SLIM:{symbol:"SLIM",name:"Solanium",mint:"xxxxa1sKNGwFtw2kFn8XauW9xq8hBZ5kVtcSesTT9fW",decimals:6,extensions:{coingeckoId:"solanium"}},PRT:{symbol:"PRT",name:"Parrot Protocol",mint:"PRT88RkA4Kg5z7pKnezeNH4mafTvtQdfFgpQTGRjz44",decimals:6,extensions:{coingeckoId:"parrot-protocol"}},SBR:{symbol:"SBR",name:"SBR",mint:"Saber2gLauYim4Mvftnrasomsv6NvAuncvMEZwcLpD1",decimals:6,extensions:{}},FAB:{symbol:"FAB",name:"Fabric",mint:"EdAhkbj5nF9sRM7XN7ewuW8C9XEUMs8P7cnoQ57SYE96",decimals:9,extensions:{coingeckoId:"fabric"}},ABR:{symbol:"ABR",name:"Allbridge",mint:"a11bdAAuV8iB2fu7X6AxAvDTo1QZ8FXB3kk5eecdasp",decimals:9,extensions:{coingeckoId:"allbridge"}},IVN:{symbol:"IVN",name:"Investin",mint:"iVNcrNE9BRZBC9Aqf753iZiZfbszeAVUoikgT9yvr2a",decimals:6,extensions:{coingeckoId:"investin"}},CYS:{symbol:"CYS",name:"Cyclos",mint:"BRLsMczKuaR5w9vSubF4j8HwEGGprVAyyVgS4EX7DKEg",decimals:6,extensions:{coingeckoId:"cyclos"}},FRKT:{symbol:"FRKT",name:"FRAKT Token",mint:"ErGB9xa24Szxbk1M28u2Tx8rKPqzL6BroNkkzk5rG4zj",decimals:8,extensions:{coingeckoId:"frakt-token"}},AURY:{symbol:"AURY",name:"Aurory",mint:"AURYydfxJib1ZkTir1Jn1J9ECYUtjb6rKQVmtYaixWPP",decimals:9,extensions:{coingeckoId:"aurory"}},SYP:{symbol:"SYP",name:"Sypool",mint:"FnKE9n6aGjQoNWRBZXy4RW6LZVao7qwBonUbiD7edUmZ",decimals:9,extensions:{coingeckoId:"sypool"}},WOOF:{symbol:"WOOF",name:"WOOF",mint:"9nEqaUcb16sQ3Tn1psbkWqyhPdLmfHWjKGymREjsAgTE",decimals:6,extensions:{coingeckoId:"woof-token"}},ORCA:{symbol:"ORCA",name:"Orca",mint:"orcaEKTdK7LKz57vaAYr9QeNsVEPfiu6QeMU1kektZE",decimals:6,extensions:{coingeckoId:"orca"}},SLND:{symbol:"SLND",name:"Solend",mint:"SLNDpmoWTVADgEdndyvWzroNL7zSi1dF9PC3xHGtPwp",decimals:6,extensions:{coingeckoId:"solend"}},weWETH:{symbol:"weWETH",name:"weWETH",mint:"7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs",decimals:8,extensions:{}},weUNI:{symbol:"weUNI",name:"weUNI",mint:"8FU95xFJhUUkyyCLU13HSzDLs7oC4QZdXQHL6SCeab36",decimals:8,extensions:{}},weSUSHI:{symbol:"weSUSHI",name:"weSUSHI",mint:"ChVzxWRmrTeSgwd3Ui3UumcN8KX7VK3WaD4KGeSKpypj",decimals:8,extensions:{}},GOFX:{symbol:"GOFX",name:"GooseFX",mint:"GFX1ZjR2P15tmrSwow6FjyDYcEkoFb4p4gJCpLBjaxHD",decimals:9,extensions:{coingeckoId:"goosefx"}},IN:{symbol:"IN",name:"Invictus",mint:"inL8PMVd6iiW3RCBJnr5AsrRN6nqr4BTrcNuQWQSkvY",decimals:9,extensions:{coingeckoId:"invictus"}},weDYDX:{symbol:"weDYDX",name:"weDYDX",mint:"4Hx6Bj56eGyw8EJrrheM6LBQAvVYRikYCWsALeTrwyRU",decimals:8,extensions:{}},STARS:{symbol:"STARS",name:"StarLaunch",mint:"HCgybxq5Upy8Mccihrp7EsmwwFqYZtrHrsmsKwtGXLgW",decimals:6,extensions:{coingeckoId:"starlaunch"}},weAXS:{symbol:"weAXS",name:"weAXS",mint:"HysWcbHiYY9888pHbaqhwLYZQeZrcQMXKQWRqS7zcPK5",decimals:8,extensions:{}},weSHIB:{symbol:"weSHIB",name:"weSHIB",mint:"CiKu4eHsVrc1eueVQeHn7qhXTcVu95gSQmBpX4utjL9z",decimals:8,extensions:{}},OXS:{symbol:"OXS",name:"Oxbull Solana",mint:"4TGxgCSJQx2GQk9oHZ8dC5m3JNXTYZHjXumKAW3vLnNx",decimals:9,extensions:{coingeckoId:"oxbull-solana"}},CWAR:{symbol:"CWAR",name:"Cryowar",mint:"HfYFjMKNZygfMC8LsQ8LtpPsPxEJoXJx4M6tqi75Hajo",decimals:9,extensions:{coingeckoId:"cryowar-token"}},UPS:{symbol:"UPS",name:"UPFI Network",mint:"EwJN2GqUGXXzYmoAciwuABtorHczTA5LqbukKXV1viH7",decimals:6,extensions:{coingeckoId:"upfi-network"}},weSAND:{symbol:"weSAND",name:"weSAND",mint:"49c7WuCZkQgc3M4qH8WuEUNXfgwupZf1xqWkDQ7gjRGt",decimals:8,extensions:{}},weMANA:{symbol:"weMANA",name:"weMANA",mint:"7dgHoN8wBZCc5wbnQ2C47TDnBMAxG4Q5L3KjP67z8kNi",decimals:8,extensions:{}},CAVE:{symbol:"CAVE",name:"Crypto Cavemen",mint:"4SZjjNABoqhbd4hnapbvoEPEqT8mnNkfbEoAwALf1V8t",decimals:6,extensions:{coingeckoId:"cave"}},JSOL:{symbol:"JSOL",name:"JPool",mint:"7Q2afV64in6N6SeZsAAB81TJzwDoD6zpqmHkzi9Dcavn",decimals:9,extensions:{coingeckoId:"jpool"}},APT:{symbol:"APT",name:"Apricot",mint:"APTtJyaRX5yGTsJU522N4VYWg3vCvSb65eam5GrPT5Rt",decimals:6,extensions:{coingeckoId:"apricot"}},SONAR:{symbol:"SONAR",name:"SonarWatch",mint:"sonarX4VtVkQemriJeLm6CKeW3GDMyiBnnAEMw1MRAE",decimals:9,extensions:{coingeckoId:"sonarwatch"}},SHILL:{symbol:"SHILL",name:"SHILL Token",mint:"6cVgJUqo4nmvQpbgrDZwyfd6RwWw5bfnCamS3M9N1fd",decimals:6,extensions:{coingeckoId:"shill-token"}},TTT:{symbol:"TTT",name:"TabTrader",mint:"FNFKRV3V8DtA3gVJN6UshMiLGYA8izxFwkNWmJbFjmRj",decimals:6,extensions:{coingeckoId:"tabtrader"}},BOKU:{symbol:"BOKU",name:"Boryoku Dragonz",mint:"CN7qFa5iYkHz99PTctvT4xXUHnxwjQ5MHxCuTJtPN5uS",decimals:9,extensions:{coingeckoId:"boku"}},MIMO:{symbol:"MIMO",name:"Million Monke",mint:"9TE7ebz1dsFo1uQ2T4oYAKSm39Y6fWuHrd6Uk6XaiD16",decimals:9,extensions:{coingeckoId:"million-monke"}},wbWBNB:{symbol:"wbWBNB",name:"wbWBNB",mint:"9gP2kCy3wA1ctvYWQk75guqXuHfrEomqydHLtcTCqiLa",decimals:8,extensions:{}},wePEOPLE:{symbol:"wePEOPLE",name:"wePEOPLE",mint:"CobcsUrt3p91FwvULYKorQejgsm5HoQdv5T8RUZ6PnLA",decimals:8,extensions:{}},XTAG:{symbol:"XTAG",name:"xHashtag",mint:"5gs8nf4wojB5EXgDUWNLwXpknzgV2YWDhveAeBZpVLbp",decimals:6,extensions:{coingeckoId:"xhashtag"}},KKO:{symbol:"KKO",name:"Kineko",mint:"kiNeKo77w1WBEzFFCXrTDRWGRWGP8yHvKC9rX6dqjQh",decimals:9,extensions:{coingeckoId:"kineko"}},VI:{symbol:"VI",name:"Vybit",mint:"7zBWymxbZt7PVHQzfi3i85frc1YRiQc23K7bh3gos8ZC",decimals:9,extensions:{coingeckoId:"vybit"}},SOLC:{symbol:"SOLC",name:"Solcubator",mint:"Bx1fDtvTN6NvE4kjdPHQXtmGSg582bZx9fGy4DQNMmAT",decimals:9,extensions:{coingeckoId:"solcubator"}},STR:{symbol:"STR",name:"Solster",mint:"9zoqdwEBKWEi9G5Ze8BSkdmppxGgVv1Kw4LuigDiNr9m",decimals:9,extensions:{coingeckoId:"solster"}},SPWN:{symbol:"SPWN",name:"Bitspawn",mint:"5U9QqCPhqXAJcEv9uyzFJd5zhN93vuPk1aNNkXnUfPnt",decimals:9,extensions:{coingeckoId:"bitspawn"}},ISOLA:{symbol:"ISOLA",name:"Intersola",mint:"333iHoRM2Awhf9uVZtSyTfU8AekdGrgQePZsKMFPgKmS",decimals:6,extensions:{coingeckoId:"intersola"}},RUN:{symbol:"RUN",name:"Run",mint:"6F9XriABHfWhit6zmMUYAQBSy6XK5VF1cHXuW5LDpRtC",decimals:9,extensions:{coingeckoId:"run"}},REAL:{symbol:"REAL",name:"Realy Metaverse",mint:"AD27ov5fVU2XzwsbvnFvb1JpCBaCB5dRXrczV9CqSVGb",decimals:9,extensions:{coingeckoId:"realy-metaverse"}},CRWNY:{symbol:"CRWNY",name:"CRWNY",mint:"CRWNYkqdgvhGGae9CKfNka58j6QQkaD5bLhKXvUYqnc1",decimals:6,extensions:{}},BLOCK:{symbol:"BLOCK",name:"Blockasset",mint:"NFTUkR4u7wKxy9QLaX2TGvd9oZSWoMo4jqSJqdMb7Nk",decimals:6,extensions:{coingeckoId:"blockasset"}},SOLAR:{symbol:"SOLAR",name:"Solar",mint:"2wmKXX1xsxLfrvjEPrt2UHiqj8Gbzwxvffr9qmNjsw8g",decimals:9,extensions:{coingeckoId:"solar"}},BASIS:{symbol:"BASIS",name:"basis.markets",mint:"Basis9oJw9j8cw53oMV7iqsgo6ihi9ALw4QR31rcjUJa",decimals:6,extensions:{coingeckoId:"basis-markets"}},SOLX:{symbol:"SOLX",name:"Soldex",mint:"CH74tuRLTYcxG7qNJCsV9rghfLXJCQJbsu7i52a8F1Gn",decimals:9,extensions:{coingeckoId:"soldex"}},CHICKS:{symbol:"CHICKS",name:"SolChicks Token",mint:"cxxShYRVcepDudXhe7U62QHvw8uBJoKFifmzggGKVC2",decimals:9,extensions:{coingeckoId:"solchicks-token"}},GST:{symbol:"GST",name:"GST",mint:"AFbX8oGjGpmVFywbVouvhQSRmiW2aR1mohfahi4Y2AdB",decimals:9,extensions:{coingeckoId:"gst"}},MBS:{symbol:"MBS",name:"MonkeyBall",mint:"Fm9rHUTF5v3hwMLbStjZXqNBBoZyGriQaFM6sTFz3K8A",decimals:6,extensions:{coingeckoId:"monkeyball"}},PRISM:{symbol:"PRISM",name:"Prism",mint:"PRSMNsEPqhGVCH1TtWiJqPjJyh2cKrLostPZTNy1o5x",decimals:6,extensions:{coingeckoId:"prism"}},MEAN:{symbol:"MEAN",name:"Meanfi",mint:"MEANeD3XDdUmNMsRGjASkSWdC8prLYsoRJ61pPeHctD",decimals:6,extensions:{coingeckoId:"meanfi"}},TINY:{symbol:"TINY",name:"Tiny Colony",mint:"HKfs24UEDQpHS5hUyKYkHd9q7GY5UQ679q2bokeL2whu",decimals:6,extensions:{coingeckoId:"tiny-colony"}},SHDW:{symbol:"SHDW",name:"GenesysGo Shadow",mint:"SHDWyBxihqiCj6YekG2GUr7wqKLeLAMK1gHZck9pL6y",decimals:9,extensions:{coingeckoId:"genesysgo-shadow"}},SCY:{symbol:"SCY",name:"Synchrony",mint:"SCYfrGCw8aDiqdgcpdGjV6jp4UVVQLuphxTDLNWu36f",decimals:9,extensions:{coingeckoId:"synchrony"}},SLC:{symbol:"SLC",name:"Solice",mint:"METAmTMXwdb8gYzyCPfXXFmZZw4rUsXX58PNsDg7zjL",decimals:6,extensions:{coingeckoId:"solice"}}},x={FIDA_RAY_V4:{symbol:"FIDA-RAY",name:"FIDA-RAY V4 LP",mint:"DsBuznXRTmzvEdb36Dx3aVLVo1XmH7r1PRZUFugLPTFv",base:c.FIDA,quote:c.RAY,decimals:c.FIDA.decimals,version:4},OXY_RAY_V4:{symbol:"OXY-RAY",name:"OXY-RAY V4 LP",mint:"FwaX9W7iThTZH5MFeasxdLpxTVxRcM7ZHieTCnYog8Yb",base:c.OXY,quote:c.RAY,decimals:c.OXY.decimals,version:4},MAPS_RAY_V4:{symbol:"MAPS-RAY",name:"MAPS-RAY V4 LP",mint:"CcKK8srfVdTSsFGV3VLBb2YDbzF4T4NM2C3UEjC39RLP",base:c.MAPS,quote:c.RAY,decimals:c.MAPS.decimals,version:4},KIN_RAY_V4:{symbol:"KIN-RAY",name:"KIN-RAY V4 LP",mint:"CHT8sft3h3gpLYbCcZ9o27mT5s3Z6VifBVbUiDvprHPW",base:c.KIN,quote:c.RAY,decimals:6,version:4},RAY_USDT_V4:{symbol:"RAY-USDT",name:"RAY-USDT V4 LP",mint:"C3sT1R3nsw4AVdepvLTLKr5Gvszr7jufyBWUCvy4TUvT",base:c.RAY,quote:c.USDT,decimals:c.RAY.decimals,version:4},SOL_USDC_V4:{symbol:"SOL-USDC",name:"SOL-USDC V4 LP",mint:"8HoQnePLqPj4M7PUDzfw8e3Ymdwgc7NLGnaTUapubyvu",base:c.WSOL,quote:c.USDC,decimals:c.WSOL.decimals,version:4},YFI_USDC_V4:{symbol:"YFI-USDC",name:"YFI-USDC V4 LP",mint:"865j7iMmRRycSYUXzJ33ZcvLiX9JHvaLidasCyUyKaRE",base:c.YFI,quote:c.USDC,decimals:c.YFI.decimals,version:4},SRM_USDC_V4:{symbol:"SRM-USDC",name:"SRM-USDC V4 LP",mint:"9XnZd82j34KxNLgQfz29jGbYdxsYznTWRpvZE3SRE7JG",base:c.SRM,quote:c.USDC,decimals:c.SRM.decimals,version:4},FTT_USDC_V4:{symbol:"FTT-USDC",name:"FTT-USDC V4 LP",mint:"75dCoKfUHLUuZ4qEh46ovsxfgWhB4icc3SintzWRedT9",base:c.FTT,quote:c.USDC,decimals:c.FTT.decimals,version:4},BTC_USDC_V4:{symbol:"BTC-USDC",name:"BTC-USDC V4 LP",mint:"2hMdRdVWZqetQsaHG8kQjdZinEMBz75vsoWTCob1ijXu",base:c.BTC,quote:c.USDC,decimals:c.BTC.decimals,version:4},SUSHI_USDC_V4:{symbol:"SUSHI-USDC",name:"SUSHI-USDC V4 LP",mint:"2QVjeR9d2PbSf8em8NE8zWd8RYHjFtucDUdDgdbDD2h2",base:c.SUSHI,quote:c.USDC,decimals:c.SUSHI.decimals,version:4},TOMO_USDC_V4:{symbol:"TOMO-USDC",name:"TOMO-USDC V4 LP",mint:"CHyUpQFeW456zcr5XEh4RZiibH8Dzocs6Wbgz9aWpXnQ",base:c.TOMO,quote:c.USDC,decimals:c.TOMO.decimals,version:4},LINK_USDC_V4:{symbol:"LINK-USDC",name:"LINK-USDC V4 LP",mint:"BqjoYjqKrXtfBKXeaWeAT5sYCy7wsAYf3XjgDWsHSBRs",base:c.LINK,quote:c.USDC,decimals:c.LINK.decimals,version:4},ETH_USDC_V4:{symbol:"ETH-USDC",name:"ETH-USDC V4 LP",mint:"13PoKid6cZop4sj2GfoBeujnGfthUbTERdE5tpLCDLEY",base:c.ETH,quote:c.USDC,decimals:c.ETH.decimals,version:4},xCOPE_USDC_V4:{symbol:"xCOPE-USDC",name:"xCOPE-USDC V4 LP",mint:"2Vyyeuyd15Gp8aH6uKE72c4hxc8TVSLibxDP9vzspQWG",base:c.xCOPE,quote:c.USDC,decimals:c.xCOPE.decimals,version:4},SOL_USDT_V4:{symbol:"SOL-USDT",name:"SOL-USDT V4 LP",mint:"Epm4KfTj4DMrvqn6Bwg2Tr2N8vhQuNbuK8bESFp4k33K",base:c.WSOL,quote:c.USDT,decimals:c.WSOL.decimals,version:4},YFI_USDT_V4:{symbol:"YFI-USDT",name:"YFI-USDT V4 LP",mint:"FA1i7fej1pAbQbnY8NbyYUsTrWcasTyipKreDgy1Mgku",base:c.YFI,quote:c.USDT,decimals:c.YFI.decimals,version:4},SRM_USDT_V4:{symbol:"SRM-USDT",name:"SRM-USDT V4 LP",mint:"HYSAu42BFejBS77jZAZdNAWa3iVcbSRJSzp3wtqCbWwv",base:c.SRM,quote:c.USDT,decimals:c.SRM.decimals,version:4},FTT_USDT_V4:{symbol:"FTT-USDT",name:"FTT-USDT V4 LP",mint:"2cTCiUnect5Lap2sk19xLby7aajNDYseFhC9Pigou11z",base:c.FTT,quote:c.USDT,decimals:c.FTT.decimals,version:4},BTC_USDT_V4:{symbol:"BTC-USDT",name:"BTC-USDT V4 LP",mint:"DgGuvR9GSHimopo3Gc7gfkbKamLKrdyzWkq5yqA6LqYS",base:c.BTC,quote:c.USDT,decimals:c.BTC.decimals,version:4},SUSHI_USDT_V4:{symbol:"SUSHI-USDT",name:"SUSHI-USDT V4 LP",mint:"Ba26poEYDy6P2o95AJUsewXgZ8DM9BCsmnU9hmC9i4Ki",base:c.SUSHI,quote:c.USDT,decimals:c.SUSHI.decimals,version:4},TOMO_USDT_V4:{symbol:"TOMO-USDT",name:"TOMO-USDT V4 LP",mint:"D3iGro1vn6PWJXo9QAPj3dfta6dKkHHnmiiym2EfsAmi",base:c.TOMO,quote:c.USDT,decimals:c.TOMO.decimals,version:4},LINK_USDT_V4:{symbol:"LINK-USDT",name:"LINK-USDT V4 LP",mint:"Dr12Sgt9gkY8WU5tRkgZf1TkVWJbvjYuPAhR3aDCwiiX",base:c.LINK,quote:c.USDT,decimals:c.LINK.decimals,version:4},ETH_USDT_V4:{symbol:"ETH-USDT",name:"ETH-USDT V4 LP",mint:"nPrB78ETY8661fUgohpuVusNCZnedYCgghzRJzxWnVb",base:c.ETH,quote:c.USDT,decimals:c.ETH.decimals,version:4},YFI_SRM_V4:{symbol:"YFI-SRM",name:"YFI-SRM V4 LP",mint:"EGJht91R7dKpCj8wzALkjmNdUUUcQgodqWCYweyKcRcV",base:c.YFI,quote:c.SRM,decimals:c.YFI.decimals,version:4},FTT_SRM_V4:{symbol:"FTT-SRM",name:"FTT-SRM V4 LP",mint:"AsDuPg9MgPtt3jfoyctUCUgsvwqAN6RZPftqoeiPDefM",base:c.FTT,quote:c.SRM,decimals:c.FTT.decimals,version:4},BTC_SRM_V4:{symbol:"BTC-SRM",name:"BTC-SRM V4 LP",mint:"AGHQxXb3GSzeiLTcLtXMS2D5GGDZxsB2fZYZxSB5weqB",base:c.BTC,quote:c.SRM,decimals:c.BTC.decimals,version:4},SUSHI_SRM_V4:{symbol:"SUSHI-SRM",name:"SUSHI-SRM V4 LP",mint:"3HYhUnUdV67j1vn8fu7ExuVGy5dJozHEyWvqEstDbWwE",base:c.SUSHI,quote:c.SRM,decimals:c.SUSHI.decimals,version:4},TOMO_SRM_V4:{symbol:"TOMO-SRM",name:"TOMO-SRM V4 LP",mint:"GgH9RnKrQpaMQeqmdbMvs5oo1A24hERQ9wuY2pSkeG7x",base:c.TOMO,quote:c.SRM,decimals:c.TOMO.decimals,version:4},LINK_SRM_V4:{symbol:"LINK-SRM",name:"LINK-SRM V4 LP",mint:"GXN6yJv12o18skTmJXaeFXZVY1iqR18CHsmCT8VVCmDD",base:c.LINK,quote:c.SRM,decimals:c.LINK.decimals,version:4},ETH_SRM_V4:{symbol:"ETH-SRM",name:"ETH-SRM V4 LP",mint:"9VoY3VERETuc2FoadMSYYizF26mJinY514ZpEzkHMtwG",base:c.ETH,quote:c.SRM,decimals:c.ETH.decimals,version:4},SRM_SOL_V4:{symbol:"SRM-SOL",name:"SRM-SOL V4 LP",mint:"AKJHspCwDhABucCxNLXUSfEzb7Ny62RqFtC9uNjJi4fq",base:c.SRM,quote:c.WSOL,decimals:c.SRM.decimals,version:4},STEP_USDC_V4:{symbol:"STEP-USDC",name:"STEP-USDC V4 LP",mint:"3k8BDobgihmk72jVmXYLE168bxxQUhqqyESW4dQVktqC",base:c.STEP,quote:c.USDC,decimals:c.STEP.decimals,version:4},MEDIA_USDC_V4:{symbol:"MEDIA-USDC",name:"MEDIA-USDC V4 LP",mint:"A5zanvgtioZGiJMdEyaKN4XQmJsp1p7uVxaq2696REvQ",base:c.MEDIA,quote:c.USDC,decimals:c.MEDIA.decimals,version:4},ROPE_USDC_V4:{symbol:"ROPE-USDC",name:"ROPE-USDC V4 LP",mint:"Cq4HyW5xia37tKejPF2XfZeXQoPYW6KfbPvxvw5eRoUE",base:c.ROPE,quote:c.USDC,decimals:c.ROPE.decimals,version:4},MER_USDC_V4:{symbol:"MER-USDC",name:"MER-USDC V4 LP",mint:"3H9NxvaZoxMZZDZcbBDdWMKbrfNj7PCF5sbRwDr7SdDW",base:c.MER,quote:c.USDC,decimals:c.MER.decimals,version:4},COPE_USDC_V4:{symbol:"COPE-USDC",name:"COPE-USDC V4 LP",mint:"Cz1kUvHw98imKkrqqu95GQB9h1frY8RikxPojMwWKGXf",base:c.COPE,quote:c.USDC,decimals:c.COPE.decimals,version:4},ALEPH_USDC_V4:{symbol:"ALEPH-USDC",name:"ALEPH-USDC V4 LP",mint:"iUDasAP2nXm5wvTukAHEKSdSXn8vQkRtaiShs9ceGB7",base:c.ALEPH,quote:c.USDC,decimals:c.ALEPH.decimals,version:4},TULIP_USDC_V4:{symbol:"TULIP-USDC",name:"TULIP-USDC V4 LP",mint:"2doeZGLJyACtaG9DCUyqMLtswesfje1hjNA11hMdj6YU",base:c.TULIP,quote:c.USDC,decimals:c.TULIP.decimals,version:4},WOO_USDC_V4:{symbol:"WOO-USDC",name:"WOO-USDC V4 LP",mint:"7cu42ao8Jgrd5A3y3bNQsCxq5poyGZNmTydkGfJYQfzh",base:c.WOO,quote:c.USDC,decimals:c.WOO.decimals,version:4},SNY_USDC_V4:{symbol:"SNY-USDC",name:"SNY-USDC V4 LP",mint:"G8qcfeFqxwbCqpxv5LpLWxUCd1PyMB5nWb5e5YyxLMKg",base:c.SNY,quote:c.USDC,decimals:c.SNY.decimals,version:4},BOP_RAY_V4:{symbol:"BOP-RAY",name:"BOP-RAY V4 LP",mint:"9nQPYJvysyfnXhQ6nkK5V7sZG26hmDgusfdNQijRk5LD",base:c.BOP,quote:c.RAY,decimals:c.BOP.decimals,version:4},SLRS_USDC_V4:{symbol:"SLRS-USDC",name:"SLRS-USDC V4 LP",mint:"2Xxbm1hdv5wPeen5ponDSMT3VqhGMTQ7mH9stNXm9shU",base:c.SLRS,quote:c.USDC,decimals:c.SLRS.decimals,version:4},SAMO_RAY_V4:{symbol:"SAMO-RAY",name:"SAMO-RAY V4 LP",mint:"HwzkXyX8B45LsaHXwY8su92NoRBS5GQC32HzjQRDqPnr",base:c.SAMO,quote:c.RAY,decimals:c.SAMO.decimals,version:4},renBTC_USDC_V4:{symbol:"renBTC-USDC",name:"renBTC-USDC V4 LP",mint:"CTEpsih91ZLo5gunvryLpJ3pzMjmt5jbS6AnSQrzYw7V",base:c.renBTC,quote:c.USDC,decimals:c.renBTC.decimals,version:4},renDOGE_USDC_V4:{symbol:"renDOGE-USDC",name:"renDOGE-USDC V4 LP",mint:"Hb8KnZNKvRxu7pgMRWJgoMSMcepfvNiBFFDDrdf9o3wA",base:c.renDOGE,quote:c.USDC,decimals:c.renDOGE.decimals,version:4},RAY_USDC_V4:{symbol:"RAY-USDC",name:"RAY-USDC V4 LP",mint:"FbC6K13MzHvN42bXrtGaWsvZY9fxrackRSZcBGfjPc7m",base:c.RAY,quote:c.USDC,decimals:c.RAY.decimals,version:4},RAY_SRM_V4:{symbol:"RAY-SRM",name:"RAY-SRM V4 LP",mint:"7P5Thr9Egi2rvMmEuQkLn8x8e8Qro7u2U7yLD2tU2Hbe",base:c.RAY,quote:c.SRM,decimals:c.RAY.decimals,version:4},RAY_ETH_V4:{symbol:"RAY-ETH",name:"RAY-ETH V4 LP",mint:"mjQH33MqZv5aKAbKHi8dG3g3qXeRQqq1GFcXceZkNSr",base:c.RAY,quote:c.ETH,decimals:c.RAY.decimals,version:4},RAY_SOL_V4:{symbol:"RAY-SOL",name:"RAY-SOL V4 LP",mint:"89ZKE4aoyfLBe2RuV6jM3JGNhaV18Nxh8eNtjRcndBip",base:c.RAY,quote:c.WSOL,decimals:c.RAY.decimals,version:4},DXL_USDC_V4:{symbol:"DXL-USDC",name:"DXL-USDC V4 LP",mint:"4HFaSvfgskipvrzT1exoVKsUZ174JyExEsA8bDfsAdY5",base:c.DXL,quote:c.USDC,decimals:c.DXL.decimals,version:4},LIKE_USDC_V4:{symbol:"LIKE-USDC",name:"LIKE-USDC V4 LP",mint:"cjZmbt8sJgaoyWYUttomAu5LJYU44ZrcKTbzTSEPDVw",base:c.LIKE,quote:c.USDC,decimals:c.LIKE.decimals,version:4},mSOL_USDC_V4:{symbol:"mSOL-USDC",name:"mSOL-USDC V4 LP",mint:"4xTpJ4p76bAeggXoYywpCCNKfJspbuRzZ79R7pRhbqSf",base:c.mSOL,quote:c.USDC,decimals:c.mSOL.decimals,version:4},mSOL_SOL_V4:{symbol:"mSOL-SOL",name:"mSOL-SOL V4 LP",mint:"5ijRoAHVgd5T5CNtK5KDRUBZ7Bffb69nktMj5n6ks6m4",base:c.mSOL,quote:c.WSOL,decimals:c.mSOL.decimals,version:4},MER_PAI_V4:{symbol:"MER-PAI",name:"MER-PAI V4 LP",mint:"DU5RT2D9EviaSmX6Ta8MZwMm85HwSEqGMRdqUiuCGfmD",base:c.MER,quote:c.PAI,decimals:c.MER.decimals,version:4},PORT_USDC_V4:{symbol:"PORT-USDC",name:"PORT-USDC V4 LP",mint:"9tmNtbUCrLS15qC4tEfr5NNeqcqpZ4uiGgi2vS5CLQBS",base:c.PORT,quote:c.USDC,decimals:c.PORT.decimals,version:4},MNGO_USDC_V4:{symbol:"MNGO-USDC",name:"MNGO-USDC V4 LP",mint:"DkiqCQ792n743xjWQVCbBUaVtkdiuvQeYndM53ReWnCC",base:c.MNGO,quote:c.USDC,decimals:c.MNGO.decimals,version:4},ATLAS_USDC_V4:{symbol:"ATLAS-USDC",name:"ATLAS-USDC V4 LP",mint:"9shGU9f1EsxAbiR567MYZ78WUiS6ZNCYbHe53WUULQ7n",base:c.ATLAS,quote:c.USDC,decimals:c.ATLAS.decimals,version:4},POLIS_USDC_V4:{symbol:"POLIS-USDC",name:"POLIS-USDC V4 LP",mint:"8MbKSBpyXs8fVneKgt71jfHrn5SWtX8n4wMLpiVfF9So",base:c.POLIS,quote:c.USDC,decimals:c.POLIS.decimals,version:4},ATLAS_RAY_V4:{symbol:"ATLAS-RAY",name:"ATLAS-RAY V4 LP",mint:"418MFhkaYQtbn529wmjLLqL6uKxDz7j4eZBaV1cobkyd",base:c.ATLAS,quote:c.RAY,decimals:c.ATLAS.decimals,version:4},POLIS_RAY_V4:{symbol:"POLIS-RAY",name:"POLIS-RAY V4 LP",mint:"9ysGKUH6WqzjQEUT4dxqYCUaFNVK9QFEa24pGzjFq8xg",base:c.POLIS,quote:c.RAY,decimals:c.POLIS.decimals,version:4},ALEPH_RAY_V4:{symbol:"ALEPH-RAY",name:"ALEPH-RAY V4 LP",mint:"n76skjqv4LirhdLok2zJELXNLdRpYDgVJQuQFbamscy",base:c.ALEPH,quote:c.RAY,decimals:c.ALEPH.decimals,version:4},TULIP_RAY_V4:{symbol:"TULIP-RAY",name:"TULIP-RAY V4 LP",mint:"3AZTviji5qduMG2s4FfWGR3SSQmNUCyx8ao6UKCPg3oJ",base:c.TULIP,quote:c.RAY,decimals:c.TULIP.decimals,version:4},SLRS_RAY_V4:{symbol:"SLRS-RAY",name:"SLRS-RAY V4 LP",mint:"2pk78vsKT3jfJAcN2zbpMUnrR57SZrxHqaZYyFgp92mM",base:c.SLRS,quote:c.RAY,decimals:c.SLRS.decimals,version:4},MER_RAY_V4:{symbol:"MER-RAY",name:"MER-RAY V4 LP",mint:"214hxy3AbKoaEKgqcg2aC1cP5R67cGGAyDEg5GDwC7Ub",base:c.MER,quote:c.RAY,decimals:c.MER.decimals,version:4},MEDIA_RAY_V4:{symbol:"MEDIA-RAY",name:"MEDIA-RAY V4 LP",mint:"9Aseg5A1JD1yCiFFdDaNNxCiJ7XzrpZFmcEmLjXFdPaH",base:c.MEDIA,quote:c.RAY,decimals:c.MEDIA.decimals,version:4},SNY_RAY_V4:{symbol:"SNY-RAY",name:"SNY-RAY V4 LP",mint:"2k4quTuuLUxrSEhFH99qcoZzvgvVEc3b5sz3xz3qstfS",base:c.SNY,quote:c.RAY,decimals:c.SNY.decimals,version:4},LIKE_RAY_V4:{symbol:"LIKE-RAY",name:"LIKE-RAY V4 LP",mint:"7xqDycbFSCpUpzkYapFeyPJWPwEpV7zdWbYf2MVHTNjv",base:c.LIKE,quote:c.RAY,decimals:c.LIKE.decimals,version:4},COPE_RAY_V4:{symbol:"COPE-RAY",name:"COPE-RAY V4 LP",mint:"A7GCVHA8NSsbdFscHdoNU41tL1TRKNmCH4K94CgcLK9F",base:c.COPE,quote:c.RAY,decimals:c.COPE.decimals,version:4},ETH_SOL_V4:{symbol:"ETH-SOL",name:"ETH-SOL V4 LP",mint:"GKfgC86iJoMjwAtcyiLu6nWnjggqUXsDQihXkP14fDez",base:c.ETH,quote:c.WSOL,decimals:c.ETH.decimals,version:4},stSOL_USDC_V4:{symbol:"stSOL-USDC",name:"stSOL-USDC V4 LP",mint:"HDUJMwYZkjUZre63xUeDhdCi8c6LgUDiBqxmP3QC3VPX",base:c.stSOL,quote:c.USDC,decimals:c.stSOL.decimals,version:4},GRAPE_USDC_V4:{symbol:"GRAPE-USDC",name:"GRAPE-USDC V4 LP",mint:"A8ZYmnZ1vwxUa4wpJVUaJgegsuTEz5TKy5CiJXffvmpt",base:c.GRAPE,quote:c.USDC,decimals:c.GRAPE.decimals,version:4},LARIX_USDC_V4:{symbol:"LARIX-USDC",name:"LARIX-USDC V4 LP",mint:"7yieit4YsNsZ9CAK8H5ZEMvvk35kPEHHeXwp6naoWU9V",base:c.LARIX,quote:c.USDC,decimals:c.LARIX.decimals,version:4},RIN_USDC_V4:{symbol:"RIN-USDC",name:"RIN-USDC V4 LP",mint:"GfCWfrZez7BDmCSEeMERVDVUaaM2TEreyYUgb2cpuS3w",base:c.RIN,quote:c.USDC,decimals:c.RIN.decimals,version:4},APEX_USDC_V4:{symbol:"APEX-USDC",name:"APEX-USDC V4 LP",mint:"444cVqYyDxJNo6FqiMb9qQWFUd7tYzFRdDuJRFrSAGnU",base:c.APEX,quote:c.USDC,decimals:c.APEX.decimals,version:4},mSOL_RAY_V4:{symbol:"mSOL-RAY",name:"mSOL-RAY V4 LP",mint:"De2EHBAdkgfc72DpShqDGG42cV3iDWh8wvvZdPsiEcqP",base:c.mSOL,quote:c.RAY,decimals:c.mSOL.decimals,version:4},MNDE_mSOL_V4:{symbol:"MNDE-mSOL",name:"MNDE-mSOL V4 LP",mint:"4bh8XCzTHSbqbWN8o1Jn4ueBdz1LvJFoEasN6K6CQ8Ny",base:c.MNDE,quote:c.mSOL,decimals:c.MNDE.decimals,version:4},LARIX_RAY_V4:{symbol:"LARIX-RAY",name:"LARIX-RAY V4 LP",mint:"ZRDfSLgWGeaYSmhdPvFNKQQhDcYdZQaue2N8YDmHX4q",base:c.LARIX,quote:c.RAY,decimals:c.LARIX.decimals,version:4},LIQ_USDC_V4:{symbol:"LIQ-USDC",name:"LIQ-USDC V4 LP",mint:"GWpD3eTfhJB5KDCcnE85dBQrjAk2CsrgDF9b52R9CrjV",base:c.LIQ,quote:c.USDC,decimals:c.LIQ.decimals,version:4},WAG_USDC_V4:{symbol:"WAG-USDC",name:"WAG-USDC V4 LP",mint:"4yykyPugitUVRewNPXXCviRvxGfsfsRMoP32z3b6FmUC",base:c.WAG,quote:c.USDC,decimals:c.WAG.decimals,version:4},ETH_mSOL_V4:{symbol:"ETH-mSOL",name:"ETH-mSOL V4 LP",mint:"HYv3grQfi8QbV7nG7EFgNK1aJSrsJ7HynXJKJVPLL2Uh",base:c.ETH,quote:c.mSOL,decimals:c.ETH.decimals,version:4},mSOL_USDT_V4:{symbol:"mSOL-USDT",name:"mSOL-USDT V4 LP",mint:"69NCmEW9mGpiWLjAcAWHq51k4ionJZmzgRfRT3wQaCCf",base:c.mSOL,quote:c.USDT,decimals:c.mSOL.decimals,version:4},BTC_mSOL_V4:{symbol:"BTC-mSOL",name:"BTC-mSOL V4 LP",mint:"92bcERNtUmuaJ6mwLSxYHZYSph37jdKxRdoYNxpcYNPp",base:c.BTC,quote:c.mSOL,decimals:c.BTC.decimals,version:4},SLIM_SOL_V4:{symbol:"SLIM-SOL",name:"SLIM-SOL V4 LP",mint:"9X4EK8E59VAVi6ChnNvvd39m6Yg9RtkBbAPq1mDVJT57",base:c.SLIM,quote:c.WSOL,decimals:c.SLIM.decimals,version:4},AURY_USDC_V4:{symbol:"AURY-USDC",name:"AURY-USDC V4 LP",mint:"Gub5dvTy4nzP82qpmpNkBxmRqjtqRddBTBqHSdNcf2oS",base:c.AURY,quote:c.USDC,decimals:c.AURY.decimals,version:4},PRT_SOL_V4:{symbol:"PRT-SOL",name:"PRT-SOL V4 LP",mint:"EcJ8Wgwt1AzSPiDpVr6aaSur8TKAsNTPmmzRACeqT68Z",base:c.PRT,quote:c.WSOL,decimals:c.PRT.decimals,version:4},LIQ_RAY_V4:{symbol:"LIQ-RAY",name:"LIQ-RAY V4 LP",mint:"49YUsDrThJosHSagCn1F59Uc9NRxbr9thVrZikUnQDXy",base:c.LIQ,quote:c.RAY,decimals:c.LIQ.decimals,version:4},SYP_SOL_V4:{symbol:"SYP-SOL",name:"SYP-SOL V4 LP",mint:"KHV6dfj2bDntzJ9z1S26cDfqWfUZdJRFmteLR6LxHwW",base:c.SYP,quote:c.WSOL,decimals:c.SYP.decimals,version:4},SYP_RAY_V4:{symbol:"SYP-RAY",name:"SYP-RAY V4 LP",mint:"FT2KZqxxM8F2h9pZtTF4PyjK88bM4YbuBzd7ZPwQ5wMB",base:c.SYP,quote:c.RAY,decimals:c.SYP.decimals,version:4},SYP_USDC_V4:{symbol:"SYP-USDC",name:"SYP-USDC V4 LP",mint:"2xJGuLAivAR1WkARRA6zP1v4jaA9jV2Qis8JfMNvrVyZ",base:c.SYP,quote:c.USDC,decimals:c.SYP.decimals,version:4},FAB_USDC_V4:{symbol:"FAB-USDC",name:"FAB-USDC V4 LP",mint:"5rTCvZq6BcApsC3VV1EEUuTJfaVd8uYhcGjwTy1By6P8",base:c.FAB,quote:c.USDC,decimals:c.FAB.decimals,version:4},WOOF_RAY_V4:{symbol:"WOOF-RAY",name:"WOOF-RAY V4 LP",mint:"H2FAnazDaGFutcmnrwDxhmdncR1Bd7GG4mhPCSUiamDX",base:c.WOOF,quote:c.RAY,decimals:c.WOOF.decimals,version:4},WOOF_USDC_V4:{symbol:"WOOF-USDC",name:"WOOF-USDC V4 LP",mint:"EFSu5TMc1ijRevaYCxUkS7uGvbhsymDHEaTK3UVdNE3q",base:c.WOOF,quote:c.USDC,decimals:c.WOOF.decimals,version:4},SLND_USDC_V4:{symbol:"SLND-USDC",name:"SLND-USDC V4 LP",mint:"EunE9uDh2cGsyJcsGuGKc6wte7kBn8iye2gzC4w2ePHn",base:c.SLND,quote:c.USDC,decimals:c.SLND.decimals,version:4},FRKT_SOL_V4:{symbol:"FRKT-SOL",name:"FRKT-SOL V4 LP",mint:"HYUKXgpjaxMXHttyrFYtv3z2rdhZ1U9QDH8zEc8BooQC",base:c.FRKT,quote:c.WSOL,decimals:c.FRKT.decimals,version:4},weWETH_SOL_V4:{symbol:"weWETH-SOL",name:"weWETH-SOL V4 LP",mint:"3hbozt2Por7bcrGod8N7kEeJNMocFFjCJrQR16TQGBrE",base:c.weWETH,quote:c.WSOL,decimals:c.weWETH.decimals,version:4},weWETH_USDC_V4:{symbol:"weWETH-USDC",name:"weWETH-USDC V4 LP",mint:"3529SBnMCDW3S3xQ52aABbRHo7PcHvpQA4no8J12L5eK",base:c.weWETH,quote:c.USDC,decimals:c.weWETH.decimals,version:4},weUNI_USDC_V4:{symbol:"weUNI-USDC",name:"weUNI-USDC V4 LP",mint:"EEC4QnT41py39QaYnzQnoYQEtDUDNa6Se8SBDgfPSN2a",base:c.weUNI,quote:c.USDC,decimals:c.weUNI.decimals,version:4},weSUSHI_USDC_V4:{symbol:"weSUSHI-USDC",name:"weSUSHI-USDC V4 LP",mint:"3wVrtQZsiDNp5yTPyfEzQHPU6iuJoMmpnWg6CTt4V8sR",base:c.weSUSHI,quote:c.USDC,decimals:c.weSUSHI.decimals,version:4},CYS_USDC_V4:{symbol:"CYS-USDC",name:"CYS-USDC V4 LP",mint:"GfV3QDzzdVUwCNSdfn6PjhmyJvjw18tn51RingWZYwk3",base:c.CYS,quote:c.USDC,decimals:c.CYS.decimals,version:4},SAMO_USDC_V4:{symbol:"SAMO-USDC",name:"SAMO-USDC V4 LP",mint:"B2PjGEP3vPf1999fUD14pYdxvSDRVBk43hxB2rgthwEY",base:c.SAMO,quote:c.USDC,decimals:c.SAMO.decimals,version:4},ABR_USDC_V4:{symbol:"ABR-USDC",name:"ABR-USDC V4 LP",mint:"ECHfxkf5zjjZFTX95QfFahNyzG7feyEKcfTdjsdrMSGU",base:c.ABR,quote:c.USDC,decimals:c.ABR.decimals,version:4},IN_USDC_V4:{symbol:"IN-USDC",name:"IN-USDC V4 LP",mint:"GbmJtVgg9fRmmmjKUYGMZeSt8wZ47cDDXasg5Y3iF4kz",base:c.IN,quote:c.USDC,decimals:c.IN.decimals,version:4},weDYDX_USDC_V4:{symbol:"weDYDX-USDC",name:"weDYDX-USDC V4 LP",mint:"BjkkMZnnzmgLqzGErzDbkk15ozv48iVKQuunpeM2Hqnk",base:c.weDYDX,quote:c.USDC,decimals:c.weDYDX.decimals,version:4},STARS_USDC_V4:{symbol:"STARS-USDC",name:"STARS-USDC V4 LP",mint:"FJ68q7NChhETcGVdinMbM2FF1Cy79dpmUi6HC83K55Hv",base:c.STARS,quote:c.USDC,decimals:c.STARS.decimals,version:4},weAXS_USDC_V4:{symbol:"weAXS-USDC",name:"weAXS-USDC V4 LP",mint:"6PSoJQ7myQ1BJtbQC6oiWR8HSecQGyoWsPYTZRJo2ci3",base:c.weAXS,quote:c.USDC,decimals:c.weAXS.decimals,version:4},weSHIB_USDC_V4:{symbol:"weSHIB-USDC",name:"weSHIB-USDC V4 LP",mint:"AcjX5pmTMGSgxkdxc3r82r6WMKBvS6eQXXFz5ck5KKUa",base:c.weSHIB,quote:c.USDC,decimals:c.weSHIB.decimals,version:4},SBR_USDC_V4:{symbol:"SBR-USDC",name:"SBR-USDC V4 LP",mint:"9FC8xTFRbgTpuZZYAYnZLxgnQ8r7FwfSBM1SWvGwgF7s",base:c.SBR,quote:c.USDC,decimals:c.SBR.decimals,version:4},OXS_USDC_V4:{symbol:"OXS-USDC",name:"OXS-USDC V4 LP",mint:"et9pdjWm97rbmsJoN183GkFV5qzTGru79GE1Zhe7NTU",base:c.OXS,quote:c.USDC,decimals:c.OXS.decimals,version:4},CWAR_USDC_V4:{symbol:"CWAR-USDC",name:"CWAR-USDC V4 LP",mint:"HjR23bxn2gtRDB2P1Tm3DLepAPPZgazsWJpLG9wqjnYR",base:c.CWAR,quote:c.USDC,decimals:c.CWAR.decimals,version:4},UPS_USDC_V4:{symbol:"UPS-USDC",name:"UPS-USDC V4 LP",mint:"9hSUZdREEsbaYaKY4FouvXr7xyAqtpdHRDoYCb6Mb28a",base:c.UPS,quote:c.USDC,decimals:c.UPS.decimals,version:4},weSAND_USDC_V4:{symbol:"weSAND-USDC",name:"weSAND-USDC V4 LP",mint:"3dADrQa7utyiCsaFeVk9r7oebW1WheowhKo5soBYKBVT",base:c.weSAND,quote:c.USDC,decimals:c.weSAND.decimals,version:4},weMANA_USDC_V4:{symbol:"weMANA-USDC",name:"weMANA-USDC V4 LP",mint:"HpUkVAPRJ5zNRuJ1ZwMXEhbMHL3gSuPb2QuSER9YUd3a",base:c.weMANA,quote:c.USDC,decimals:c.weMANA.decimals,version:4},CAVE_USDC_V4:{symbol:"CAVE-USDC",name:"CAVE-USDC V4 LP",mint:"5Gba1k3fU7Vh7UtAiBmie9vhQNNq1JfEwgn1DPGZ7NKQ",base:c.CAVE,quote:c.USDC,decimals:c.CAVE.decimals,version:4},GENE_USDC_V4:{symbol:"GENE-USDC",name:"GENE-USDC V4 LP",mint:"7GKvfHEXenNiWYbJBKae89mdaMPr5gGMYwZmyC8gBNVG",base:c.GENE,quote:c.USDC,decimals:c.GENE.decimals,version:4},GENE_RAY_V4:{symbol:"GENE-RAY",name:"GENE-RAY V4 LP",mint:"3HzXnc1qZ8mGqun18Ck3KA616XnZNqF1RWbgYE2nGRMA",base:c.GENE,quote:c.RAY,decimals:c.GENE.decimals,version:4},APT_USDC_V4:{symbol:"APT-USDC",name:"APT-USDC V4 LP",mint:"Hk8mDAJFq4E9kF3DtNgPFwzbo5kbeiusNFJgWmo3LoQ5",base:c.APT,quote:c.USDC,decimals:c.APT.decimals,version:4},GOFX_USDC_V4:{symbol:"GOFX-USDC",name:"GOFX-USDC V4 LP",mint:"4svqAwrLPGRDCQuuieYTmtLXF75wiahjeK2rEN9tY1YL",base:c.GOFX,quote:c.USDC,decimals:c.GOFX.decimals,version:4},SONAR_USDC_V4:{symbol:"SONAR-USDC",name:"SONAR-USDC V4 LP",mint:"2tAcfqJ1YYjpGLqwh76kyNt9VaNFDd4fJySfH6SmWfKt",base:c.SONAR,quote:c.USDC,decimals:c.SONAR.decimals,version:4},JSOL_SOL_V4:{symbol:"JSOL-SOL",name:"JSOL-SOL V4 LP",mint:"61z37rpHsU6d3Fq5sUjJ85K6tXGzkoYKDAG3kPJQNDRo",base:c.JSOL,quote:c.WSOL,decimals:c.JSOL.decimals,version:4},JSOL_USDC_V4:{symbol:"JSOL-USDC",name:"JSOL-USDC V4 LP",mint:"3JZqf2VPNxj1kDZQsfzC7myM6spsGQbGuFv1gVfdYosN",base:c.JSOL,quote:c.USDC,decimals:c.JSOL.decimals,version:4},SHILL_USDC_V4:{symbol:"SHILL-USDC",name:"SHILL-USDC V4 LP",mint:"CnUhYBtQEbSBZ76bgxAouVCTCb8rofZzwerVF5z5LREJ",base:c.SHILL,quote:c.USDC,decimals:c.SHILL.decimals,version:4},DFL_USDC_V4:{symbol:"DFL-USDC",name:"DFL-USDC V4 LP",mint:"Fffijd6UVJdQeLVXhenS8YcsnMUdWJqpbBeH42LFkXgS",base:c.DFL,quote:c.USDC,decimals:c.DFL.decimals,version:4},BOKU_USDC_V4:{symbol:"BOKU-USDC",name:"BOKU-USDC V4 LP",mint:"8jjQn5Yagb6Nm2WGAxPW1bcGqrTWpg5adf6QukXEarcP",base:c.BOKU,quote:c.USDC,decimals:c.BOKU.decimals,version:4},MIMO_SOL_V4:{symbol:"MIMO-SOL",name:"MIMO-SOL V4 LP",mint:"HUJ1opSk8AiPfDT47r7n4hTiK2EXgrR3Msy7T8q1BywS",base:c.MIMO,quote:c.WSOL,decimals:c.MIMO.decimals,version:4},wbWBNB_USDC_V4:{symbol:"wbWBNB-USDC",name:"wbWBNB-USDC V4 LP",mint:"FEsEfEJJSfiMQcshUgZ5UigfytfGRQ3z5puyF6DXDp9C",base:c.wbWBNB,quote:c.USDC,decimals:c.wbWBNB.decimals,version:4},wePEOPLE_USDC_V4:{symbol:"wePEOPLE-USDC",name:"wePEOPLE-USDC V4 LP",mint:"3e5ZCKi4etorpV4pv1fSckP5iJD67xcUkx3RtFCZhbzD",base:c.wePEOPLE,quote:c.USDC,decimals:c.wePEOPLE.decimals,version:4},ISOLA_USDT_V4:{symbol:"ISOLA-USDT",name:"ISOLA-USDT V4 LP",mint:"H8s1wQsZpRK61pyLF3XwyQc6E8vNUnwRDhy3TBDCDENQ",base:c.ISOLA,quote:c.USDT,decimals:c.ISOLA.decimals,version:4},SPWN_USDC_V4:{symbol:"SPWN-USDC",name:"SPWN-USDC V4 LP",mint:"B5uyCAQcX6nAjZypLgiivbEKabSptgUb8JK9tkaSnqdW",base:c.SPWN,quote:c.USDC,decimals:c.SPWN.decimals,version:4},STR_USDC_V4:{symbol:"STR-USDC",name:"STR-USDC V4 LP",mint:"8uDVKmVwNmbXHDB7rNKqtpcT9VAsFHTJ5pPYxjyoBbNg",base:c.STR,quote:c.USDC,decimals:c.STR.decimals,version:4},SOLC_USDT_V4:{symbol:"SOLC-USDT",name:"SOLC-USDT V4 LP",mint:"2g9JzTWycLzK4KEBBHsponAtZRee2ii63bRrJ8tefEyt",base:c.SOLC,quote:c.USDT,decimals:c.SOLC.decimals,version:4},VI_USDC_V4:{symbol:"VI-USDC",name:"VI-USDC V4 LP",mint:"3MwHyHCRfVqtH3ABFtdKXdY9dwemr9GGxQFaBkeq6NjY",base:c.VI,quote:c.USDC,decimals:c.VI.decimals,version:4},KKO_USDC_V4:{symbol:"KKO-USDC",name:"KKO-USDC V4 LP",mint:"7xr1Doc1NiMWbUg99YVFqQSLfYXNzo6YvacXUsSgBMNW",base:c.KKO,quote:c.USDC,decimals:c.KKO.decimals,version:4},XTAG_USDC_V4:{symbol:"XTAG-USDC",name:"XTAG-USDC V4 LP",mint:"GCEQbLg4ik5YJ4CMcbtuVqEc4sjLdSGy34rFk1CtGjdg",base:c.XTAG,quote:c.USDC,decimals:c.XTAG.decimals,version:4},TTT_USDC_V4:{symbol:"TTT-USDC",name:"TTT-USDC V4 LP",mint:"84fmrerHGohoRf4iLPDQ1KG4CjSjCRksYWGzjWfCRM8a",base:c.TTT,quote:c.USDC,decimals:c.TTT.decimals,version:4},RUN_USDC_V4:{symbol:"RUN-USDC",name:"RUN-USDC V4 LP",mint:"CjTLvvKSQdEujcSzeZRYgk4w1DpuXBbMppLHaxZyz11Y",base:c.RUN,quote:c.USDC,decimals:c.RUN.decimals,version:4},CRWNY_USDC_V4:{symbol:"CRWNY-USDC",name:"CRWNY-USDC V4 LP",mint:"H3D9Gyi4frRLW6bS9vBthDVDJyzyRJ6XhhpP6PJGWaDC",base:c.CRWNY,quote:c.USDC,decimals:c.CRWNY.decimals,version:4},CRWNY_RAY_V4:{symbol:"CRWNY-RAY",name:"CRWNY-RAY V4 LP",mint:"5Cz9wGStNjiUg81q8t6sJJeckuT2C14CYSfyQbtYirSX",base:c.CRWNY,quote:c.RAY,decimals:c.CRWNY.decimals,version:4},BLOCK_USDC_V4:{symbol:"BLOCK-USDC",name:"BLOCK-USDC V4 LP",mint:"8i44Y23GkkwDYZ5iSkVEqmrXUfwNmwo9grguTDWKM8wg",base:c.BLOCK,quote:c.USDC,decimals:c.BLOCK.decimals,version:4},REAL_USDC_V4:{symbol:"REAL-USDC",name:"REAL-USDC V4 LP",mint:"EN43tp8xdkcM8RYSJ4msFHMPTJRXKhUteVYBDJLwTvr3",base:c.REAL,quote:c.USDC,decimals:c.REAL.decimals,version:4},FRKT_USDC_V4:{symbol:"FRKT-USDC",name:"FRKT-USDC V4 LP",mint:"7MgzqVTGeA4wENme81QPTrPy45NJMKVL9XGwxmNT87cG",base:c.FRKT,quote:c.USDC,decimals:c.FRKT.decimals,version:4},MBS_USDC_V4:{symbol:"MBS-USDC",name:"MBS-USDC V4 LP",mint:"BAgSWaPZpsQKyZJdvB5KyvmCNj6hzczzentt5FhDCVHb",base:c.MBS,quote:c.USDC,decimals:c.MBS.decimals,version:4},PRISM_USDC_V4:{symbol:"PRISM-USDC",name:"PRISM-USDC V4 LP",mint:"3baYkTcudvSFMe25UpZcBfdp4FA5kL2E4pfaeJ8AiYJB",base:c.PRISM,quote:c.USDC,decimals:c.PRISM.decimals,version:4},CHICKS_USDC_V4:{symbol:"CHICKS-USDC",name:"CHICKS-USDC V4 LP",mint:"CPzmcw81a6PDasSXhVLfDRKuTJXZPUqocS9VFf5zCFhs",base:c.CHICKS,quote:c.USDC,decimals:c.CHICKS.decimals,version:4},MEAN_RAY_V4:{symbol:"MEAN-RAY",name:"MEAN-RAY V4 LP",mint:"H9wUyrxpAErmdNVPitpHSXgwoomoh91ggJKPWtQQoCn1",base:c.MEAN,quote:c.RAY,decimals:c.MEAN.decimals,version:4},TINY_USDC_V4:{symbol:"TINY-USDC",name:"TINY-USDC V4 LP",mint:"Hho6ZzRDj49L4z6zog8nQZFaxMSz6FX6wNzVpMeAMen",base:c.TINY,quote:c.USDC,decimals:c.TINY.decimals,version:4},SCY_USDC_V4:{symbol:"SCY-USDC",name:"SCY-USDC V4 LP",mint:"EcYk7t6Vw59HDnY2u6H1KDPkk8juMeA1NpGpHiGk1LDf",base:c.SCY,quote:c.USDC,decimals:c.SCY.decimals,version:4}};var Vc={WSOL:U({},fe)},Uc={};var qc={WSOL:U({},fe)},Fc={};var sn=z.from("token/util"),yi=class{constructor(e){this.tokenList=e;this.filterByMint=e=>this.tokenList.filter(t=>t.mint===e);this.filterUniqueByMint=(e,t="all")=>{let n=this.tokenList.filter(r=>r.mint===e);if(n.length===0)return sn.throwArgumentError("No token found","mint",e);if(n.length>1)return sn.throwArgumentError(`Multiple tokens found: ${n.length}`,"mint",e);let i=n[0];return t==="spl"&&"version"in i?sn.throwArgumentError("invalid SPL token mint","mint",e):t==="lp"&&!("version"in i)?sn.throwArgumentError("invalid LP token mint","mint",e):i};this.getList=()=>this.tokenList}};var Bn=class{constructor(e,t="UNKNOWN",n="UNKNOWN"){this.decimals=e,this.symbol=t,this.name=n}},We=Bn;We.SOL=new Bn(St.decimals,St.symbol,St.name);function iu(){We.prototype.inspect=function(){return`<Currency: decimals=${this.decimals}, name=${this.name}, symbol=${this.symbol}>`}}var Cn=class extends We{constructor(t,n,i="UNKNOWN",r="UNKNOWN"){super(n,i,r);this.mint=it(t)}equals(t){return this===t?!0:this.mint.equals(t.mint)}},B=Cn;B.WSOL=new Cn(fe.mint,fe.decimals,St.symbol,St.name);function ou(){B.prototype.inspect=function(){return`<Token: mint=${this.mint.toBase58()}, decimals=${this.decimals}, name=${this.name}, symbol=${this.symbol}>`}}function Qe(p,e){return p instanceof B&&e instanceof B?p.equals(e):p instanceof B||e instanceof B?!1:p===e}import cr from"big.js";import ur from"decimal.js-light";import sr from"toformat";var ar=sr,Et=ar;var an=z.from("entity/fraction"),Pt=Et(cr),Vt=Et(ur),mr={[0]:Vt.ROUND_DOWN,[1]:Vt.ROUND_HALF_UP,[2]:Vt.ROUND_UP},lr={[0]:Pt.roundDown,[1]:Pt.roundHalfUp,[2]:Pt.roundUp},re=class{constructor(e,t=ie){this.numerator=E(e),this.denominator=E(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new re(this.denominator,this.numerator)}add(e){let t=e instanceof re?e:new re(E(e));return this.denominator.eq(t.denominator)?new re(this.numerator.add(t.numerator),this.denominator):new re(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof re?e:new re(E(e));return this.denominator.eq(t.denominator)?new re(this.numerator.sub(t.numerator),this.denominator):new re(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof re?e:new re(E(e));return new re(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof re?e:new re(E(e));return new re(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},n=1){an.assert(Number.isInteger(e),`${e} is not an integer.`),an.assert(e>0,`${e} is not positive.`),Vt.set({precision:e+1,rounding:mr[n]});let i=new Vt(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return i.toFormat(i.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},n=1){return an.assert(Number.isInteger(e),`${e} is not an integer.`),an.assert(e>=0,`${e} is negative.`),Pt.DP=e,Pt.RM=lr[n],new Pt(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}};var ot=z.from("entity/amount"),bi=Et(dr);function pr(p,e){let t="0",n="0";if(p.includes(".")){let i=p.split(".");if(i.length===2)[t,n]=i,n=n.padEnd(e,"0");else return ot.throwArgumentError("invalid number string","num",p)}else t=p;return[t,n.slice(0,e)||n]}var me=class extends re{constructor(t,n,i=!0){let r=new cn(0),o=He.pow(new cn(t.decimals));if(i)r=E(n);else{let s=new cn(0),a=new cn(0);if(typeof n=="string"||typeof n=="number"||typeof n=="bigint"){let[m,u]=pr(n.toString(),t.decimals);s=E(m),a=E(u)}s=s.mul(o),r=s.add(a)}super(r,o);this.currency=t}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(t){return ot.assert(Qe(this.currency,t.currency),"gt currency not equals"),this.raw.gt(t.raw)}lt(t){return ot.assert(Qe(this.currency,t.currency),"lt currency not equals"),this.raw.lt(t.raw)}add(t){return ot.assert(Qe(this.currency,t.currency),"add currency not equals"),new me(this.currency,this.raw.add(t.raw))}sub(t){return ot.assert(Qe(this.currency,t.currency),"sub currency not equals"),new me(this.currency,this.raw.sub(t.raw))}toSignificant(t=this.currency.decimals,n,i=0){return super.toSignificant(t,n,i)}toFixed(t=this.currency.decimals,n,i=0){return ot.assert(t<=this.currency.decimals,"decimals overflow"),super.toFixed(t,n,i)}toExact(t={groupSeparator:""}){return bi.DP=this.currency.decimals,new bi(this.numerator.toString()).div(this.denominator.toString()).toFormat(t)}},q=class extends me{constructor(t,n,i=!0){super(t,n,i);this.token=t}add(t){return ot.assert(Qe(this.token,t.token),"add token not equals"),new q(this.token,this.raw.add(t.raw))}subtract(t){return ot.assert(Qe(this.token,t.token),"sub token not equals"),new q(this.token,this.raw.sub(t.raw))}};var Ai=new re(pi),Ae=class extends re{toSignificant(e=5,t,n){return this.mul(Ai).toSignificant(e,t,n)}toFixed(e=2,t,n){return this.mul(Ai).toFixed(e,t,n)}};var fr=z.from("entity/price"),le=class extends re{constructor(t,n,i,r){super(r,n);this.baseCurrency=t,this.quoteCurrency=i,this.scalar=new re(Rn(t.decimals),Rn(i.decimals))}get raw(){return new re(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new le(this.quoteCurrency,this.numerator,this.baseCurrency,this.denominator)}mul(t){fr.assert(Qe(this.quoteCurrency,t.baseCurrency),"mul currency not equals");let n=super.mul(t);return new le(this.baseCurrency,n.denominator,t.quoteCurrency,n.numerator)}toSignificant(t=this.quoteCurrency.decimals,n,i){return this.adjusted.toSignificant(t,n,i)}toFixed(t=this.quoteCurrency.decimals,n,i){return this.adjusted.toFixed(t,n,i)}};import{PublicKey as ss}from"@solana/web3.js";import wi,{isBN as Li}from"bn.js";import{bits as yr,BitStructure as br,blob as Ar,Blob as gr,cstr as Sr,f32 as Pr,f32be as Tr,f64 as kr,f64be as wr,greedy as Lr,Layout as Ir,ns64 as hr,ns64be as Rr,nu64 as xr,nu64be as Br,offset as Cr,s16 as Dr,s16be as Nr,s24 as Or,s24be as _r,s32 as Er,s32be as Vr,s40 as Ur,s40be as Mr,s48 as vr,s48be as Kr,s8 as qr,seq as Fr,struct as Zu,Structure as Wr,u16 as Gr,u16be as Yr,u24 as Xr,u24be as Hr,u32 as Qr,u32be as zr,u40 as Jr,u40be as Zr,u48 as jr,u48be as $r,u8 as es,UInt as ts,union as ns,Union as is,unionLayoutDiscriminator as os,utf8 as rs}from"@solana/buffer-layout";var Ut=Ir,gi=Wr,Si=is,ju=br,Dn=ts,Pi=gr,$u=Lr,un=es,rt=Gr,em=Xr,Mt=Qr,tm=Jr,nm=jr,im=xr,om=Yr,rm=Hr,sm=zr,am=Zr,cm=$r,um=Br,mm=qr,lm=Dr,dm=Or,Be=Er,pm=Ur,fm=vr,ym=hr,bm=Nr,Am=_r,gm=Vr,Sm=Mr,Pm=Kr,Tm=Rr,km=Pr,wm=Tr,Lm=kr,Im=wr;var Ti=Fr,ki=ns,hm=os,ce=Ar,Rm=Sr,xm=rs,Nn=yr,On=Cr;var Tt=class extends Ut{constructor(t,n,i){super(t,i);this.blob=ce(t),this.signed=n}decode(t,n=0){let i=new wi(this.blob.decode(t,n),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(t,n,i=0){return typeof t=="number"&&(t=new wi(t)),this.signed&&(t=t.toTwos(this.span*8)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),n,i)}},mn=class extends Ut{constructor(t){super(8,t);this._lower=Nn(Mt(),!1),this._upper=Nn(Mt(),!1)}addBoolean(t){this._lower.fields.length<32?this._lower.addBoolean(t):this._upper.addBoolean(t)}decode(t,n=0){let i=this._lower.decode(t,n),r=this._upper.decode(t,n+this._lower.span);return U(U({},i),r)}encode(t,n,i=0){return this._lower.encode(t,n,i)+this._upper.encode(t,n,i+this._lower.span)}};function V(p){return new Dn(1,p)}function he(p){return new Dn(4,p)}function A(p){return new Tt(8,!1,p)}function K(p){return new Tt(16,!1,p)}function Om(p){return new Tt(8,!0,p)}function Ii(p){return new Tt(16,!0,p)}var ze=class extends Ut{constructor(t,n,i,r){super(t.span,r);this.layout=t,this.decoder=n,this.encoder=i}decode(t,n){return this.decoder(this.layout.decode(t,n))}encode(t,n,i){return this.layout.encode(this.encoder(t),n,i)}getSpan(t,n){return this.layout.getSpan(t,n)}};function R(p){return new ze(ce(32),e=>new ss(e),e=>e.toBuffer(),p)}var _n=class extends Ut{constructor(t,n){super(-1,n);this.layout=t,this.discriminator=un()}encode(t,n,i=0){return t==null?this.discriminator.encode(0,n,i):(this.discriminator.encode(1,n,i),this.layout.encode(t,n,i+1)+1)}decode(t,n=0){let i=this.discriminator.decode(t,n);if(i===0)return null;if(i===1)return this.layout.decode(t,n+1);throw new Error("Invalid option "+this.property)}getSpan(t,n=0){let i=this.discriminator.decode(t,n);if(i===0)return 1;if(i===1)return this.layout.getSpan(t,n+1)+1;throw new Error("Invalid option "+this.property)}};function _m(p,e){return new _n(p,e)}function ln(p){return new ze(un(),as,cs,p)}function as(p){if(p===0)return!1;if(p===1)return!0;throw new Error("Invalid bool: "+p)}function cs(p){return p?1:0}function Em(p,e){let t=Mt("length"),n=C([t,F(p,On(t,-t.span),"values")]);return new ze(n,({values:i})=>i,i=>({values:i}),e)}function Vm(p,e,t){let n=C([A("tag"),e.replicate("data")]);function i({tag:r,data:o}){if(!r.eq(p))throw new Error("Invalid tag, expected: "+p.toString("hex")+", got: "+r.toString("hex"));return o}return new ze(n,i,r=>({tag:p,data:r}),t)}function us(p){let e=Mt("length"),t=C([e,ce(On(e,-e.span),"data")]);return new ze(t,({data:n})=>n,n=>({data:n}),p)}function Um(p){return new ze(us(),e=>e.toString("utf-8"),e=>Buffer.from(e,"utf-8"),p)}function Mm(p,e){let t=ki(un(),e);return p.forEach((n,i)=>t.addVariant(i,n,n.property)),t}function vm(p,e,t){let n=C([F(p,e,"values")]);return new ze(n,({values:i})=>i,i=>({values:i}),t)}var En=class extends gi{decode(e,t){return super.decode(e,t)}};function C(p,e,t){return new En(p,e,t)}var Vn=class extends Si{encodeInstruction(e){let t=Math.max(...Object.values(this.registry).map(i=>i.span)),n=Buffer.alloc(t);return n.slice(0,this.encode(e,n))}decodeInstruction(e){return this.decode(e)}};function Km(p,e,t){return new Vn(p,e,t)}var Un=class extends Pi{decode(e,t){let n=super.decode(e,t);if(!n.every(i=>i===0))throw new Error("nonzero padding bytes");return n}};function qm(p){return new Un(p)}function F(p,e,t){let n,i=typeof e=="number"?e:Li(e)?e.toNumber():new Proxy(e,{get(r,o){if(!n){let s=Reflect.get(r,"count");n=Li(s)?s.toNumber():s,Reflect.set(r,"count",n)}return Reflect.get(r,o)},set(r,o,s){return o==="count"&&(n=s),Reflect.set(r,o,s)}});return Ti(p,i,t)}var Hm=C([he("mintAuthorityOption"),R("mintAuthority"),A("supply"),V("decimals"),V("isInitialized"),he("freezeAuthorityOption"),R("freezeAuthority")]),Ge=C([R("mint"),R("owner"),A("amount"),he("delegateOption"),R("delegate"),V("state"),he("isNativeOption"),A("isNative"),A("delegatedAmount"),he("closeAuthorityOption"),R("closeAuthority")]);import{createAssociatedTokenAccountInstruction as As,createCloseAccountInstruction as gs,createInitializeAccountInstruction as Ss,createInitializeMintInstruction as Ps,createMintToInstruction as Ts,createTransferInstruction as ks}from"@solana/spl-token";import{Keypair as ws,SystemProgram as Ls,TransactionInstruction as Is}from"@solana/web3.js";import hs from"bn.js";import{PublicKey as ms}from"@solana/web3.js";function hi(p){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,p,!1),new Uint8Array(e)}function zm(p){let e=new ArrayBuffer(2);return new DataView(e).setInt16(0,p,!1),new Uint8Array(e)}function Jm(p){let e=new ArrayBuffer(4);return new DataView(e).setUint32(0,p,!1),new Uint8Array(e)}function dn(p){let e=new ArrayBuffer(4);return new DataView(e).setInt32(0,p,!1),new Uint8Array(e)}var ls=Buffer.from("amm_config","utf8"),ds=Buffer.from("pool","utf8"),ps=Buffer.from("pool_vault","utf8"),fs=Buffer.from("pool_reward_vault","utf8"),Ri=Buffer.from("position","utf8"),ys=Buffer.from("tick_array","utf8"),bs=Buffer.from("operation","utf8");function tl(p,e){return ne([ls,hi(e)],p)}function xi(p,e,t,n){return ne([ds,e.toBuffer(),t.toBuffer(),n.toBuffer()],p)}function Mn(p,e,t){return ne([ps,e.toBuffer(),t.toBuffer()],p)}function Bi(p,e,t){return ne([fs,e.toBuffer(),t.toBuffer()],p)}function Se(p,e,t){return ne([ys,e.toBuffer(),dn(t)],p)}function pn(p,e,t,n){return ne([Ri,e.toBuffer(),dn(t),dn(n)],p)}function kt(p,e){return ne([Ri,e.toBuffer()],p)}function Ue(p,e){return ne([p.toBuffer(),W.toBuffer(),e.toBuffer()],new ms("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"))}function Ci(p){return ne([Buffer.from("metadata","utf8"),Dt.toBuffer(),p.toBuffer()],Dt)}function fn(p){return ne([bs],p)}var ee=class{static getAssociatedTokenAccount({mint:e,owner:t}){return Ue(t,e).publicKey}static makeCreateAssociatedTokenAccountInstruction({mint:e,associatedAccount:t,owner:n,payer:i}){return As(i,t,n,e)}static makeCreateWrappedNativeAccountInstructions(o){return _(this,arguments,function*({connection:e,owner:t,payer:n,amount:i,commitment:r}){let s=[],a=yield e.getMinimumBalanceForRentExemption(Ge.span,r),m=E(i).add(new hs(a)),u=ws.generate();return s.push(Ls.createAccount({fromPubkey:n,newAccountPubkey:u.publicKey,lamports:m.toNumber(),space:Ge.span,programId:W})),s.push(this.makeInitAccountInstruction({mint:it(fe.mint),tokenAccount:u.publicKey,owner:t})),{newAccount:u,instructions:s}})}static insertCreateWrappedNativeAccountInstructions(a){return _(this,arguments,function*({connection:e,owner:t,payer:n,amount:i,instructions:r,signers:o,commitment:s}){let{newAccount:m,instructions:u}=yield this.makeCreateWrappedNativeAccountInstructions({connection:e,owner:t,payer:n,amount:i,commitment:s});return r.push(...u),o.push(m),m.publicKey})}static makeInitMintInstruction({mint:e,decimals:t,mintAuthority:n,freezeAuthority:i=null}){return Ps(e,t,n,i)}static makeMintToInstruction({mint:e,dest:t,authority:n,amount:i,multiSigners:r=[]}){return Ts(e,t,n,BigInt(String(i)),r)}static makeInitAccountInstruction({mint:e,tokenAccount:t,owner:n}){return Ss(t,e,n)}static makeTransferInstruction({source:e,destination:t,owner:n,amount:i,multiSigners:r=[]}){return ks(e,t,n,BigInt(String(i)),r)}static makeCloseAccountInstruction({tokenAccount:e,owner:t,payer:n,multiSigners:i=[]}){return gs(e,n,t,i)}static createInitAccountInstruction(e,t,n,i){let r=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:Oe,isSigner:!1,isWritable:!1}],o=V("instruction"),s=Buffer.alloc(o.span);return o.encode(1,s),new Is({keys:r,programId:e,data:s})}};var Ie=class{static _selectTokenAccount(e){let{tokenAccounts:t,mint:n,owner:i,config:r}=e,{associatedOnly:o}=U({associatedOnly:!0},r),s=t.filter(({accountInfo:m})=>m.mint.equals(n)).sort((m,u)=>m.accountInfo.amount.lt(u.accountInfo.amount)?1:-1),a=ee.getAssociatedTokenAccount({mint:n,owner:i});for(let m of s){let{pubkey:u}=m;if(o){if(a.equals(u))return u}else return u}return null}static _handleTokenAccount(e){return _(this,null,function*(){let{connection:t,side:n,amount:i,mint:r,tokenAccount:o,owner:s,payer:a=s,frontInstructions:m,endInstructions:u,signers:f,bypassAssociatedCheck:l}=e,b=ee.getAssociatedTokenAccount({mint:r,owner:s});if(B.WSOL.mint.equals(r)){let y=yield ee.insertCreateWrappedNativeAccountInstructions({connection:t,owner:s,payer:a,instructions:m,signers:f,amount:i});return u&&u.push(ee.makeCloseAccountInstruction({tokenAccount:y,owner:s,payer:a})),y}else if(!o||n==="out"&&!b.equals(o)&&!l)return m.push(ee.makeCreateAssociatedTokenAccountInstruction({mint:r,associatedAccount:b,owner:s,payer:a})),b;return o})}static _selectOrCreateTokenAccount(e){return _(this,null,function*(){var m,u;let{mint:t,tokenAccounts:n,createInfo:i,associatedOnly:r,owner:o}=e,s=ee.getAssociatedTokenAccount({mint:t,owner:o}),a=n.filter(f=>f.accountInfo.mint.equals(t)&&(!r||f.pubkey.equals(s))).sort((f,l)=>f.accountInfo.amount.lt(l.accountInfo.amount)?1:-1);if(i===void 0||a.length>0)return a.length>0?a[0].pubkey:void 0;if(r){if(i.frontInstructions.push(ee.makeCreateAssociatedTokenAccountInstruction({mint:t,associatedAccount:s,owner:o,payer:i.payer})),t.equals(B.WSOL.mint)){let f=yield ee.insertCreateWrappedNativeAccountInstructions({connection:i.connection,owner:o,payer:i.payer,instructions:i.frontInstructions,signers:i.signers,amount:(m=i.amount)!=null?m:0});i.endInstructions&&i.endInstructions.push(ee.makeCloseAccountInstruction({tokenAccount:f,owner:o,payer:i.payer})),i.amount&&i.frontInstructions.push(ee.makeTransferInstruction({source:f,destination:s,owner:o,amount:i.amount}))}return i.endInstructions&&i.endInstructions.push(ee.makeCloseAccountInstruction({tokenAccount:s,owner:o,payer:i.payer})),s}else if(t.equals(B.WSOL.mint)){let f=yield ee.insertCreateWrappedNativeAccountInstructions({connection:i.connection,owner:o,payer:i.payer,instructions:i.frontInstructions,signers:i.signers,amount:(u=i.amount)!=null?u:0});return i.endInstructions&&i.endInstructions.push(ee.makeCloseAccountInstruction({tokenAccount:f,owner:o,payer:i.payer})),f}else{let f=Rs.generate(),l=yield i.connection.getMinimumBalanceForRentExemption(Di.span),b=xs.createAccount({fromPubkey:o,newAccountPubkey:f.publicKey,lamports:l,space:Di.span,programId:Ni}),y=ee.createInitAccountInstruction(Ni,t,f.publicKey,o);return i.frontInstructions.push(b,y),i.signers.push(f),i.endInstructions&&i.endInstructions.push(ee.makeCloseAccountInstruction({tokenAccount:f.publicKey,owner:o,payer:i.payer})),f.publicKey}})}};import{PublicKey as Bs}from"@solana/web3.js";import{BN as Cs}from"bn.js";function Fl({ownerInfo:p,tokenAccounts:e}){let t=new Bs(fe.mint),n=e.filter(o=>o.accountInfo.mint.equals(t)).map(o=>({amount:o.accountInfo.amount,tx:ee.makeCloseAccountInstruction({tokenAccount:o.pubkey,owner:p.wallet,payer:p.payer})})),i=gt({instructions:n.map(o=>o.tx),signers:[],payer:p.wallet}),r=n.map(o=>o.amount).reduce((o,s)=>o.add(s),new Cs(0));return{transactions:i,amount:r}}import{Keypair as Ws,PublicKey as Me,SystemProgram as Gs,TransactionInstruction as Ve}from"@solana/web3.js";import we from"bn.js";import{PublicKey as vn}from"@solana/web3.js";var Oi="EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q",Ds=new vn(Oi),_i="9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z",Ns=new vn(_i),Ei="FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG",Os=new vn(Ei),Vi={[Oi]:3,[_i]:5,[Ei]:6},Ui={3:Ds,5:Ns,6:Os};var _s=C([A("state"),A("nonce"),R("lpVault"),R("rewardVault"),R(),R(),A(),A(),A("totalReward"),K("perShareReward"),A("lastSlot"),A("perSlotReward")]),Es=C([A("state"),A("nonce"),R("lpVault"),R("rewardVaultA"),A("totalRewardA"),K("perShareRewardA"),A("perSlotRewardA"),V("option"),R("rewardVaultB"),ce(7),A("totalRewardB"),K("perShareRewardB"),A("perSlotRewardB"),A("lastSlot"),R()]),Vs=C([A("rewardState"),A("rewardOpenTime"),A("rewardEndTime"),A("rewardLastUpdateTime"),A("totalReward"),A("totalRewardEmissioned"),A("rewardClaimed"),A("rewardPerSecond"),K("accRewardPerShare"),R("rewardVault"),R("rewardMint"),R("rewardSender"),A("rewardType"),F(A(),15,"padding")]),Us=C([A(),A("state"),A("nonce"),A("validRewardTokenNum"),K("rewardMultiplier"),A("rewardPeriodMax"),A("rewardPeriodMin"),A("rewardPeriodExtend"),R("lpMint"),R("lpVault"),F(Vs,5,"rewardInfos"),R("creator"),R(),F(A(),32,"padding")]),Ms=new Proxy(_s,{get(p,e,t){return e==="decode"?(...n)=>{let i=p.decode(...n);return oe(U({},i),{version:3,rewardInfos:[{rewardVault:i.rewardVault,totalReward:i.totalReward,perSlotReward:i.perSlotReward,perShareReward:i.perShareReward}]})}:Reflect.get(p,e,t)}}),vs=new Proxy(Es,{get(p,e,t){return e==="decode"?(...n)=>{let i=p.decode(...n);return oe(U({},i),{version:5,rewardInfos:[{rewardVault:i.rewardVaultA,totalReward:i.totalRewardA,perSlotReward:i.perSlotRewardA,perShareReward:i.perShareRewardA},{rewardVault:i.rewardVaultB,totalReward:i.totalRewardB,perSlotReward:i.perSlotRewardB,perShareReward:i.perShareRewardB}]})}:Reflect.get(p,e,t)}}),yn=new Proxy(Us,{get(p,e,t){return e==="decode"?(...n)=>{let i=p.decode(...n);return oe(U({},i),{version:6,rewardInfos:i.rewardInfos.map(r=>{var o;return oe(U({},r),{rewardType:((o=Object.entries(vt).find(s=>String(s[1])===r.rewardType.toString()))!=null?o:["Standard SPL"])[0]})})})}:Reflect.get(p,e,t)}}),ed=C([A("state"),R("id"),R("owner"),A("deposited"),F(A(),1,"rewardDebts")]),Ks=C([A("state"),R("id"),R("owner"),A("deposited"),F(K(),1,"rewardDebts"),F(A(),17)]),td=C([A("state"),R("id"),R("owner"),A("deposited"),F(A(),2,"rewardDebts")]),qs=C([A("state"),R("id"),R("owner"),A("deposited"),F(K(),2,"rewardDebts"),F(A(),17)]),Fs=C([A(),A("state"),R("id"),R("owner"),A("deposited"),F(K(),5,"rewardDebts"),F(A(),16)]),Mi={3:Ms,5:vs,6:yn},vi={3:Ks,5:qs,6:Fs};var J=z.from("Farm"),vt={"Standard SPL":0,"Option tokens":1},Je=class extends Ie{static getProgramId(e){let t=Ui[e];return J.assertArgument(!!t,"invalid version","version",e),t}static getVersion(e){let n=it(e).toBase58(),i=Vi[n];return J.assertArgument(!!i,"invalid program id","programId",n),i}static getStateLayout(e){let t=Mi[e];return J.assertArgument(!!t,"invalid version","version",e),t}static getLedgerLayout(e){let t=vi[e];return J.assertArgument(!!t,"invalid version","version",e),t}static getLayouts(e){return{state:this.getStateLayout(e),ledger:this.getLedgerLayout(e)}}static getAssociatedAuthority({programId:e,poolId:t}){return ne([t.toBuffer()],e)}static getAssociatedLedgerAccount({programId:e,poolId:t,owner:n}){let{publicKey:i}=ne([t.toBuffer(),n.toBuffer(),Buffer.from(Je.getVersion(e)===6?"farmer_info_associated_seed":"staker_info_v2_associated_seed","utf-8")],e);return i}static getAssociatedLedgerPoolAccount({programId:e,poolId:t,mint:n,type:i}){let{publicKey:r}=ne([t.toBuffer(),n.toBuffer(),Buffer.from(i==="lpVault"?"lp_vault_associated_seed":i==="rewardVault"?"reward_vault_associated_seed":"","utf-8")],e);return r}static makeDepositInstruction(e){let{poolKeys:t}=e,{version:n}=t;return n===3?this.makeDepositInstructionV3(e):n===5?this.makeDepositInstructionV5(e):n===6?this.makeDepositInstructionV6(e):J.throwArgumentError("invalid version","poolKeys.version",n)}static makeDepositInstructionV3({poolKeys:e,userKeys:t,amount:n}){J.assertArgument(e.rewardInfos.length===1,"lengths not equal 1","poolKeys.rewardInfos",e.rewardInfos),J.assertArgument(t.rewardTokenAccounts.length===1,"lengths not equal 1","userKeys.rewardTokenAccounts",t.rewardTokenAccounts);let i=C([V("instruction"),A("amount")]),r=Buffer.alloc(i.span);i.encode({instruction:10,amount:E(n)},r);let o=[S(e.id,!1),w(e.authority,!1),S(t.ledger,!1),w(t.owner,!0),S(t.lpTokenAccount,!1),S(e.lpVault,!1),S(t.rewardTokenAccounts[0],!1),S(e.rewardInfos[0].rewardVault,!1),w(Nt,!1),w(W,!1)];if(t.auxiliaryLedgers)for(let s of t.auxiliaryLedgers)o.push(S(s,!1));return new Ve({programId:e.programId,keys:o,data:r})}static makeDepositInstructionV5({poolKeys:e,userKeys:t,amount:n}){J.assertArgument(t.rewardTokenAccounts.length===e.rewardInfos.length,"lengths not equal with poolKeys.rewardInfos","userKeys.rewardTokenAccounts",t.rewardTokenAccounts);let i=C([V("instruction"),A("amount")]),r=Buffer.alloc(i.span);i.encode({instruction:11,amount:E(n)},r);let o=[S(e.id,!1),w(e.authority,!1),S(t.ledger,!1),w(t.owner,!0),S(t.lpTokenAccount,!1),S(e.lpVault,!1),S(t.rewardTokenAccounts[0],!1),S(e.rewardInfos[0].rewardVault,!1),w(Nt,!1),w(W,!1)];for(let s=1;s<e.rewardInfos.length;s++)o.push(S(t.rewardTokenAccounts[s],!1)),o.push(S(e.rewardInfos[s].rewardVault,!1));if(t.auxiliaryLedgers)for(let s of t.auxiliaryLedgers)o.push(S(s,!1));return new Ve({programId:e.programId,keys:o,data:r})}static makeDepositInstructionV6({poolKeys:e,userKeys:t,amount:n}){J.assertArgument(t.rewardTokenAccounts.length!==0,"lengths equal zero","userKeys.rewardTokenAccounts",t.rewardTokenAccounts),J.assertArgument(t.rewardTokenAccounts.length===e.rewardInfos.length,"lengths not equal with poolKeys.rewardInfos","userKeys.rewardTokenAccounts",t.rewardTokenAccounts);let i=C([V("instruction"),A("amount")]),r=Buffer.alloc(i.span);i.encode({instruction:1,amount:E(n)},r);let o=[w(W,!1),w(pe,!1),S(e.id,!1),w(e.authority,!1),S(e.lpVault,!1),S(t.ledger,!1),w(t.owner,!0),S(t.lpTokenAccount,!1)];for(let s=0;s<e.rewardInfos.length;s++)o.push(S(e.rewardInfos[s].rewardVault,!1)),o.push(S(t.rewardTokenAccounts[s],!1));return new Ve({programId:e.programId,keys:o,data:r})}static makeWithdrawInstruction(e){let{poolKeys:t}=e,{version:n}=t;return n===3?this.makeWithdrawInstructionV3(e):n===5?this.makeWithdrawInstructionV5(e):n===6?this.makeWithdrawInstructionV6(e):J.throwArgumentError("invalid version","poolKeys.version",n)}static makeWithdrawInstructionV3({poolKeys:e,userKeys:t,amount:n}){J.assertArgument(e.rewardInfos.length===1,"lengths not equal 1","poolKeys.rewardInfos",e.rewardInfos),J.assertArgument(t.rewardTokenAccounts.length===1,"lengths not equal 1","userKeys.rewardTokenAccounts",t.rewardTokenAccounts);let i=C([V("instruction"),A("amount")]),r=Buffer.alloc(i.span);i.encode({instruction:11,amount:E(n)},r);let o=[S(e.id,!1),w(e.authority,!1),S(t.ledger,!1),w(t.owner,!0),S(t.lpTokenAccount,!1),S(e.lpVault,!1),S(t.rewardTokenAccounts[0],!1),S(e.rewardInfos[0].rewardVault,!1),w(Nt,!1),w(W,!1)];if(t.auxiliaryLedgers)for(let s of t.auxiliaryLedgers)o.push(S(s,!1));return new Ve({programId:e.programId,keys:o,data:r})}static makeWithdrawInstructionV5({poolKeys:e,userKeys:t,amount:n}){J.assertArgument(t.rewardTokenAccounts.length===e.rewardInfos.length,"lengths not equal with params.poolKeys.rewardInfos","userKeys.rewardTokenAccounts",t.rewardTokenAccounts);let i=C([V("instruction"),A("amount")]),r=Buffer.alloc(i.span);i.encode({instruction:12,amount:E(n)},r);let o=[S(e.id,!1),w(e.authority,!1),S(t.ledger,!1),w(t.owner,!0),S(t.lpTokenAccount,!1),S(e.lpVault,!1),S(t.rewardTokenAccounts[0],!1),S(e.rewardInfos[0].rewardVault,!1),w(Nt,!1),w(W,!1)];for(let s=1;s<e.rewardInfos.length;s++)o.push(S(t.rewardTokenAccounts[s],!1)),o.push(S(e.rewardInfos[s].rewardVault,!1));if(t.auxiliaryLedgers)for(let s of t.auxiliaryLedgers)o.push(S(s,!1));return new Ve({programId:e.programId,keys:o,data:r})}static makeWithdrawInstructionV6({poolKeys:e,userKeys:t,amount:n}){J.assertArgument(t.rewardTokenAccounts.length!==0,"lengths equal zero","userKeys.rewardTokenAccounts",t.rewardTokenAccounts),J.assertArgument(t.rewardTokenAccounts.length===e.rewardInfos.length,"lengths not equal with params.poolKeys.rewardInfos","userKeys.rewardTokenAccounts",t.rewardTokenAccounts);let i=C([V("instruction"),A("amount")]),r=Buffer.alloc(i.span);i.encode({instruction:2,amount:E(n)},r);let o=[w(W,!1),S(e.id,!1),w(e.authority,!1),S(e.lpVault,!1),S(t.ledger,!1),w(t.owner,!0),S(t.lpTokenAccount,!1)];for(let s=0;s<e.rewardInfos.length;s++)o.push(S(e.rewardInfos[s].rewardVault,!1)),o.push(S(t.rewardTokenAccounts[s],!1));return new Ve({programId:e.programId,keys:o,data:r})}static makeCreateAssociatedLedgerAccountInstruction(e){let{poolKeys:t}=e,{version:n}=t;return n===3?this.makeCreateAssociatedLedgerAccountInstructionV3(e):n===5?this.makeCreateAssociatedLedgerAccountInstructionV5(e):J.throwArgumentError("invalid version","poolKeys.version",n)}static makeCreateAssociatedLedgerAccountInstructionV3({poolKeys:e,userKeys:t}){let n=C([V("instruction")]),i=Buffer.alloc(n.span);n.encode({instruction:9},i);let r=[S(e.id,!1),S(t.ledger,!1),w(t.owner,!0),w(pe,!1),w(Oe,!1)];return new Ve({programId:e.programId,keys:r,data:i})}static makeCreateAssociatedLedgerAccountInstructionV5({poolKeys:e,userKeys:t}){let n=C([V("instruction")]),i=Buffer.alloc(n.span);n.encode({instruction:10},i);let r=[S(e.id,!1),S(t.ledger,!1),w(t.owner,!0),w(pe,!1),w(Oe,!1)];return new Ve({programId:e.programId,keys:r,data:i})}static makeCreateFarmInstruction({connection:e,userKeys:t,poolInfo:n}){let{version:i}=n;return i===6?this.makeCreateFarmInstructionV6({connection:e,userKeys:t,poolInfo:n}):J.throwArgumentError("invalid version","version",i)}static makeCreateFarmInstructionV6(i){return _(this,arguments,function*({connection:e,userKeys:t,poolInfo:n}){var k,I,D;let r=Ws.generate(),o=yield e.getMinimumBalanceForRentExemption(yn.span),s=[],a=[],m=[r];s.push(Gs.createAccount({fromPubkey:(k=t.payer)!=null?k:t.owner,newAccountPubkey:r.publicKey,lamports:o,space:yn.span,programId:n.programId}));let{publicKey:u,nonce:f}=Je.getAssociatedAuthority({programId:n.programId,poolId:r.publicKey}),l=Je.getAssociatedLedgerPoolAccount({programId:n.programId,poolId:r.publicKey,mint:n.lpMint,type:"lpVault"}),b=[],y=[];for(let h of n.rewardInfos){J.assertArgument(h.rewardOpenTime<h.rewardEndTime,"start time error","rewardInfo.rewardOpenTime",h.rewardOpenTime),J.assertArgument(vt[h.rewardType]!==void 0,"reward type error","rewardInfo.rewardType",h.rewardType),J.assertArgument(h.rewardPerSecond>0,"rewardPerSecond error","rewardInfo.rewardPerSecond",h.rewardPerSecond),b.push({isSet:new we(1),rewardPerSecond:E(h.rewardPerSecond),rewardOpenTime:E(h.rewardOpenTime),rewardEndTime:E(h.rewardEndTime),rewardType:E(vt[h.rewardType])});let O;h.rewardMint.equals(Me.default)?(O=yield ee.insertCreateWrappedNativeAccountInstructions({connection:e,owner:t.owner,payer:(I=t.payer)!=null?I:t.owner,instructions:s,signers:m,amount:E(h.rewardEndTime).sub(E(h.rewardOpenTime)).mul(E(h.rewardPerSecond))}),a.push(ee.makeCloseAccountInstruction({tokenAccount:O,owner:t.owner,payer:(D=t.payer)!=null?D:t.owner}))):O=this._selectTokenAccount({tokenAccounts:t.tokenAccounts,mint:h.rewardMint,owner:t.owner,config:{associatedOnly:!1}}),J.assertArgument(O!==null,"cannot found target token accounts","tokenAccounts",t.tokenAccounts);let M=h.rewardMint.equals(Me.default)?B.WSOL.mint:h.rewardMint;y.push({rewardMint:M,rewardVault:Je.getAssociatedLedgerPoolAccount({programId:n.programId,poolId:r.publicKey,mint:M,type:"rewardVault"}),userRewardToken:O})}let d=this._selectTokenAccount({tokenAccounts:t.tokenAccounts,mint:n.lockInfo.lockMint,owner:t.owner,config:{associatedOnly:!1}});J.assertArgument(d!==null,"cannot found lock vault","tokenAccounts",t.tokenAccounts);let g=C([A("isSet"),A("rewardPerSecond"),A("rewardOpenTime"),A("rewardEndTime"),A("rewardType")]),P=C([V("instruction"),A("nonce"),F(g,5,"rewardTimeInfo")]),T=Buffer.alloc(P.span);P.encode({instruction:0,nonce:new we(f),rewardTimeInfo:b},T);let L=[w(W,!1),w(pe,!1),w(Oe,!1),S(r.publicKey,!1),w(u,!1),S(l,!1),w(n.lpMint,!1),S(n.lockInfo.lockVault,!1),w(n.lockInfo.lockMint,!1),S(d!=null?d:Me.default,!1),w(t.owner,!0)];for(let h of y)L.push({pubkey:h.rewardMint,isSigner:!1,isWritable:!1},{pubkey:h.rewardVault,isSigner:!1,isWritable:!0},{pubkey:h.userRewardToken,isSigner:!1,isWritable:!0});return s.push(new Ve({programId:n.programId,keys:L,data:T})),{newAccounts:m,instructions:[...s,...a]}})}static makeRestartFarmInstruction(e){let{poolKeys:t}=e,{version:n}=t;return n===6?this.makeRestartFarmInstructionV6(e):J.throwArgumentError("invalid version","version",n)}static makeRestartFarmInstructionV6(r){return _(this,arguments,function*({connection:e,poolKeys:t,userKeys:n,newRewardInfo:i}){var g,P,T;J.assertArgument(i.rewardOpenTime<i.rewardEndTime,"start time error","newRewardInfo",i);let o=i.rewardMint.equals(Me.default)?B.WSOL.mint:i.rewardMint,s=t.rewardInfos.find(L=>L.rewardMint.equals(o));J.assertArgument(s,"configuration does not exist","rewardInfo",s);let a=(g=s==null?void 0:s.rewardVault)!=null?g:Me.default,m=[],u=[],f=[],l;i.rewardMint.equals(Me.default)?(l=yield ee.insertCreateWrappedNativeAccountInstructions({connection:e,owner:n.owner,payer:(P=n.payer)!=null?P:n.owner,instructions:m,signers:f,amount:E(i.rewardEndTime).sub(E(i.rewardOpenTime)).mul(E(i.rewardPerSecond))}),u.push(ee.makeCloseAccountInstruction({tokenAccount:l,owner:n.owner,payer:(T=n.payer)!=null?T:n.owner}))):l=this._selectTokenAccount({tokenAccounts:n.tokenAccounts,mint:i.rewardMint,owner:n.owner,config:{associatedOnly:!1}}),J.assertArgument(l!==null,"cannot found target token accounts","tokenAccounts",n.tokenAccounts);let b=C([V("instruction"),A("rewardReopenTime"),A("rewardEndTime"),A("rewardPerSecond")]),y=Buffer.alloc(b.span);b.encode({instruction:3,rewardReopenTime:E(i.rewardOpenTime),rewardEndTime:E(i.rewardEndTime),rewardPerSecond:E(i.rewardPerSecond)},y);let d=[w(W,!1),S(t.id,!1),w(t.lpVault,!1),S(a,!1),S(l,!1),w(n.owner,!0)];return m.push(new Ve({programId:t.programId,keys:d,data:y})),{newAccounts:f,instructions:[...m,...u]}})}static makeCreatorWithdrawFarmRewardInstruction(e){let{poolKeys:t}=e,{version:n}=t;return n===6?this.makeCreatorWithdrawFarmRewardInstructionV6(e):J.throwArgumentError("invalid version","version",n)}static makeCreatorWithdrawFarmRewardInstructionV6(r){return _(this,arguments,function*({connection:e,poolKeys:t,userKeys:n,withdrawMint:i}){var d,g,P,T;let o=t.rewardInfos.find(L=>L.rewardMint.equals(i.equals(Me.default)?B.WSOL.mint:i));J.assertArgument(o!==void 0,"withdraw mint error","poolKeys.rewardInfos",t.rewardInfos);let s=(d=o==null?void 0:o.rewardVault)!=null?d:Me.default,a=[],m=[],u=[],f;if(i.equals(Me.default))f=yield ee.insertCreateWrappedNativeAccountInstructions({connection:e,owner:n.owner,payer:(g=n.payer)!=null?g:n.owner,instructions:a,signers:u,amount:0}),m.push(ee.makeCloseAccountInstruction({tokenAccount:f,owner:n.owner,payer:(P=n.payer)!=null?P:n.owner}));else{let L=this._selectTokenAccount({tokenAccounts:n.tokenAccounts,mint:i,owner:n.owner});L===null?(f=Ue(n.owner,i).publicKey,a.push(ee.makeCreateAssociatedTokenAccountInstruction({mint:i,associatedAccount:f,owner:n.owner,payer:(T=n.payer)!=null?T:n.owner}))):f=L}let l=C([V("instruction")]),b=Buffer.alloc(l.span);l.encode({instruction:5},b);let y=[w(W,!1),S(t.id,!1),w(t.authority,!1),w(t.lpVault,!1),S(s,!1),S(f,!1),w(n.owner,!0)];return a.push(new Ve({programId:t.programId,keys:y,data:b})),{newAccounts:u,instructions:[...a,...m]}})}static makeFarmCreatorAddRewardTokenInstruction(e){let{poolKeys:t}=e,{version:n}=t;return n===6?this.makeFarmCreatorAddRewardTokenInstructionV6(e):J.throwArgumentError("invalid version","version",n)}static makeFarmCreatorAddRewardTokenInstructionV6(r){return _(this,arguments,function*({connection:e,poolKeys:t,userKeys:n,newRewardInfo:i}){var d,g;let o=Je.getAssociatedLedgerPoolAccount({programId:t.programId,poolId:t.id,mint:i.rewardMint,type:"rewardVault"}),s=[],a=[],m=[],u;i.rewardMint.equals(Me.default)?(u=yield ee.insertCreateWrappedNativeAccountInstructions({connection:e,owner:n.owner,payer:(d=n.payer)!=null?d:n.owner,instructions:s,signers:m,amount:E(i.rewardEndTime).sub(E(i.rewardOpenTime)).mul(E(i.rewardPerSecond))}),a.push(ee.makeCloseAccountInstruction({tokenAccount:u,owner:n.owner,payer:(g=n.payer)!=null?g:n.owner}))):u=this._selectTokenAccount({tokenAccounts:n.tokenAccounts,mint:i.rewardMint,owner:n.owner,config:{associatedOnly:!1}}),J.assertArgument(u!==null,"cannot found target token accounts","tokenAccounts",n.tokenAccounts);let f=i.rewardMint.equals(Me.default)?B.WSOL.mint:i.rewardMint,l=C([V("instruction"),A("isSet"),A("rewardPerSecond"),A("rewardOpenTime"),A("rewardEndTime"),A("rewardType")]),b=Buffer.alloc(l.span);l.encode({instruction:4,isSet:new we(1),rewardPerSecond:E(i.rewardPerSecond),rewardOpenTime:E(i.rewardOpenTime),rewardEndTime:E(i.rewardEndTime),rewardType:E(vt[i.rewardType])},b);let y=[w(W,!1),w(pe,!1),w(Oe,!1),S(t.id,!1),w(t.authority,!1),w(f,!1),S(o,!1),S(u,!1),w(n.owner,!0)];return s.push(new Ve({programId:t.programId,keys:y,data:b})),{newAccounts:m,instructions:[...s,...a]}})}static fetchMultipleInfo(r){return _(this,arguments,function*({connection:e,pools:t,owner:n,config:i}){let o=[],s={};for(let u of t)s[u.id.toString()]=u,o.push({pubkey:u.id,version:u.version,key:"state",poolId:u.id}),o.push({pubkey:u.lpVault,version:u.version,key:"lpVault",poolId:u.id}),n&&o.push({pubkey:this.getAssociatedLedgerAccount({programId:u.programId,poolId:u.id,owner:n}),version:u.version,key:"ledger",poolId:u.id});let a={},m=yield _t(e,o,i);for(let{pubkey:u,version:f,key:l,poolId:b,accountInfo:y}of m){let d=b.toBase58();if(l==="state"){let g=this.getStateLayout(f);if(!y||!y.data||y.data.length!==g.span)return J.throwArgumentError("invalid farm state account info","pools.id",u);a[d]=oe(U({},a[d]),{apiPoolInfo:s[d],state:g.decode(y.data)})}else if(l==="lpVault"){if(!y||!y.data||y.data.length!==Ge.span)return J.throwArgumentError("invalid farm lp vault account info","pools.lpVault",u);a[d]=oe(U({},a[d]),{lpVault:Ge.decode(y.data)})}else if(l==="ledger"){let g=this.getLedgerLayout(f);y&&y.data&&(J.assertArgument(y.data.length===g.span,"invalid farm ledger account info","ledger",u),a[d]=oe(U({},a[d]),{ledger:g.decode(y.data)}))}}for(let[u,{state:f,ledger:l}]of Object.entries(a))if(l){let b;f.version===6?b=f.rewardMultiplier:b=f.rewardInfos.length===1?He.pow(new we(9)):He.pow(new we(15));let y=f.rewardInfos.map((d,g)=>{let P=l.rewardDebts[g];return l.deposited.mul(f.version===6?d.accRewardPerShare:d.perShareReward).div(b).sub(P)});a[u].wrapped=oe(U({},a[u].wrapped),{pendingRewards:y})}return a})}static fetchMultipleInfoAndUpdate(r){return _(this,arguments,function*({connection:e,pools:t,owner:n,config:i}){var y;let o=!1,s=!1,a=[],m={};for(let d of t)m[d.id.toString()]=d,d.version===6?s=!0:o=!0,a.push({pubkey:d.id,version:d.version,key:"state",poolId:d.id}),a.push({pubkey:d.lpVault,version:d.version,key:"lpVault",poolId:d.id}),n&&a.push({pubkey:this.getAssociatedLedgerAccount({programId:d.programId,poolId:d.id,owner:n}),version:d.version,key:"ledger",poolId:d.id});let u={},f=yield _t(e,a,i);for(let{pubkey:d,version:g,key:P,poolId:T,accountInfo:L}of f){let k=T.toBase58();if(P==="state"){let I=this.getStateLayout(g);if(!L||!L.data||L.data.length!==I.span)return J.throwArgumentError("invalid farm state account info","pools.id",d);u[k]=oe(U({},u[k]),{apiPoolInfo:m[k],state:I.decode(L.data)})}else if(P==="lpVault"){if(!L||!L.data||L.data.length!==Ge.span)return J.throwArgumentError("invalid farm lp vault account info","pools.lpVault",d);u[k]=oe(U({},u[k]),{lpVault:Ge.decode(L.data)})}else if(P==="ledger"){let I=this.getLedgerLayout(g);L&&L.data&&(J.assertArgument(L.data.length===I.span,"invalid farm ledger account info","ledger",d),u[k]=oe(U({},u[k]),{ledger:I.decode(L.data)}))}}let l=s||o?yield e.getSlot():0,b=s&&(y=yield e.getBlockTime(l))!=null?y:0;for(let d of Object.keys(u))u[d].state=Je.updatePoolInfo(u[d].state,u[d].lpVault,l,b);for(let[d,{state:g,ledger:P}]of Object.entries(u))if(P){let T;g.version===6?T=g.rewardMultiplier:T=g.rewardInfos.length===1?He.pow(new we(9)):He.pow(new we(15));let L=g.rewardInfos.map((k,I)=>{let D=P.rewardDebts[I];return P.deposited.mul(g.version===6?k.accRewardPerShare:k.perShareReward).div(T).sub(D)});u[d].wrapped=oe(U({},u[d].wrapped),{pendingRewards:L})}return u})}static updatePoolInfo(e,t,n,i){if(e.version===3||e.version===5){if(e.lastSlot.gte(new we(n)))return e;let r=new we(n).sub(e.lastSlot);e.lastSlot=new we(n);for(let o of e.rewardInfos){if(t.amount.eq(new we(0)))continue;let s=o.perSlotReward.mul(r);o.perShareReward=o.perShareReward.add(s.mul(new we(10).pow(new we(e.version===3?9:15))).div(t.amount)),o.totalReward=o.totalReward.add(s)}}else if(e.version===6)for(let r of e.rewardInfos){if(r.rewardState.eq(new we(0)))continue;let o=we.min(new we(i),r.rewardEndTime);if(r.rewardOpenTime.gte(o))continue;let a=o.sub(r.rewardLastUpdateTime).mul(r.rewardPerSecond),m=r.totalReward.sub(r.totalRewardEmissioned);m.lt(a)?(a=m,r.rewardLastUpdateTime=r.rewardLastUpdateTime.add(m.div(r.rewardPerSecond))):r.rewardLastUpdateTime=o,!t.amount.eq(new we(0))&&(r.accRewardPerShare=r.accRewardPerShare.add(a.mul(e.rewardMultiplier).div(t.amount)),r.totalRewardEmissioned=r.totalRewardEmissioned.add(a))}return e}static makeHarvestAllRewardTransaction(r){return _(this,arguments,function*({connection:e,fetchPoolInfos:t,ownerInfo:n,associatedOnly:i=!0}){var b,y;let o={};for(let d of n.tokenAccounts)i?Ue(n.wallet,d.accountInfo.mint).publicKey.equals(d.pubkey)&&(o[d.accountInfo.mint.toString()]=d.pubkey):o[d.accountInfo.mint.toString()]=d.pubkey;let s=[],a=[],m=[],u=[];for(let{lpVault:d,wrapped:g,apiPoolInfo:P}of Object.values(t)){if(g===void 0||g.pendingRewards.find(D=>D.gt(v))===void 0)continue;let T=d.mint,L=n.useSOLBalance&&T.equals(B.WSOL.mint),k=(b=o[T.toString()])!=null?b:yield this._selectOrCreateTokenAccount({mint:T,tokenAccounts:L?[]:n.tokenAccounts,owner:n.wallet,createInfo:{connection:e,payer:n.feePayer,amount:0,frontInstructions:s,signers:u},associatedOnly:L?!1:i});o[T.toString()]=k;let I=[];for(let D of P.rewardInfos){let h=n.useSOLBalance&&D.rewardMint.equals(B.WSOL.mint),O=(y=o[D.rewardMint.toString()])!=null?y:yield this._selectOrCreateTokenAccount({mint:D.rewardMint,tokenAccounts:h?[]:n.tokenAccounts,owner:n.wallet,createInfo:{connection:e,payer:n.feePayer,amount:0,frontInstructions:s,endInstructions:h?a:[],signers:u},associatedOnly:h?!1:i});o[D.rewardMint.toString()]=O,I.push(O)}m.push(this.makeWithdrawInstruction({poolKeys:P,userKeys:{ledger:this.getAssociatedLedgerAccount({programId:P.programId,poolId:P.id,owner:n.wallet}),lpTokenAccount:k,rewardTokenAccounts:I,owner:n.wallet},amount:0}))}let f=[...s,...m,...a];return{transactions:gt({instructions:f,signers:u,payer:n.wallet}),address:{}}})}};var hd=[{id:"AvbVWpBi2e4C9HPmZgShGdPoNydG4Yw8GJvG9HUcLgce",lp:x.RAY_USDT_V4,version:3},{id:"4EwbZo8BZXP5313z5A2H11MRBP15M5n6YxfmkjXESKAW",lp:c.RAY,version:3},{id:"XnRBbNMf6YcWvC1u2vBXXuMcagmRBRLu1y84mpqnKwW",lp:x.xCOPE_USDC_V4,version:5},{id:"8xhjCzfzVcP79jE7jXR2xtNaSL6aJYoDRLVT9FMjpRTC",lp:x.STEP_USDC_V4,version:5},{id:"Ef1gD9JMzWF6PNw2uc4744zouh57GyWAeVTjHHbQ2nsu",lp:x.MEDIA_USDC_V4,version:5},{id:"AxVvbT9fDFEkmdLwKUJRY5HsG2RXAZbe1dRAgJ2bDDwg",lp:x.COPE_USDC_V4,version:5},{id:"D4pYuD4tbir9KBsb7Kr63v9e86JY2UoUZeFK9eHKQFZM",lp:x.MER_USDC_V4,version:5},{id:"BLy8KuRck5bcJkQdMDLSZnL1Ka4heAZSGiwTJfEfY727",lp:x.ROPE_USDC_V4,version:5},{id:"JAP8SFagJBm6vt2LoFGNeSJ1hKDZ2p3yXb3CvBx11How",lp:x.ALEPH_USDC_V4,version:5},{id:"7U8Z6TWQMtsMcHV2htALnF9VQonnD1MrVm17YtmGEGEw",lp:x.TULIP_USDC_V4,version:5},{id:"31QSh1TwgoA9GbvkgfEEwKEm11t8CR4KiQr6WCyJr7EN",lp:x.SNY_USDC_V4,version:5},{id:"EEe8b72w5q6T86nYRNJdFcY25tznPzrd1jGjuxZ7f9mX",lp:x.BOP_RAY_V4,version:5},{id:"5PVVwSqwzkCvuiKEZwWkM35ApBnoWqF8XopsVZjPwA8z",lp:x.SLRS_USDC_V4,version:5},{id:"Bw932pURVJRYjEJwRZGWjfUNpeyz18kjMNdb833eMxoj",lp:x.SAMO_RAY_V4,version:5},{id:"BRM5bdX2mjmFGg2RAent1Whd61o9asQD16BXsC6QvEni",lp:x.LIKE_USDC_V4,version:5},{id:"HUDr9BDaAGqi37xbQHzxCyXvfMCKPTPNF8g9c9bPu1Fu",lp:x.RAY_SOL_V4,version:3},{id:"CHYrUBX2RKX8iBg7gYTkccoGNBzP44LdaazMHCLcdEgS",lp:x.RAY_USDC_V4,version:3},{id:"B6fbnZZ7sbKHR18ffEDD5Nncgp54iKN1GbCgjTRdqhS1",lp:x.RAY_ETH_V4,version:3},{id:"5DFbcYNLLy5SJiBpCCDzNSs7cWCsUbYnCkLXzcPQiKnR",lp:x.RAY_SRM_V4,version:3},{id:"GzEDEkHSFFfxKMu3Toww1nrEjtbQGJKRPNRK1Pfd59Zn",lp:x.MNGO_USDC_V4,version:5},{id:"CM9XTJfXEHceGPXhmXxheR87Ng9CZ4jiBoTVQHhs9DVN",lp:x.COPE_RAY_V4,version:5},{id:"AMcVWK66iexwwCHn8drxywdNr2UgH3vmRzLXQFdErGmL",lp:x.LIKE_RAY_V4,version:5},{id:"DJfvL6srBht8XFMWYuuKHYGainqvwXyA5icVsDne3pwN",lp:x.MEDIA_RAY_V4,version:5},{id:"21xhrT4j8QnaBvj3QjhP5kZu8sXJMCE7hzHKGtWEkdKr",lp:x.MER_RAY_V4,version:5},{id:"J61AnYYSwjtJ4wDqEqqWSBuZbiR2SDDrtF7FFobutM6a",lp:x.SLRS_RAY_V4,version:5},{id:"JEC3P83x2GEijYDwXiksuh5H6YrQt5xW6MC2GDKkMoe",lp:x.SNY_RAY_V4,version:5},{id:"BmbG9hv5PazcW3rYWvatA6HpNPkozEdkWBiU64pZxuwr",lp:x.TULIP_RAY_V4,version:5},{id:"4wvZ9SwWaHKTpshQbCSKQoPosZp9KGwUzuQdESi39qPn",lp:x.ALEPH_RAY_V4,version:5},{id:"BnYoq5y2MoH4TsBHeEZrEPowhwebHxQq7nJW1vTjPTWu",lp:x.RAY_SRM_V4,version:5},{id:"93wRz2LeQ3TJoair827VTng62MjCzYDgJjG9Q5GmQ3Pd",lp:x.ATLAS_USDC_V4,version:5},{id:"7qcihXTsRW5wS5BgK7iuD84W43ECByoJP45R3hu2r6mF",lp:x.POLIS_USDC_V4,version:5},{id:"BHHhNLdJn69K1XPJcpcw4MBY3TPetpLxhj8s4K4ydsDV",lp:x.ATLAS_RAY_V4,version:5},{id:"HHm8Pgnzc56fTUYkicPv4DqGYp5fcPZFV1V1uhixSrMk",lp:x.POLIS_RAY_V4,version:5},{id:"8GBa1cK1NxevoxiRNK6YW9tWuo2xftcA3as9Cu4nhFL7",lp:x.GRAPE_USDC_V4,version:5},{id:"HzxveT6pUMwYByqnScvTbpUv4avzkUDrDpS9D7DToEry",lp:x.LARIX_USDC_V4,version:5},{id:"Fbwy4XWMjXuP1nXg4xph4RJ9E9twVXeknXokF38PVgG1",lp:x.LARIX_RAY_V4,version:5},{id:"5gzQgxaKAU13SZeffmjjE2y9HwMJ42FxQkqJhJ5nqHeh",lp:x.stSOL_USDC_V4,version:5},{id:"914jyHBQFiroKFVCpKkzjGSaZyr4gMwgxE7snbNfGjnL",lp:x.BTC_mSOL_V4,version:5},{id:"54vUWjEmg9wfCsZF7wwq2HJu5BU3cfDFAQQQgXPECcwE",lp:x.ETH_mSOL_V4,version:5},{id:"HxhxYASqdLcR6yehT9hB9HUpgcF1R2t9HtkHdngGZ2Dh",lp:x.mSOL_USDT_V4,version:5},{id:"97N6tPMVCrAunC9embwTcffye9xC95fA5y3LauhNZ444",lp:x.MNDE_mSOL_V4,version:5},{id:"DjtZxyFBgifzpaZEzfsWXogNX5zUCnTRXJqarGe9CiSv",lp:x.mSOL_USDC_V4,version:5},{id:"7wNhbTS6XQczXs52wcVmfiodRMPfycB3YaG52dWWY6SD",lp:x.mSOL_RAY_V4,version:5},{id:"CzKUrVbP7hH8EjcHNc55ZFW33rJyLQ2r52bxCzaGTpz",lp:x.LIQ_USDC_V4,version:5},{id:"5XdeFdcJoCAPMfgYndMPcsijFBKFp2cPSCjrCZzmpTE5",lp:x.LIQ_RAY_V4,version:5},{id:"Gf3qFzKnGvMCVMQZERW2Qso5uEYxd9B9kWZZHsrMmmHj",lp:x.SYP_RAY_V4,version:5},{id:"2pQQnoNpm5LoG6sZs5toNBXi4m1Pj3ExXdggPQYyiP2x",lp:x.SYP_SOL_V4,version:5},{id:"Byt2kL5qi45pMpdAsNNciKZ8HLp7oU5jizCbyARLtQJy",lp:x.SYP_USDC_V4,version:5},{id:"8W2TqGCiFiqR1JD4sbW8uTRjV2HvFjLhkZ2tAQTYE4Gc",lp:x.WOOF_RAY_V4,version:5},{id:"FgApVk6mASrkuWNxmsFvsaAYkFKqdiwMTvYZK36A2DaC",lp:x.KIN_RAY_V4,version:5},{id:"AwUDfg4NYbLQRAcFipoJwyZTpqNvw5v6C7EypryL12Y6",lp:x.STARS_USDC_V4,version:5},{id:"Gi3Z6TXeH1ZhCCbwg6oJL8SE4LcmxmGRNhhfA6NZhwTK",lp:x.weWETH_SOL_V4,version:5},{id:"8JJSdD1ca5SDtGCEm3yBbQKek2FvJ1EbNt9q2ET3E9Jt",lp:x.weWETH_USDC_V4,version:5},{id:"6X495xkPWkw9SQFYf7yL1K8QooZyaeEQ6u7yMWNNZxNV",lp:x.weUNI_USDC_V4,version:5},{id:"AuyqPBiY6sNUpH6jx415NGcdvNdYbkbYsyVabUqEVdkj",lp:x.weSUSHI_USDC_V4,version:5},{id:"7fe8QcJ6W2kHKL1h1HMYYJoGXz2LUcwCjkxX6MX35orK",lp:x.weAXS_USDC_V4,version:5},{id:"C8BjS9DGDvC2zS3n6fTvm1rjPbA33uZ7CAvEUZ3tg7aM",lp:x.weDYDX_USDC_V4,version:5},{id:"CZZnmfvSgNVUiDBG4wN2NNcaYbsKDN4kLsc3SN8DMw6i",lp:x.weSHIB_USDC_V4,version:5},{id:"FAKzZoGVCEBDRuHN4gDswAx7PsocCorDqH6dQaxnyorT",lp:x.weSAND_USDC_V4,version:5},{id:"EBS8tc4proQE2Fj6HxU4piiZP8oiDrvyJUijDCX7P7QN",lp:x.weMANA_USDC_V4,version:5},{id:"6AxxjJhAz6APspTQM4vVCHgfzEyZgBTCogJLdai7bXYE",lp:x.wbWBNB_USDC_V4,version:5},{id:"3HGPRHH3XFFu972MR1EdS65qc1nN9sM7miZtFTi6QcEd",lp:x.wePEOPLE_USDC_V4,version:5},{id:"27bysJaX5eu5Urb5kftR66otiVc6DKK7TnifKwnpNzYu",lp:x.SRM_USDC_V4,version:5},{id:"FDnxy4NkJVG3GNMMrtUZmUmoYeYE34YRDwCYTi1yBTM",lp:x.CAVE_USDC_V4,version:5},{id:"DDRNVVJBEXEemcprVVUcrTbYnR88JyN6jjT2ypgAQHC8",lp:x.GENE_USDC_V4,version:5},{id:"GVfLbXA3dpEHPvc4do9HvMZ8TACxm3x54BVrHPMEixcr",lp:x.GENE_RAY_V4,version:5},{id:"7NZ18KhsSdJBQkJEJwhEHfdaPRNdbMd17CMoxsKxavEo",lp:x.CWAR_USDC_V4,version:5},{id:"5Mdq5o3KKPyeVVBsbnivVk9qCATjfEQ22oysXVsd2DvJ",lp:x.SONAR_USDC_V4,version:5},{id:"7W8BKbMgcVpGYvTgEK758pJgDRZJ9WafKfgkV1XCkP33",lp:x.APT_USDC_V4,version:5},{id:"CgokwBwwdYsgo8hbUMtJ3GoNM3bVjvMcmaPrVvCw4sBi",lp:x.SHILL_USDC_V4,version:5},{id:"AWbmotuJS7NLBmra9ctbfVR1BnoHmiG1HGW6hm49TuRZ",lp:x.DFL_USDC_V4,version:5},{id:"665VvECKsLpXN4fLy8GYbyQpGJRNkxRx56X93U9FVSbv",lp:x.BOKU_USDC_V4,version:5},{id:"7yk1XUWmZpWMCoFpUT985z61UNTypyBGgZF3JpKgcwmL",lp:x.MIMO_SOL_V4,version:5},{id:"E5L4Bx3Lsif7bDb9XMWi5guHUt4kkYpbqQ4CbmnRjHs1",lp:x.XTAG_USDC_V4,version:5},{id:"HtvQ5AEvu8sDM7C1oB4r5fJ5E2Q1wsJ4TADwNMqR9ccF",lp:x.TTT_USDC_V4,version:5},{id:"GUzaohfNuFbBqQTnPgPSNciv3aUvriXYjQduRE3ZkqFw",lp:x.SOL_USDC_V4,version:5},{id:"5r878BSWPtoXgnqaeFJi7BCycKZ5CodBB2vS9SeiV8q",lp:x.SOL_USDT_V4,version:5},{id:"3J3SYLeFZWKnUCsrPzikw9bcD9vRs7YNGfmg7ZSg3tsK",lp:x.RUN_USDC_V4,version:5},{id:"BYmeWrwA4ixvJhNrxWzQsA3Fsz6EtUDJTo39WYZ6o1FS",lp:x.CRWNY_RAY_V4,version:5},{id:"6VNF4rF7ESUohzNeRf3aTg61dyFjbab749RGUHCTDFQL",lp:x.CRWNY_USDC_V4,version:5},{id:"7RQDGZ1cvHcREu211R35WSKHFjTxM5dmJHeFAWag29BA",lp:x.REAL_USDC_V4,version:5},{id:"ELovJ3jDKMiWhCUCdZzPfTeVmQwhj4cvYuGwS8FfhEtJ",lp:x.BLOCK_USDC_V4,version:5},{id:"36Rf8dzq5gy4Ew2bLQEgKoCKVTku4EJPLqFYG6mzFrkr",lp:x.FRKT_SOL_V4,version:5},{id:"HXpQJeAcBCKfGY6YhZgBocZGgV4xApPVK7r8CPXfvCin",lp:x.FRKT_USDC_V4,version:5},{id:"Eqn7unnxmneDuTuXQ7EAN1wBkHMFD4LgCCAkCdPA9KbV",lp:x.MBS_USDC_V4,version:5},{id:"DtU5pZB99rVtxe5qe5hQa2rRpw7poFiqaHvMAbPgT2TM",lp:x.PRISM_USDC_V4,version:5},{id:"Gue2c9J2aRtY3aJ1HEwabQznwg2MUt9d9kUyr6otujR",lp:x.CHICKS_USDC_V4,version:5},{id:"Ej7iBkW79EdF26RxaRQfGo58PqRdzHzRmE4C2e3z3dPY",lp:x.MEAN_RAY_V4,version:5},{id:"Bd1hAsMAghtCjK38Ut4m938Ep7zyEp2TydQ7G35nPvUj",lp:x.TINY_USDC_V4,version:5},{id:"2G7qTQzw3KXm7WEMJf2izqFQWh8CLZ1wFbQVP5qo3ME9",lp:x.SCY_USDC_V4,version:5}],Rd=[],xd=[];import{PublicKey as Ki}from"@solana/web3.js";var qi="675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8",Ys=new Ki(qi),Fi="5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h",Xs=new Ki(Fi),Wi={[qi]:4,[Fi]:5},Gi={4:Ys,5:Xs},Yi={4:3,5:3};var Hs=C([A("status"),A("nonce"),A("maxOrder"),A("depth"),A("baseDecimal"),A("quoteDecimal"),A("state"),A("resetFlag"),A("minSize"),A("volMaxCutRatio"),A("amountWaveRatio"),A("baseLotSize"),A("quoteLotSize"),A("minPriceMultiplier"),A("maxPriceMultiplier"),A("systemDecimalValue"),A("minSeparateNumerator"),A("minSeparateDenominator"),A("tradeFeeNumerator"),A("tradeFeeDenominator"),A("pnlNumerator"),A("pnlDenominator"),A("swapFeeNumerator"),A("swapFeeDenominator"),A("baseNeedTakePnl"),A("quoteNeedTakePnl"),A("quoteTotalPnl"),A("baseTotalPnl"),K("quoteTotalDeposited"),K("baseTotalDeposited"),K("swapBaseInAmount"),K("swapQuoteOutAmount"),A("swapBase2QuoteFee"),K("swapQuoteInAmount"),K("swapBaseOutAmount"),A("swapQuote2BaseFee"),R("baseVault"),R("quoteVault"),R("baseMint"),R("quoteMint"),R("lpMint"),R("openOrders"),R("marketId"),R("marketProgramId"),R("targetOrders"),R("withdrawQueue"),R("lpVault"),R("owner"),A("lpReserve"),F(A(),3,"padding")]),Qs=C([A("accountType"),A("status"),A("nonce"),A("maxOrder"),A("depth"),A("baseDecimal"),A("quoteDecimal"),A("state"),A("resetFlag"),A("minSize"),A("volMaxCutRatio"),A("amountWaveRatio"),A("baseLotSize"),A("quoteLotSize"),A("minPriceMultiplier"),A("maxPriceMultiplier"),A("systemDecimalsValue"),A("abortTradeFactor"),A("priceTickMultiplier"),A("priceTick"),A("minSeparateNumerator"),A("minSeparateDenominator"),A("tradeFeeNumerator"),A("tradeFeeDenominator"),A("pnlNumerator"),A("pnlDenominator"),A("swapFeeNumerator"),A("swapFeeDenominator"),A("baseNeedTakePnl"),A("quoteNeedTakePnl"),A("quoteTotalPnl"),A("baseTotalPnl"),A("poolOpenTime"),A("punishPcAmount"),A("punishCoinAmount"),A("orderbookToInitTime"),K("swapBaseInAmount"),K("swapQuoteOutAmount"),K("swapQuoteInAmount"),K("swapBaseOutAmount"),A("swapQuote2BaseFee"),A("swapBase2QuoteFee"),R("baseVault"),R("quoteVault"),R("baseMint"),R("quoteMint"),R("lpMint"),R("modelDataAccount"),R("openOrders"),R("marketId"),R("marketProgramId"),R("targetOrders"),R("owner"),F(A(),64,"padding")]),Kn={4:Hs,5:Qs};import{ComputeBudgetProgram as ma,PublicKey as no,Transaction as Kt,TransactionInstruction as lt}from"@solana/web3.js";import Re from"bn.js";import{PublicKey as zs}from"@solana/web3.js";var Xi="9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin",Js=new zs(Xi),Hi={[Xi]:3},Qi={3:Js};var Zs=C([ce(5),ce(8),R("ownAddress"),A("vaultSignerNonce"),R("baseMint"),R("quoteMint"),R("baseVault"),A("baseDepositsTotal"),A("baseFeesAccrued"),R("quoteVault"),A("quoteDepositsTotal"),A("quoteFeesAccrued"),A("quoteDustThreshold"),R("requestQueue"),R("eventQueue"),R("bids"),R("asks"),A("baseLotSize"),A("quoteLotSize"),A("feeRateBps"),A("referrerRebatesAccrued"),ce(7)]),zi={3:Zs};import{PublicKey as js}from"@solana/web3.js";var bn=z.from("Serum"),wt=class{static getProgramId(e){let t=Qi[e];return bn.assertArgument(!!t,"invalid version","version",e),t}static getVersion(e){let t=e.toBase58(),n=Hi[t];return bn.assertArgument(!!n,"invalid program id","programId",t),n}static getStateLayout(e){let t=zi[e];return bn.assertArgument(!!t,"invalid version","version",e),t}static getLayouts(e){return{state:this.getStateLayout(e)}}static getAssociatedAuthority({programId:e,marketId:t}){let n=[t.toBuffer()],i=0,r;for(;i<100;){try{let o=n.concat(Buffer.from([i]),Buffer.alloc(7));r=js.createProgramAddressSync(o,e)}catch(o){if(o instanceof TypeError)throw o;i++;continue}return{publicKey:r,nonce:i}}return bn.throwArgumentError("unable to find a viable program address nonce","params",{programId:e,marketId:t})}};import{PublicKey as $s}from"@solana/web3.js";var Ze=new $s("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),mt=5e4,ea=C([A("x"),A("y"),A("price")]),ta=C([A("accountType"),A("status"),A("multiplier"),A("validDataCount"),F(ea,mt,"DataElement")]);function na(p,e){return[0,mt-2]}function ia(p){return[0,mt-2]}function oa(p){return[0,mt-2]}function ra(p,e,t){let[n,i]=na(e,t),r=n,o=i,s=0,a=e*p.multiplier/t;for(;r<=o;){if(s=Math.floor((o+r)/2),s===0||s>=mt-2)return[s,s,!1];let m=p.DataElement[s].x*p.multiplier/p.DataElement[s].y,u=p.DataElement[s-1].x*p.multiplier/p.DataElement[s-1].y,f=p.DataElement[s+1].x*p.multiplier/p.DataElement[s+1].y;if(a===m)return[s,s,!0];if(a===u)return[s-1,s-1,!0];if(a===f)return[s+1,s+1,!0];if(a<u)o=s-1;else{if(a>u&&a<m)return[s-1,s,!0];if(a>m&&a<f)return[s,s+1,!0];r=s+1}}return[s,s,!1]}function qn(p,e,t){let[n,i,r]=ra(p,e,t);if(!r)return 0;if(n===i){let o=p.DataElement[n].x;return e*p.multiplier/o}else{let o=p.DataElement[n].x,s=p.DataElement[n].y,a=p.DataElement[i].x,m=p.DataElement[i].y,u=t*(a*s-o*m),f=o*u,l=(a-o)*(e*s-o*t)*m,b=f+l;return e*p.multiplier*u/b}}function ut(p,e,t){return e*p.multiplier/t}function Ji(p,e,t){return e*t/p.multiplier}function sa(p,e){let[t,n]=ia(e),i=t,r=n,o=0,s=e;for(;i<r;){if(o=Math.floor((r+i)/2),o<=0||o>mt-2)return[o,o,!1];let a=p.DataElement[o].x,m=p.DataElement[o-1].x,u=p.DataElement[o+1].x;if(s===a)return[o,o,!0];if(s===m)return[o-1,o-1,!0];if(s===u)return[o+1,o+1,!0];if(s<m)r=o-1;else{if(s>m&&s<a)return[o-1,o,!0];if(s>a&&s<u)return[o,o+1,!0];i=o+1}}return[o,o,!1]}function aa(p,e){let[t,n]=oa(e),i=t,r=n,o=0,s=e;for(;i<=r;){if(o=Math.floor((r+i)/2),o<=0||o>=mt-2)return[o,o,!1];let a=p.DataElement[o].y,m=p.DataElement[o-1].y,u=p.DataElement[o+1].y;if(s===a)return[o,o,!0];if(s===m)return[o-1,o-1,!0];if(s===u)return[o+1,o+1,!0];if(s<u)i=o+1;else{if(s<m&&s>a)return[o-1,o,!0];if(s<a&&s>u)return[o,o+1,!0];r=o-1}}return[o,o,!1]}function Zi(p,e,t,n){let i=n?e+t:e-t,[r,o,s]=sa(p,i);if(!s)return[0,0,!1,s];if(r===o)return[p.DataElement[o].price,p.DataElement[o].y,!1,s];{let a=p.DataElement[r].x,m=p.DataElement[o].x,u=p.DataElement[r].price,f=p.DataElement[o].price,l=p.DataElement[r].y,b=p.DataElement[o].y;if(e>=a&&e<=m)return n?[f,b,!0,s]:[u,l,!0,s];{let y,d;return n?(y=u+(f-u)*(e-a)/(m-a),d=l-(i-a)*p.multiplier/f):(y=u+(f-u)*(e-a)/(m-a),d=b+(m-i)*p.multiplier/u),[y,d,!1,s]}}}function ca(p,e,t,n){let i=n?e-t:e+t,[r,o,s]=aa(p,i);if(!s)return[0,0,!1,s];if(r===o)return[p.DataElement[o].price,p.DataElement[o].x,!1,s];{let a=p.DataElement[r].x,m=p.DataElement[o].x,u=p.DataElement[r].price,f=p.DataElement[o].price,l=p.DataElement[r].y,b=p.DataElement[o].y;if(e>=b&&e<=l)return n?[f,m,!0,s]:[u,a,!0,s];{let y,d;return n?(y=u+(f-u)*(l-e)/(l-b),d=a+f*(l-i)/p.multiplier):(y=u+(f-u)*(l-e)/(l-b),d=m-u*(i-b)/p.multiplier),[y,d,!1,s]}}}function ua(p,e){let t=Zi(p,e,0,!1);return t[3]?t[0]:0}function ji(p,e,t,n){let i=qn(p,e,t),r=ut(p,e,i),o=ut(p,t,i),s=ut(p,n,i),a=!0,[m,u,f,l]=Zi(p,r,s,a);if(!l)return 0;if(f)return n*p.multiplier/m;{let b=o-u;return Ji(p,b,i)}}function $i(p,e,t,n){let i=qn(p,e,t),r=ut(p,e,i),o=ut(p,t,i),s=ut(p,n,i),a=!1,[m,u,f,l]=ca(p,o,s,a);if(!l)return 0;if(f)return n*m/p.multiplier;{let b=r-u;return Ji(p,b,i)}}function eo(p){let e=ta.decode(p);return{accountType:e.accountType.toNumber(),status:e.status.toNumber(),multiplier:e.multiplier.toNumber(),validDataCount:e.validDataCount.toNumber(),DataElement:e.DataElement.map(t=>({x:t.x.toNumber(),y:t.y.toNumber(),price:t.price.toNumber()}))}}function to(p,e,t,n){let i=ua(p,ut(p,e,qn(p,e,t)))/p.multiplier;return n?i:1/i}var N=z.from("Liquidity"),qt={accountType:0,status:0,multiplier:0,validDataCount:0,DataElement:[]};function Wn(p){return _(this,null,function*(){if(qt.validDataCount===0&&p){let e=yield p.getAccountInfo(Ze);e&&(qt=eo(e==null?void 0:e.data))}})}var la=(a=>(a[a.Uninitialized=0]="Uninitialized",a[a.Initialized=1]="Initialized",a[a.Disabled=2]="Disabled",a[a.RemoveLiquidityOnly=3]="RemoveLiquidityOnly",a[a.LiquidityOnly=4]="LiquidityOnly",a[a.OrderBook=5]="OrderBook",a[a.Swap=6]="Swap",a[a.WaitingForStart=7]="WaitingForStart",a))(la||{}),io=new Re(25),Fn=new Re(1e4),Lt=class extends Ie{static getProgramId(e){let t=Gi[e];return N.assertArgument(!!t,"invalid version","version",e),t}static getVersion(e){let t=e.toBase58(),n=Wi[t];return N.assertArgument(!!n,"invalid program id","programId",t),n}static getSerumVersion(e){let t=Yi[e];return N.assertArgument(!!t,"invalid version","version",e),t}static getStateLayout(e){let t=Kn[e];return N.assertArgument(!!t,"invalid version","version",e),t}static getLayouts(e){return{state:this.getStateLayout(e)}}static getAssociatedId({programId:e,marketId:t}){let{publicKey:n}=ne([e.toBuffer(),t.toBuffer(),Buffer.from("amm_associated_seed","utf-8")],e);return n}static getAssociatedAuthority({programId:e}){return ne([Buffer.from([97,109,109,32,97,117,116,104,111,114,105,116,121])],e)}static getAssociatedBaseVault({programId:e,marketId:t}){let{publicKey:n}=ne([e.toBuffer(),t.toBuffer(),Buffer.from("coin_vault_associated_seed","utf-8")],e);return n}static getAssociatedQuoteVault({programId:e,marketId:t}){let{publicKey:n}=ne([e.toBuffer(),t.toBuffer(),Buffer.from("pc_vault_associated_seed","utf-8")],e);return n}static getAssociatedLpMint({programId:e,marketId:t}){let{publicKey:n}=ne([e.toBuffer(),t.toBuffer(),Buffer.from("lp_mint_associated_seed","utf-8")],e);return n}static getAssociatedLpVault({programId:e,marketId:t}){let{publicKey:n}=ne([e.toBuffer(),t.toBuffer(),Buffer.from("temp_lp_token_associated_seed","utf-8")],e);return n}static getAssociatedTargetOrders({programId:e,marketId:t}){let{publicKey:n}=ne([e.toBuffer(),t.toBuffer(),Buffer.from("target_associated_seed","utf-8")],e);return n}static getAssociatedWithdrawQueue({programId:e,marketId:t}){let{publicKey:n}=ne([e.toBuffer(),t.toBuffer(),Buffer.from("withdraw_associated_seed","utf-8")],e);return n}static getAssociatedOpenOrders({programId:e,marketId:t}){let{publicKey:n}=ne([e.toBuffer(),t.toBuffer(),Buffer.from("open_order_associated_seed","utf-8")],e);return n}static getAssociatedPoolKeys({version:e,marketVersion:t,marketId:n,baseMint:i,quoteMint:r,baseDecimals:o,quoteDecimals:s,programId:a,marketProgramId:m}){let u=this.getAssociatedId({programId:a,marketId:n}),f=this.getAssociatedLpMint({programId:a,marketId:n}),{publicKey:l,nonce:b}=this.getAssociatedAuthority({programId:a}),y=this.getAssociatedBaseVault({programId:a,marketId:n}),d=this.getAssociatedQuoteVault({programId:a,marketId:n}),g=this.getAssociatedLpVault({programId:a,marketId:n}),P=this.getAssociatedOpenOrders({programId:a,marketId:n}),T=this.getAssociatedTargetOrders({programId:a,marketId:n}),L=this.getAssociatedWithdrawQueue({programId:a,marketId:n}),{publicKey:k}=wt.getAssociatedAuthority({programId:m,marketId:n});return{id:u,baseMint:i,quoteMint:r,lpMint:f,baseDecimals:o,quoteDecimals:s,lpDecimals:o,version:e,programId:a,authority:l,nonce:b,baseVault:y,quoteVault:d,lpVault:g,openOrders:P,targetOrders:T,withdrawQueue:L,marketVersion:t,marketProgramId:m,marketId:n,marketAuthority:k}}static makeAddLiquidityInstruction(e){let{poolKeys:t,userKeys:n,baseAmountIn:i,quoteAmountIn:r,fixedSide:o}=e,{version:s}=t;if(s===4||s===5){let a=C([V("instruction"),A("baseAmountIn"),A("quoteAmountIn"),A("fixedSide")]),m=Buffer.alloc(a.span);a.encode({instruction:3,baseAmountIn:E(i),quoteAmountIn:E(r),fixedSide:E(o==="base"?0:1)},m);let u=[w(W,!1),S(t.id,!1),w(t.authority,!1),w(t.openOrders,!1),S(t.targetOrders,!1),S(t.lpMint,!1),S(t.baseVault,!1),S(t.quoteVault,!1)];return s===5&&u.push(S(Ze,!1)),u.push(w(t.marketId,!1),S(n.baseTokenAccount,!1),S(n.quoteTokenAccount,!1),S(n.lpTokenAccount,!1),w(n.owner,!0),w(t.marketEventQueue,!1)),new lt({programId:t.programId,keys:u,data:m})}return N.throwArgumentError("invalid version","poolKeys.version",s)}static makeAddLiquidityTransaction(e){return _(this,null,function*(){let{connection:t,poolKeys:n,userKeys:i,amountInA:r,amountInB:o,fixedSide:s,config:a}=e,{lpMint:m}=n,{tokenAccounts:u,owner:f,payer:l=f}=i;N.debug("amountInA:",r),N.debug("amountInB:",o),N.assertArgument(!r.isZero()&&!o.isZero(),"amounts must greater than zero","amountInA & amountInB",{amountInA:r.toFixed(),amountInB:o.toFixed()});let{bypassAssociatedCheck:b}=U({bypassAssociatedCheck:!1},a),y=r instanceof q?r.token:B.WSOL,d=o instanceof q?o.token:B.WSOL,g=this._selectTokenAccount({tokenAccounts:u,mint:y.mint,owner:f,config:{associatedOnly:!1}}),P=this._selectTokenAccount({tokenAccounts:u,mint:d.mint,owner:f,config:{associatedOnly:!1}});N.assertArgument(!!g||!!P,"cannot found target token accounts","tokenAccounts",u);let T=this._selectTokenAccount({tokenAccounts:u,mint:m,owner:f}),L=[y,d],k=[g,P],I=[r.raw,o.raw],[D]=this._getAmountsSide(r,o,n),h="base";if(D==="quote")if(L.reverse(),k.reverse(),I.reverse(),s==="a")h="quote";else if(s==="b")h="base";else return N.throwArgumentError("invalid fixedSide","fixedSide",s);else if(D==="base")if(s==="a")h="base";else if(s==="b")h="quote";else return N.throwArgumentError("invalid fixedSide","fixedSide",s);else return N.throwArgumentError("invalid fixedSide","fixedSide",s);let[O,M]=L,[H,te]=k,[Q,se]=I,ae=[],ue=[],Ne=[],Zt=yield this._handleTokenAccount({connection:t,side:"in",amount:Q,mint:O.mint,tokenAccount:H,owner:f,payer:l,frontInstructions:ae,endInstructions:ue,signers:Ne,bypassAssociatedCheck:b}),jt=yield this._handleTokenAccount({connection:t,side:"in",amount:se,mint:M.mint,tokenAccount:te,owner:f,payer:l,frontInstructions:ae,endInstructions:ue,signers:Ne,bypassAssociatedCheck:b}),Ct=yield this._handleTokenAccount({connection:t,side:"out",amount:0,mint:m,tokenAccount:T,owner:f,payer:l,frontInstructions:ae,endInstructions:ue,signers:Ne,bypassAssociatedCheck:b});ae.push(this.makeAddLiquidityInstruction({poolKeys:n,userKeys:{baseTokenAccount:Zt,quoteTokenAccount:jt,lpTokenAccount:Ct,owner:f},baseAmountIn:Q,quoteAmountIn:se,fixedSide:h}));let Jn=new Kt;return Jn.add(...ae,...ue),{transaction:Jn,signers:Ne}})}static makeRemoveLiquidityInstruction(e){let{poolKeys:t,userKeys:n,amountIn:i}=e,{version:r}=t;if(r===4||r===5){let o=C([V("instruction"),A("amountIn")]),s=Buffer.alloc(o.span);o.encode({instruction:4,amountIn:E(i)},s);let a=[w(W,!1),S(t.id,!1),w(t.authority,!1),S(t.openOrders,!1),S(t.targetOrders,!1),S(t.lpMint,!1),S(t.baseVault,!1),S(t.quoteVault,!1)];return r===5?a.push(S(Ze,!1)):(a.push(S(t.withdrawQueue,!1)),a.push(S(t.lpVault,!1))),a.push(w(t.marketProgramId,!1),S(t.marketId,!1),S(t.marketBaseVault,!1),S(t.marketQuoteVault,!1),w(t.marketAuthority,!1),S(n.lpTokenAccount,!1),S(n.baseTokenAccount,!1),S(n.quoteTokenAccount,!1),w(n.owner,!0),S(t.marketEventQueue,!1),S(t.marketBids,!1),S(t.marketAsks,!1)),new lt({programId:t.programId,keys:a,data:s})}return N.throwArgumentError("invalid version","poolKeys.version",r)}static makeRemoveLiquidityTransaction(e){return _(this,null,function*(){let{connection:t,poolKeys:n,userKeys:i,amountIn:r,config:o}=e,{baseMint:s,quoteMint:a,lpMint:m}=n,{tokenAccounts:u,owner:f,payer:l=f}=i;N.debug("amountIn:",r),N.assertArgument(!r.isZero(),"amount must greater than zero","amountIn",r.toFixed()),N.assertArgument(r instanceof q&&r.token.mint.equals(m),"amountIn's token not match lpMint","amountIn",r);let b=this._selectTokenAccount({tokenAccounts:u,mint:m,owner:f,config:{associatedOnly:!1}});if(!b)return N.throwArgumentError("cannot found lpTokenAccount","tokenAccounts",u);let y=this._selectTokenAccount({tokenAccounts:u,mint:s,owner:f}),d=this._selectTokenAccount({tokenAccounts:u,mint:a,owner:f}),{bypassAssociatedCheck:g}=U({bypassAssociatedCheck:!1},o),P=[],T=[],L=[],k=b,I=yield this._handleTokenAccount({connection:t,side:"out",amount:0,mint:s,tokenAccount:y,owner:f,payer:l,frontInstructions:P,endInstructions:T,signers:L,bypassAssociatedCheck:g}),D=yield this._handleTokenAccount({connection:t,side:"out",amount:0,mint:a,tokenAccount:d,owner:f,payer:l,frontInstructions:P,endInstructions:T,signers:L,bypassAssociatedCheck:g});P.push(ma.requestUnits({units:4e5,additionalFee:0})),P.push(this.makeRemoveLiquidityInstruction({poolKeys:n,userKeys:{lpTokenAccount:k,baseTokenAccount:I,quoteTokenAccount:D,owner:f},amountIn:r.raw}));let h=new Kt;return h.add(...P,...T),{transaction:h,signers:L}})}static makeSwapInstruction(e){let{poolKeys:t,userKeys:n,amountIn:i,amountOut:r,fixedSide:o}=e,{version:s}=t;return s===4||s===5?o==="in"?this.makeSwapFixedInInstruction({poolKeys:t,userKeys:n,amountIn:i,minAmountOut:r},s):o==="out"?this.makeSwapFixedOutInstruction({poolKeys:t,userKeys:n,maxAmountIn:i,amountOut:r},s):N.throwArgumentError("invalid params","params",e):N.throwArgumentError("invalid version","poolKeys.version",s)}static makeSwapFixedInInstruction({poolKeys:e,userKeys:t,amountIn:n,minAmountOut:i},r){let o=C([V("instruction"),A("amountIn"),A("minAmountOut")]),s=Buffer.alloc(o.span);o.encode({instruction:9,amountIn:E(n),minAmountOut:E(i)},s);let a=[w(W,!1),S(e.id,!1),w(e.authority,!1),S(e.openOrders,!1)];return r===4&&a.push(S(e.targetOrders,!1)),a.push(S(e.baseVault,!1),S(e.quoteVault,!1)),r===5&&a.push(S(Ze,!1)),a.push(w(e.marketProgramId,!1),S(e.marketId,!1),S(e.marketBids,!1),S(e.marketAsks,!1),S(e.marketEventQueue,!1),S(e.marketBaseVault,!1),S(e.marketQuoteVault,!1),w(e.marketAuthority,!1),S(t.tokenAccountIn,!1),S(t.tokenAccountOut,!1),w(t.owner,!0)),new lt({programId:e.programId,keys:a,data:s})}static makeSwapFixedOutInstruction({poolKeys:e,userKeys:t,maxAmountIn:n,amountOut:i},r){let o=C([V("instruction"),A("maxAmountIn"),A("amountOut")]),s=Buffer.alloc(o.span);o.encode({instruction:11,maxAmountIn:E(n),amountOut:E(i)},s);let a=[w(W,!1),S(e.id,!1),w(e.authority,!1),S(e.openOrders,!1),S(e.targetOrders,!1),S(e.baseVault,!1),S(e.quoteVault,!1)];return r===5&&a.push(S(Ze,!1)),a.push(w(e.marketProgramId,!1),S(e.marketId,!1),S(e.marketBids,!1),S(e.marketAsks,!1),S(e.marketEventQueue,!1),S(e.marketBaseVault,!1),S(e.marketQuoteVault,!1),w(e.marketAuthority,!1),S(t.tokenAccountIn,!1),S(t.tokenAccountOut,!1),w(t.owner,!0)),new lt({programId:e.programId,keys:a,data:s})}static makeSwapTransaction(e){return _(this,null,function*(){let{connection:t,poolKeys:n,userKeys:i,amountIn:r,amountOut:o,fixedSide:s,config:a}=e,{tokenAccounts:m,owner:u,payer:f=u}=i;N.debug("amountIn:",r),N.debug("amountOut:",o),N.assertArgument(!r.isZero()&&!o.isZero(),"amounts must greater than zero","currencyAmounts",{amountIn:r.toFixed(),amountOut:o.toFixed()});let{bypassAssociatedCheck:l}=U({bypassAssociatedCheck:!1},a),b=r instanceof q?r.token:B.WSOL,y=o instanceof q?o.token:B.WSOL,d=this._selectTokenAccount({tokenAccounts:m,mint:b.mint,owner:u,config:{associatedOnly:!1}}),g=this._selectTokenAccount({tokenAccounts:m,mint:y.mint,owner:u}),[P,T]=[r.raw,o.raw],L=[],k=[],I=[],D=yield this._handleTokenAccount({connection:t,side:"in",amount:P,mint:b.mint,tokenAccount:d,owner:u,payer:f,frontInstructions:L,endInstructions:k,signers:I,bypassAssociatedCheck:l}),h=yield this._handleTokenAccount({connection:t,side:"out",amount:0,mint:y.mint,tokenAccount:g,owner:u,payer:f,frontInstructions:L,endInstructions:k,signers:I,bypassAssociatedCheck:l});L.push(this.makeSwapInstruction({poolKeys:n,userKeys:{tokenAccountIn:D,tokenAccountOut:h,owner:u},amountIn:P,amountOut:T,fixedSide:s}));let O=new Kt;return O.add(...L,...k),{transaction:O,signers:I}})}static makeCreatePoolInstruction(e){let{poolKeys:t}=e,{version:n}=t;return n===4?this.makeCreatePoolInstructionV4(e):N.throwArgumentError("invalid version","poolKeys.version",n)}static makeCreatePoolInstructionV4({poolKeys:e,userKeys:t}){let n=C([V("instruction"),V("nonce")]),i=Buffer.alloc(n.span);n.encode({instruction:10,nonce:e.nonce},i);let r=[w(W,!1),w(pe,!1),w(Oe,!1),S(e.targetOrders,!1),S(e.withdrawQueue,!1),w(e.authority,!1),S(e.lpMint,!1),w(e.baseMint,!1),w(e.quoteMint,!1),S(e.baseVault,!1),S(e.quoteVault,!1),S(e.lpVault,!1),w(e.marketId,!1),S(t.payer,!0)];return new lt({programId:e.programId,keys:r,data:i})}static makeCreatePoolTransaction(e){let t=new Kt,n=[];return t.add(this.makeCreatePoolInstruction(e)),{transaction:t,signers:n}}static makeInitPoolInstruction(e){let{poolKeys:t}=e,{version:n}=t;return n===4?this.makeInitPoolInstructionV4(e):N.throwArgumentError("invalid version","poolKeys.version",n)}static makeInitPoolInstructionV4({poolKeys:e,userKeys:t,startTime:n}){let i=C([V("instruction"),V("nonce"),A("startTime")]),r=Buffer.alloc(i.span);i.encode({instruction:0,nonce:e.nonce,startTime:E(n)},r);let o=[w(W,!1),w(pe,!1),w(Oe,!1),S(e.id,!1),w(e.authority,!1),S(e.openOrders,!1),S(e.lpMint,!1),w(e.baseMint,!1),w(e.quoteMint,!1),w(e.baseVault,!1),w(e.quoteVault,!1),S(e.withdrawQueue,!1),S(e.targetOrders,!1),S(t.lpTokenAccount,!1),w(e.lpVault,!1),w(e.marketProgramId,!1),w(e.marketId,!1),S(t.payer,!0)];return new lt({programId:e.programId,keys:o,data:r})}static makeInitPoolTransaction(e){return _(this,null,function*(){let{connection:t,poolKeys:n,userKeys:i,baseAmount:r,quoteAmount:o,startTime:s=0,config:a}=e,{baseMint:m,quoteMint:u,lpMint:f,baseVault:l,quoteVault:b}=n,{tokenAccounts:y,owner:d,payer:g=d}=i,{bypassAssociatedCheck:P}=U({bypassAssociatedCheck:!1},a),T=this._selectTokenAccount({tokenAccounts:y,mint:m,owner:d,config:{associatedOnly:!1}}),L=this._selectTokenAccount({tokenAccounts:y,mint:u,owner:d,config:{associatedOnly:!1}});N.assertArgument(!!T||!!L,"cannot found target token accounts","tokenAccounts",y);let k=this._selectTokenAccount({tokenAccounts:y,mint:f,owner:d}),I=[],D=[],h=[],O=yield this._handleTokenAccount({connection:t,side:"in",amount:r.raw,mint:m,tokenAccount:T,owner:d,payer:g,frontInstructions:I,endInstructions:D,signers:h,bypassAssociatedCheck:P}),M=yield this._handleTokenAccount({connection:t,side:"in",amount:o.raw,mint:u,tokenAccount:L,owner:d,payer:g,frontInstructions:I,endInstructions:D,signers:h,bypassAssociatedCheck:P}),H=yield this._handleTokenAccount({connection:t,side:"out",amount:0,mint:f,tokenAccount:k,owner:d,payer:g,frontInstructions:I,endInstructions:D,signers:h,bypassAssociatedCheck:P});I.push(ee.makeTransferInstruction({source:O,destination:l,owner:d,amount:r.raw})),I.push(ee.makeTransferInstruction({source:M,destination:b,owner:d,amount:o.raw})),I.push(this.makeInitPoolInstruction({poolKeys:n,userKeys:{lpTokenAccount:H,payer:g},startTime:s}));let te=new Kt;return te.add(...I,...D),{transaction:te,signers:h}})}static makeSimulatePoolInfoInstruction({poolKeys:e}){let t=C([V("instruction"),V("simulateType")]),n=Buffer.alloc(t.span);t.encode({instruction:12,simulateType:0},n);let i=[w(e.id,!1),w(e.authority,!1),w(e.openOrders,!1),w(e.baseVault,!1),w(e.quoteVault,!1),w(e.lpMint,!1),w(e.marketId,!1),w(e.marketEventQueue,!1)];return new lt({programId:e.programId,keys:i,data:n})}static isV4(e){return e.withdrawQueue!==void 0}static fetchAllPoolKeys(e,t){return _(this,null,function*(){let n=Object.keys(Kn).map(m=>{let u=Number(m),f=this.getSerumVersion(u),l=wt.getProgramId(f);return{version:u,programId:this.getProgramId(u),serumVersion:f,serumProgramId:l,stateLayout:this.getStateLayout(u)}}),i=[];try{i=yield Promise.all(n.map(({programId:m,version:u,serumVersion:f,serumProgramId:l,stateLayout:b})=>e.getProgramAccounts(m,{filters:[{dataSize:b.span}]}).then(y=>y.map(d=>oe(U({},d),{version:u,programId:m,serumVersion:f,serumProgramId:l,stateLayout:b})))))}catch(m){if(m instanceof Error)return N.throwError("failed to fetch all liquidity pools",z.errors.RPC_ERROR,{message:m.message})}let r=i.flat(),o=[];for(let{pubkey:m,account:u,version:f,programId:l,serumVersion:b,serumProgramId:y,stateLayout:d}of r){N.assertArgument(!!u,"empty state account info","pool.id",m);let{data:g}=u;N.assertArgument(g.length===d.span,"invalid state data length","pool.id",m);let P=d.decode(g),{status:T,baseMint:L,quoteMint:k,baseDecimal:I,quoteDecimal:D,lpMint:h,openOrders:O,targetOrders:M,baseVault:H,quoteVault:te,marketId:Q}=P,se,ae;if(this.isV4(P)?(se=P.withdrawQueue,ae=P.lpVault):(se=no.default,ae=no.default),T.isZero())continue;let ue=Lt.getAssociatedPoolKeys({version:f,marketVersion:b,marketId:Q,baseMint:L,baseDecimals:I.toNumber(),quoteMint:k,quoteDecimals:D.toNumber(),programId:l,marketProgramId:y});o.push({id:m,baseMint:L,quoteMint:k,baseDecimals:ue.baseDecimals,quoteDecimals:ue.quoteDecimals,lpDecimals:ue.lpDecimals,lpMint:h,version:f,programId:l,authority:ue.authority,openOrders:O,targetOrders:M,baseVault:H,quoteVault:te,withdrawQueue:se,lpVault:ae,marketVersion:b,marketProgramId:y,marketId:Q,marketAuthority:ue.marketAuthority})}let s=[];try{s=yield Ee(e,o.map(({marketId:m})=>m),t)}catch(m){if(m instanceof Error)return N.throwError("failed to fetch markets",z.errors.RPC_ERROR,{message:m.message})}N.assertArgument(s.length===o.length,"markets count not equal to pools","markets.length",s.length);let a=[];for(let m in s){let u=o[m],f=s[m],{id:l,marketVersion:b}=u;if(!f)return N.throwArgumentError("empty market account info","pool.id",l);let{data:y}=f,{state:d}=wt.getLayouts(b);N.assertArgument(y.length===d.span,"invalid market data length","pool.id",l);let{baseVault:g,quoteVault:P,bids:T,asks:L,eventQueue:k}=d.decode(y);a.push(oe(U({},u),{marketBaseVault:g,marketQuoteVault:P,marketBids:T,marketAsks:L,marketEventQueue:k}))}return a})}static fetchInfo(n){return _(this,arguments,function*({connection:e,poolKeys:t}){let i=yield this.fetchMultipleInfo({connection:e,pools:[t]});return N.assertArgument(i.length===1,`fetchInfo failed, ${i.length} pools found`,"poolKeys.id",t.id),i[0]})}static fetchMultipleInfo(i){return _(this,arguments,function*({connection:e,pools:t,config:n}){yield Wn(e);let r=t.map(a=>this.makeSimulatePoolInfoInstruction({poolKeys:a}));return(yield tn(e,r,"GetPoolData")).map(a=>{let m=nn(a,"GetPoolData"),u=new Re(ge(m,"status")),f=Number(ge(m,"coin_decimals")),l=Number(ge(m,"pc_decimals")),b=Number(ge(m,"lp_decimals")),y=new Re(ge(m,"pool_coin_amount")),d=new Re(ge(m,"pool_pc_amount")),g=new Re(ge(m,"pool_lp_supply")),P="0";try{P=ge(m,"pool_open_time")}catch(T){}return{status:u,baseDecimals:f,quoteDecimals:l,lpDecimals:b,baseReserve:y,quoteReserve:d,lpSupply:g,startTime:new Re(P)}})})}static getEnabledFeatures(e){let{status:t}=e,n=t.toNumber();if(n===0)return{swap:!1,addLiquidity:!1,removeLiquidity:!1};if(n===1)return{swap:!0,addLiquidity:!0,removeLiquidity:!0};if(n===2)return{swap:!1,addLiquidity:!1,removeLiquidity:!1};if(n===3)return{swap:!1,addLiquidity:!1,removeLiquidity:!0};if(n===4)return{swap:!1,addLiquidity:!0,removeLiquidity:!0};if(n===5)return{swap:!1,addLiquidity:!0,removeLiquidity:!0};if(n===6)return{swap:!0,addLiquidity:!0,removeLiquidity:!0};if(n===7){let{startTime:i}=e;return Date.now()/1e3<i.toNumber()?{swap:!1,addLiquidity:!0,removeLiquidity:!0}:{swap:!0,addLiquidity:!0,removeLiquidity:!0}}else return{swap:!1,addLiquidity:!1,removeLiquidity:!1}}static includesToken(e,t){let{baseMint:n,quoteMint:i}=t;return e.mint.equals(n)||e.mint.equals(i)}static _getTokenSide(e,t){let{baseMint:n,quoteMint:i}=t;return e.mint.equals(n)?"base":e.mint.equals(i)?"quote":N.throwArgumentError("token not match with pool","params",{token:e.mint,baseMint:n,quoteMint:i})}static _getTokensSide(e,t,n){let{baseMint:i,quoteMint:r}=n,o=this._getTokenSide(e,n),s=this._getTokenSide(t,n);return N.assertArgument(o!==s,"tokens not match with pool","params",{tokenA:e.mint,tokenB:t.mint,baseMint:i,quoteMint:r}),[o,s]}static _getAmountSide(e,t){let n=e instanceof q?e.token:B.WSOL;return this._getTokenSide(n,t)}static _getAmountsSide(e,t,n){let i=e instanceof q?e.token:B.WSOL,r=t instanceof q?t.token:B.WSOL;return this._getTokensSide(i,r,n)}static computeAnotherAmount({poolKeys:e,poolInfo:t,amount:n,anotherCurrency:i,slippage:r}){let{baseReserve:o,quoteReserve:s}=t;N.debug("baseReserve:",o.toString()),N.debug("quoteReserve:",s.toString());let a=n instanceof q?n.token:n.currency;N.debug("currencyIn:",a),N.debug("amount:",n.toFixed()),N.debug("anotherCurrency:",i),N.debug("slippage:",`${r.toSignificant()}%`);let m=this._getAmountSide(n,e);N.debug("input side:",m);let u=v;n.isZero()||(u=m==="base"?xn(n.raw.mul(s),o):xn(n.raw.mul(o),s));let l=new Ae(ie).add(r).mul(u).quotient,b=i instanceof B?new q(i,u):new me(i,u),y=i instanceof B?new q(i,l):new me(i,l);return N.debug("anotheAmount:",b.toFixed()),N.debug("maxAnotheAmount:",y.toFixed()),{anotherAmount:b,maxAnotherAmount:y}}static _computePriceImpact(e,t,n){let i=e.raw.mul(t),r=i.sub(n).div(i);return new Ae(r.numerator,r.denominator)}static getRate(e){let{baseReserve:t,quoteReserve:n,baseDecimals:i,quoteDecimals:r}=e;return new le(new We(i),t,new We(r),n)}static computeAmountIn({poolKeys:e,poolInfo:t,amountOut:n,currencyIn:i,slippage:r}){let{baseReserve:o,quoteReserve:s}=t;N.debug("baseReserve:",o.toString()),N.debug("quoteReserve:",s.toString());let a=n instanceof q?n.token:n.currency;N.debug("currencyOut:",a),N.debug("amountOut:",n.toFixed()),N.debug("currencyIn:",i),N.debug("slippage:",`${r.toSignificant()}%`);let m=[o,s],u=this._getAmountSide(n,e);u==="base"&&m.reverse(),N.debug("output side:",u);let[f,l]=m,b=new le(i,f,a,l);N.debug("currentPrice:",`1 ${i.symbol} \u2248 ${b.toFixed()} ${a.symbol}`),N.debug("currentPrice invert:",`1 ${a.symbol} \u2248 ${b.invert().toFixed()} ${i.symbol}`);let y=v,d=n.raw;if(!d.isZero()){d.gt(l)&&(d=l.sub(ie));let D=l.sub(d);y=f.mul(d).div(D).mul(Fn).div(Fn.sub(io))}let P=new Ae(ie).add(r).mul(y).quotient,T=i instanceof B?new q(i,y):new me(i,y),L=i instanceof B?new q(i,P):new me(i,P);N.debug("amountIn:",T.toFixed()),N.debug("maxAmountIn:",L.toFixed());let k=null;!y.isZero()&&!d.isZero()&&(k=new le(i,y,a,d),N.debug("executionPrice:",`1 ${i.symbol} \u2248 ${k.toFixed()} ${a.symbol}`),N.debug("executionPrice invert:",`1 ${a.symbol} \u2248 ${k.invert().toFixed()} ${i.symbol}`));let I=this._computePriceImpact(b,y,d);return N.debug("priceImpact:",`${I.toSignificant()}%`),{amountIn:T,maxAmountIn:L,currentPrice:b,executionPrice:k,priceImpact:I}}},ye=Lt;ye.computeAmountOut=({poolKeys:e,poolInfo:t,amountIn:n,currencyOut:i,slippage:r})=>{let o=n instanceof q?n.token:B.WSOL,s=i instanceof B?i:B.WSOL;N.assertArgument(Lt.includesToken(o,e)&&Lt.includesToken(s,e),"token not match with pool","poolKeys",{poolKeys:e,tokenIn:o,tokenOut:s});let{baseReserve:a,quoteReserve:m}=t;N.debug("baseReserve:",a.toString()),N.debug("quoteReserve:",m.toString());let u=n instanceof q?n.token:n.currency;N.debug("currencyIn:",u),N.debug("amountIn:",n.toFixed()),N.debug("currencyOut:",i),N.debug("slippage:",`${r.toSignificant()}%`);let f=[a,m],l=Lt._getAmountSide(n,e);l==="quote"&&f.reverse(),N.debug("input side:",l);let[b,y]=f,d;if(e.version===4)d=new le(u,b,i,y);else{let Q=to(qt,a.toNumber(),m.toNumber(),!1);l==="quote"?d=new le(u,new Re(Q*1e6),i,new Re(1e6)):d=new le(u,new Re(1e6),i,new Re(Q*1e6))}N.debug("currentPrice:",`1 ${u.symbol} \u2248 ${d.toFixed()} ${i.symbol}`),N.debug("currentPrice invert:",`1 ${i.symbol} \u2248 ${d.invert().toFixed()} ${u.symbol}`);let g=n.raw,P=v,T=v;if(!g.isZero())if(e.version===4){T=g.mul(io).div(Fn);let Q=g.sub(T),se=b.add(Q);P=y.mul(Q).div(se)}else{T=g.mul(new Re(2)).div(new Re(1e4));let Q=g.sub(T);l==="quote"?P=new Re(ji(qt,m.toNumber(),a.toNumber(),Q.toNumber())):P=new Re($i(qt,m.toNumber(),a.toNumber(),Q.toNumber()))}let k=new Ae(ie).add(r).invert().mul(P).quotient,I=i instanceof B?new q(i,P):new me(i,P),D=i instanceof B?new q(i,k):new me(i,k);N.debug("amountOut:",I.toFixed()),N.debug("minAmountOut:",D.toFixed());let h=new le(u,g.sub(T),i,P);!g.isZero()&&!P.isZero()&&(h=new le(u,g.sub(T),i,P),N.debug("executionPrice:",`1 ${u.symbol} \u2248 ${h.toFixed()} ${i.symbol}`),N.debug("executionPrice invert:",`1 ${i.symbol} \u2248 ${h.invert().toFixed()} ${u.symbol}`));let O=h.denominator.mul(d.numerator),M=h.numerator.mul(d.denominator).sub(O).abs(),H=new Ae(M,O);N.debug("priceImpact:",`${H.toSignificant()}%`);let te=u instanceof B?new q(u,T):new me(u,T);return{amountOut:I,minAmountOut:D,currentPrice:d,executionPrice:h,priceImpact:H,fee:te}};var Rp=["2dRNngAm729NzLbb1pzgHtfHvPqR4XHFmFyYK78EfEeX","B5ZguAWAGC3GXVtJZVfoMtzvEvDnDKBPCevsUKMy4DTZ","5VyLSjUvaRxsubirbvbfJMbrKZRx1b7JZzuCAfyqgimf","6kmMMacvoCKBkBrqssLEdFuEZu2wqtLdNQxh9VjtzfwT","DVa7Qmb5ct9RCpaU7UTpSaf3GVMYz17vNVU67XpdCRut","58oQChx4yWmvKdwLLZzBi4ChoCc2fqCUWBkwMihLYQo2","83xxjVczDseaCzd7D61BRo7LcP7cMXut5n7thhB4rL4d","8tzS7SkUZyHPQY7gLqsMCXZ5EDCgjESUHcB17tiR1h3Z","4C2Mz1bVqe42QDDTyJ4HFCFFGsH5YDzo91Cen5w5NGun","6kbC5epG18DF2DwPEW34tBy5pGFS7pEGALR3v5MGxgc5","5dHEPTgvscKkAc54R77xUeGdgShdG9Mf6gJ9bwBqyb3V","8mBJC9qdPNDyrpAbrdwGbBpEAjPqwtvZQVmbnKFXXY2P","Hr8i6MAm4W5Lwb2fB2CD44A2t3Ag3gGc1rmd6amrWsWC","AoPebtuJC4f2RweZSxcVCcdeTgaEXY64Uho8b5HdPxAR","3mYsmBQLB8EZSjRwtWjPbbE8LiM1oCCtNZZKiVBKsePa","7XawhbbxtsRcQA8KTkHT9f9nc6d69UwqCDh6U5EEbEmX","81PmLJ8j2P8CC5EJAAhWGYA4HgJvoKs4Y94ALZF2uKKG","af8HJg2ffWoKJ6vKvkWJUJ9iWbRR83WgXs8HPs26WGr","4fgubfZVL6L8tc5x1j65S14P2Tnxr1YayKtKavQV5MBo","AMMwkf57c7ZsbbDCXvBit9zFehMr1xRn8ZzaT1iDF18o","DWvhPYVogsEKEsehHApUtjhP1UFtApkAPFJqFh2HPmWz","GjrXcSvwzGrz1RwKYGVWdbZyXzyotgichSHB95moDmf8","E9EvurfzdSQaqCFBUaD4MgV93htuRQ93sghm922Pik88","He3iAEV5rYjv6Xf7PxKro19eVrC3QAcdic5CF2D2obPt","GDVhJmDTdSExwHeMT5RvUBUNKLwwXNKhH8ndm1tpTv6B","21r2zeCacmm5YvbGoPZh9ZoGREuodhcbQHaP5tZmzY14","DvxLb4NnQUYq1gErk35HVt9g8kxjNbviJfiZX1wqraMv","BLVjPTgzyfiKSgDujTNKKNzW2GXx7HhdMxgr2LQ2g83s","DkMAuUCQHC6BNgVnjtM5ZTKm1T8MsriQ6bL3Umi6NBtG","796pvggjoDCPUtUSVFSCLqPRyes5YPvRiu4zFWX582wf","3XwxHcbyqcd1xkdczaPv3TNCZsevELD4Zux3pu4sF2D8","EvWJC2mnmu9C9aQrsJLXw8FhUcwBzFEUQsP1E5Y6a5N7","4Sx1NLrQiK4b9FdLKe2DhQ9FHvRzJhzKN3LoD6BrEPnf","94CQopiGxxUXf2avyMZhAFaBdNatd62ttYGoTVQBRGdi","BuS4ScFcZjEBixF1ceCTiXs4rqt4WDfXLoth7VcM2Eoj","BkfGDk676QFtTiGxn7TtEpHayJZRr6LgNk9uTV2MH4bR","DiWxV1SPXPNJRCt5Ao1mJRAxjw97hJVyj8qGzZwFbAFb","GDHXjn9wF2zxW35DBkCegWQdoTfFBC9LXt7D5ovJxQ5B","96hPvuJ3SRT82m7BAc7G1AUVPVcoj8DABAa5gT7wjgzX","DSkXJYPZqJ3yHQECyVyh3xiE3HBrt7ARmepwNDA9rREn","5TgJXpv6H3KJhHCuP7KoDLSCmi8sM8nABizP7CmYAKm1","SJmR8rJgzzCi4sPjGnrNsqY4akQb3jn5nsxZBhyEifC","7XXKU8oGDbeGrkPyK5yHKzdsrMJtB7J2TMugjbrXEhB5","EyDgEU9BdG7m6ZK4bYERxbN4NCJ129WzPtv23dBkfsLg","61JtCkTQKSeBU8ztEScByZiBhS6KAHSXfQduVyA4s1h7","34oD4akb2DeNcCw1smKHPsD3iqQQQWmNy3cY81nz7HP8","6UmmUiYoBjSrhakAobJw8BvkmJtDVxaeBtbt7rxWo1mg","GaqgfieVmnmY4ZsZHHA6L5RSVzCGL3sKx4UgHBaYNy8m","8iQFhWyceGREsWnLM8NkG9GC8DvZunGZyMzuyUScgkMK","AVs9TA4nWDzfPJE9gGVNJMVhcQy3V9PGazuz33BfG2RA","asdEJnE7osjgnSyQkSZJ3e5YezbmXuDQPiyeyiBxoUm","GmaDNMWsTYWjaXVBjJTHNmCWAKU6cn5hhtWWYEZt4odo","ZfvDXXUhZDzDVsapffUyXHj9ByCoPjP4thL6YXcZ9ix","EGyhb2uLAsRUbRx9dNFBjMVYnFaASWMvD6RE1aEf2LxL","6GUF8Qb5FWmifzYpRdKomFNbSQAsLShhT45GbTGg34VJ","6nJes56KF999Q8VtQTrgWEHJGAfGMuJktGb8x2uWff2u","34tFULRrRwh4bMcBLPtJaNqqe5pVgGZACi5sR8Xz95KC","2bnZ1edbvK3CK3LTNZ5jH9anvXYCmzPR4W2HQ6Ngsv5K","9xyCzsHi1wUWva7t5Z8eAvZDRmUCVhRrbaFfm3VbU4Mf","F73euqPynBwrgcZn3fNSEneSnYasDQohPM5aZazW9hp2","5tho4By9RsqTF1rbm9Akiepik3kZBT7ffUzGg8bL1mD","8Fr3wxZXLtiSozqms5nF4XXGHNSNqcMC6K6MvRqEfk4a","Dm1Q15216uRARmQTbo6VfnyEGVzRvLTm4TfCWWX4MF3F","J3CoGcJqHquUdSgS7qAwdGbp3so4EpLX8eVDdGuauvi","BKLCqnuk4qc5iHWuJuewMxuvsNZXuTBSUyRT5ftnRb6H","5ZPBHzMr19iQjBaDgFDYGAx2bxaQ3TzWmSS7zAGrHtQJ","Am9FpX73ctZ3HzohcRdyCCv84iT7nugevqLjY5yTSUQP","DGSnfcE1kw4uDC6jgrsZ3s5CMfsWKN7JNjDNasHdvKfq","8hvVAhShYLPThcxrxwMNAWmgRCSjtxygj11EGHp2WHz8","9Hm8QX7ZhE9uB8L2arChmmagZZBtBmnzBbpfxzkQp85D","6a1CsrpeZubDjEJE9s1CMVheB6HWM5d7m1cj2jkhyXhj","vVXfY15WdPsCmLvbiP4hWWECPFeAvPTuPNq3Q4BXfhy","A21ui9aYTSs3CbkscaY6irEMQx3Z59dLrRuZQTt2hJwQ","7qZJTK5NatxQJRTxZvHi3gRu4cZZsKr8ZPzs7BA5JMTC","43UHp4TuwQ7BYsaULN1qfpktmg7GWs9GpR8TDb8ovu9c","6gpZ9JkLoYvpA5cwdyPZFsDw6tkbPyyXM5FqRqHxMCny","2kPA9XUuHUifcCYTnjSuN7ZrC3ma8EKPrtzUhC86zj3m","EBqQdu9rGe6j3WGJQSyTvDjUMWcRd6uLcxSS4TbFT31t","33dWwj33J3NUzoTmkMAUq1VdXZL89qezxkdaHdN88vK2","FEFzBbbEK8yDigqyJPgJKMR5X1xZARC25QTCskvudjuK","Ghj3v2qYbSp6XqmH4NV4KRu4Rrgqoh2Ra7L9jEdsbNzF","BhuMVCzwFVZMSuc1kBbdcAnXwFg9p4HJp7A9ddwYjsaF","ynV2H2b7FcRBho2TvE25Zc4gDeuu2N45rUw9DuJYjJ9","8idN93ZBpdtMp4672aS4GGMDy7LdVWCCXH7FKFdMw9P4","Ek8uoHjADzbNk2yr2HysybwFk1h2j9XXDsWAjAJN38n1","7rVAbPFzqaBmydukTDFAuBiuyBrTVhpa5LpfDRrjX9mr","HuMDhYhW1BmBjXoJZBdjqaqoD3ehQeCUMbDSiZsaXSDU","D95EzH4ZsGLikvYzp7kmz1RM1xNMo1MXXiXaedQesA2m","3hhSfFhbk7Kd8XrRYKCcGAyUVYRaW9MLhcqAaU9kx6SA","2Tv6eMih3iqxHrLAWn372Nba4A8FT8AxFSbowBmmTuAd","7eM9KWYiJmNfDfeztMoEZE1KPyWD54LRxM9GmRY9ske6","3HYhQC6ne6SAPVT5sPTKawRUxv9ZpYyLuk1ifrw8baov","EZRHhpvAP4zEX1wZtTQcf6NP4FLWjs9c6tMRBqfrXgFD","GRM4jGMtx64sEocBFz6ZgdogF2fyTWiixht8thZoHjkK","H3dhkXcC5MRN7VRXNbWVSvogH8mUQPzpn8PYQL7HfBVg","4yrHms7ekgTBgJg77zJ33TsWrraqHsCXDtuSZqUsuGHb","EoNrn8iUhwgJySD1pHu8Qxm5gSQqLK3za4m8xzD2RuEb","8J5fa8WBGaDSv8AUpgtqdh9HM5AZuSf2ijvSkKoaCXCi","9SWy6nbSVZ44XuixEvHpona663pZPpVgzXQ3N7muG4ou","661trVCzDWp114gy4PEK4etbjb3u3RNaP4aENa5uN8Vp","7oYaghDwJ6ZbZwzdzcPqQtW6r4cojSLJDKB6U7tqAK1x","GQJjrG6f8HbxkE3ZVSRpzoyWhQ2RiivT68BybVK9DxME","5DECiJuqwmeCptoBEpyJtXKrVfiUrG9nBbBGkxGkPYyF","CbGQojcizFEHn3woL7NPu3P9BLL1SWz5a8zkL9gks24q","CWQVga1qUbpZXjrWQRj6U6tmL3HhrFiAT11VYnB8d3CF","HopVRTvFvRe1ED3dRCQrt1h5onkMvY3tKUHRVQMc7MMH","SU7vPveBjEuR5tgQwidRqqTxn1WwraHpydHHBpM2W96","5cmAS6Mj4pG2Vp9hhyu3kpK9yvC7P6ejh9HiobpTE6Jc","8ekXiGjEjtWzd2us3rAsusKv7kKEhPENV7nvzS7RGRYY","13uCPybNakXHGVd2DDVB7o2uwXuf9GqPFkvJMVgKy6UJ","FSSRqrGrDjDXnojhSDrDBknJeQ83pyACemnaMLaZDD1U","3cmPpX8kKzEra2umtLCDxMfjma82ELtAMaSYVmdaNLxi","7Z1c6GHutf3q2MNheyFE8KMNVEALuiPaqoEMyjbCbuku","2PfKnjEfoUoVDbDS1YwvZ8HuPGBCpN831mnTuqTAJZjH","Enq8vJucRbkzKA1i1PahJNhMyUTzoVL5Cs8n5rC3NLGn","8FrCybrh7UFznP1hVHg8kXZ8bhii37c7BGzmjkdcsGJp","4crhN3D8R5rnZd66q9b32P7K649e5XdzCfPMPiTzBceH","zoouer92idprkptX76yvhp4stK2keTzJpMNkeLqtxAx","CrWbfKwyAaUfYctXWF9iaDUP4AH5t6k6bbaWnXBL8nHm","D8pasgJWjP9wy39fzeD8BUjQMvYCZxABzPcnuoDSLHBB","7e8GrkwsRm5sS5UaKobLJUNu9esmrzg37dqX6aQyuver","FTyJCLwQ3YvVfanJp8mtC2eqmvZPpzSpmNLqWpaPaXbC","8GJdzPuEBPP3BHJpcspBcfpRZV4moZMFwhTAuXebaPL8","FsERtRjCEQNyND3ccnMGrd61ntPmJ3tbZs4vvcCzMr1L","DqYSvijBXydSx9GfvVDjEzUg5StLLrkqZVPzsU2FeVZ2","Fb1WR1kYvG1tHu4pwAxXQpdKT8Grh9i7ES9rZusLg7D6","GfvqUB36CPfqZDz5ntQ2YsoKRwg1MCewmurhc7jw3P5s","Hv1BFhyADPjYXTqEeMgwzoybnNwYrHXNv7U2VjcAuEDr","FvN7dJz7GX1XB1BTk6jD5rEKRxQc3ZwNkWJKai5sBJWS","MphbxYtji1FSkm7G2FNGpUUz5AWn7iRPNFAvEqD4mzE","783kPvwHwDXaU32kV8NK5dB4JVeMWQwe8a3WUNZFpupr","E9Z2JeEKS2WGGyA18mGU33rnQskK9moPhM4tdzrv24fh","Bhw7DbVwWMcTBXoKaWgsCaofL6QqmQQ65FCSGfgCEawm","69Mo81rUPDgru4UbigPQovx7cYBxpEm44qQok8wcut4M","HcqHvH27wk42L1ND5YPhLDJu7oGsU7HGSreMiXdq5LNK","zuivKkgkNFFkV9jfNpsU1p5tWNbDWUEx5XX16m4k2Ej","4ELBQuq3ivhLamfCT36As5sXLkQDWRJw1pJ9JVFLp6gK","HARRXESCwid3xMi2qThag1PXzmp6rDhAzMR9THhFRQGf","CfBSfVTcYFJsD8vZ2fTiMGkUYFim2rv8weAoqHxUU2pn","A7ZxDrK9LSkVXhfRTu2pRCinwYfdxW2kK6DaJk12jRWw","4ZYiiVakejxGyJ3tuBzYWoHyEV1rk7Hm7viydG6DNaUN","6eRECBcCVP82AvAd6Di4rZApa2btLf8RDUqrTigt4hS4"],xp=[],Bp=[];import{PublicKey as da}from"@solana/web3.js";var oo="routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS",Ft=new da(oo),ro={[oo]:1},so={1:Ft},ao={1:4};import{PublicKey as co,Transaction as uo,TransactionInstruction as mo}from"@solana/web3.js";import{intersection as lo,xor as pa}from"lodash";var Pe=z.from("Route"),dt=class extends Ie{static getProgramId(e){let t=so[e];return Pe.assertArgument(!!t,"invalid version","version",e),t}static getVersion(e){let t=e.toBase58(),n=ro[t];return Pe.assertArgument(!!n,"invalid program id","programId",t),n}static getLiquidityVersion(e){let t=ao[e];return Pe.assertArgument(!!t,"invalid version","version",e),t}static getAssociatedMiddleStatusAccount({programId:e,fromPoolId:t,middleMint:n,owner:i}){let{publicKey:r}=ne([t.toBuffer(),n.toBuffer(),i.toBuffer()],e);return r}static makeSwapInstruction(e){let{fixedSide:t}=e;return t==="in"?[this.makeSwapInFixedInInstruction(e),this.makeSwapOutFixedInInstruction(e)]:Pe.throwArgumentError("invalid params","params",e)}static makeSwapInFixedInInstruction({fromPoolKeys:e,toPoolKeys:t,userKeys:n,amountIn:i,amountOut:r}){let o=C([V("instruction"),A("amountIn"),A("amountOut")]),s=Buffer.alloc(o.span),a;return e.version===4?(o.encode({instruction:0,amountIn:E(i),amountOut:E(r)},s),a=[w(pe,!1),w(W,!1),w(e.programId,!1),S(e.id,!1),w(t.id,!1),w(e.authority,!1),S(e.openOrders,!1),S(e.baseVault,!1),S(e.quoteVault,!1),w(e.marketProgramId,!1),S(e.marketId,!1),S(e.marketBids,!1),S(e.marketAsks,!1),S(e.marketEventQueue,!1),S(e.marketBaseVault,!1),S(e.marketQuoteVault,!1),w(e.marketAuthority,!1),S(n.inTokenAccount,!1),S(n.middleTokenAccount,!1),S(n.middleStatusAccount,!1),w(n.owner,!0)]):(o.encode({instruction:2,amountIn:E(i),amountOut:E(r)},s),a=[w(pe,!1),w(W,!1),w(e.programId,!1),S(e.id,!1),w(t.id,!1),w(e.authority,!1),S(e.openOrders,!1),S(e.baseVault,!1),S(e.quoteVault,!1),w(Ze,!1),w(e.marketProgramId,!1),S(e.marketId,!1),S(e.marketBids,!1),S(e.marketAsks,!1),S(e.marketEventQueue,!1),S(e.id,!1),S(e.id,!1),S(e.id,!1),S(n.inTokenAccount,!1),S(n.middleTokenAccount,!1),S(n.middleStatusAccount,!1),w(n.owner,!0)]),new mo({programId:Ft,keys:a,data:s})}static makeSwapOutFixedInInstruction({fromPoolKeys:e,toPoolKeys:t,userKeys:n}){let i=C([V("instruction")]),r=Buffer.alloc(i.span),o;return t.version===4?(i.encode({instruction:1},r),o=[w(W,!1),w(t.programId,!1),w(e.id,!1),S(t.id,!1),w(t.authority,!1),S(t.openOrders,!1),S(t.baseVault,!1),S(t.quoteVault,!1),w(t.marketProgramId,!1),S(t.marketId,!1),S(t.marketBids,!1),S(t.marketAsks,!1),S(t.marketEventQueue,!1),S(t.marketBaseVault,!1),S(t.marketQuoteVault,!1),w(t.marketAuthority,!1),S(n.middleTokenAccount,!1),S(n.outTokenAccount,!1),S(n.middleStatusAccount,!1),w(n.owner,!0)]):(i.encode({instruction:3},r),o=[w(W,!1),w(t.programId,!1),w(e.id,!1),S(t.id,!1),w(t.authority,!1),S(t.openOrders,!1),S(t.baseVault,!1),S(t.quoteVault,!1),w(Ze,!1),w(t.marketProgramId,!1),S(t.marketId,!1),S(t.marketBids,!1),S(t.marketAsks,!1),S(t.marketEventQueue,!1),S(t.id,!1),S(t.id,!1),S(t.id,!1),S(n.middleTokenAccount,!1),S(n.outTokenAccount,!1),S(n.middleStatusAccount,!1),w(n.owner,!0)]),new mo({programId:Ft,keys:o,data:r})}static makeSwapTransaction(e){return _(this,null,function*(){let{connection:t,fromPoolKeys:n,toPoolKeys:i,userKeys:r,amountIn:o,amountOut:s,fixedSide:a,config:m}=e,{tokenAccounts:u,owner:f}=r;Pe.debug("amountIn:",o),Pe.debug("amountOut:",s),Pe.assertArgument(!o.isZero()&&!s.isZero(),"amounts must greater than zero","currencyAmounts",{amountIn:o.toFixed(),amountOut:s.toFixed()});let{bypassAssociatedCheck:l}=U({bypassAssociatedCheck:!1},m),b=o instanceof q?o.token:B.WSOL,y=s instanceof q?s.token:B.WSOL,d=this._selectTokenAccount({tokenAccounts:u,mint:b.mint,owner:f,config:{associatedOnly:!1}}),g=this._selectTokenAccount({tokenAccounts:u,mint:y.mint,owner:f}),P=[n.baseMint.toBase58(),n.quoteMint.toBase58()],T=[i.baseMint.toBase58(),i.quoteMint.toBase58()],k=lo(P,T)[0],I=new co(k),D=this._selectTokenAccount({tokenAccounts:u,mint:I,owner:f}),[h,O]=[o.raw,s.raw],M=[],H=[],te=[],Q=yield this._handleTokenAccount({connection:t,side:"in",amount:h,mint:b.mint,tokenAccount:d,owner:f,frontInstructions:M,signers:H,bypassAssociatedCheck:l}),se=yield this._handleTokenAccount({connection:t,side:"out",amount:0,mint:y.mint,tokenAccount:g,owner:f,frontInstructions:M,signers:H,bypassAssociatedCheck:l}),ae=yield this._handleTokenAccount({connection:t,side:"in",amount:0,mint:I,tokenAccount:D,owner:f,frontInstructions:M,signers:H,bypassAssociatedCheck:l});te.push(...this.makeSwapInstruction({fromPoolKeys:n,toPoolKeys:i,userKeys:{inTokenAccount:Q,outTokenAccount:se,middleTokenAccount:ae,middleStatusAccount:this.getAssociatedMiddleStatusAccount({programId:Ft,fromPoolId:n.id,middleMint:I,owner:f}),owner:f},amountIn:h,amountOut:O,fixedSide:a}));let ue=null,Ne=null;return M.length>0&&(ue={transaction:new uo().add(...M),signers:H}),te.length>0&&(Ne={transaction:new uo().add(...te),signers:[]}),{setupTransaction:ue,swapTransaction:Ne}})}static computeAmountOut({fromPoolKeys:e,toPoolKeys:t,fromPoolInfo:n,toPoolInfo:i,amountIn:r,currencyOut:o,slippage:s}){let{swap:a}=ye.getEnabledFeatures(n),{swap:m}=ye.getEnabledFeatures(i);Pe.assertArgument(a&&m,"pools swap not enabled","pools",{fromPoolKeys:e,toPoolKeys:t,fromPoolInfo:n,toPoolInfo:i});let u=r instanceof q?r.token:B.WSOL,f=o instanceof B?o:B.WSOL;Pe.assertArgument(ye.includesToken(u,e)&&ye.includesToken(f,t),"pools cannot be routed","pools",{fromPoolKeys:e,toPoolKeys:t});let l=[e.baseMint.toBase58(),e.quoteMint.toBase58()],b=[t.baseMint.toBase58(),t.quoteMint.toBase58()],y=[...l,...b],d=[n.baseDecimals,n.quoteDecimals,i.baseDecimals,i.quoteDecimals],g=u.mint.toBase58(),P=f.mint.toBase58(),T=pa(l,b);Pe.assertArgument(T.length===2&&T.includes(g)&&T.includes(P),"xor tokens not match","pools",{fromPoolKeys:e,toPoolKeys:t});let L=lo(l,b);Pe.assertArgument(L.length===1,"cannot found middle token of two pools","pools",{fromPoolKeys:e,toPoolKeys:t});let k=L[0],I=y.indexOf(k),D=d[I],h=new co(k),O=new B(h,D);Pe.debug("from pool:",e),Pe.debug("to pool:",t),Pe.debug("intersection mints:",L),Pe.debug("xor mints:",T),Pe.debug("middleMint:",k);let{minAmountOut:M,priceImpact:H,fee:te}=ye.computeAmountOut({poolKeys:e,poolInfo:n,amountIn:r,currencyOut:O,slippage:s}),{amountOut:Q,minAmountOut:se,priceImpact:ae,fee:ue}=ye.computeAmountOut({poolKeys:t,poolInfo:i,amountIn:M,currencyOut:o,slippage:s}),Ne=null,Zt=r.raw,jt=Q.raw,Ct=r instanceof q?r.token:r.currency;return!Zt.isZero()&&!jt.isZero()&&(Ne=new le(Ct,Zt,o,jt),Pe.debug("executionPrice:",`1 ${Ct.symbol} \u2248 ${Ne.toFixed()} ${o.symbol}`),Pe.debug("executionPrice invert:",`1 ${o.symbol} \u2248 ${Ne.invert().toFixed()} ${Ct.symbol}`)),{amountOut:Q,minAmountOut:se,executionPrice:Ne,priceImpact:H.add(ae),fee:[te,ue]}}};var It=z.from("Trade"),po=["amm","serum","route"],fo=class{static groupPools(e){let t=[];for(let n=0;n<e.length;n++)for(let i=0;i<e.length;i++)n!=i&&t.push([e[n],e[i]]);return t}static makeTradeTransaction(e){return _(this,null,function*(){let{connection:t,routes:n,routeType:i,userKeys:r,amountIn:o,amountOut:s,fixedSide:a,config:m}=e,u=null,f=null;if(i==="amm"){It.assertArgument(n.length===1,"invalid routes with routeType","routes",{routeType:i,routes:n});let{keys:l}=n[0],{transaction:b,signers:y}=yield ye.makeSwapTransaction({connection:t,poolKeys:l,userKeys:r,amountIn:o,amountOut:s,fixedSide:a,config:m});f={transaction:b,signers:y}}else if(i==="route"){It.assertArgument(n.length===2,"invalid routes with routeType","routes",{routeType:i,routes:n});let[l,b]=n,{keys:y}=l,{keys:d}=b,{setupTransaction:g,swapTransaction:P}=yield dt.makeSwapTransaction({connection:t,fromPoolKeys:y,toPoolKeys:d,userKeys:r,amountIn:o,amountOut:s,fixedSide:a,config:m});u=g,f=P}return{setupTransaction:u,tradeTransaction:f}})}static getBestAmountOut({pools:e,markets:t,amountIn:n,currencyOut:i,slippage:r,features:o}){let s=e||[],a=t||[],m=o||po;It.debug("features:",m),It.assertArgument(s.length!==0||a.length!==0,"must provide at least one source of trade","pools, markets",{pools:e,markets:t});let u=[],f="amm",l=i instanceof B?new q(i,0):new me(i,0),b=l,y=null,d=null,g=new Ae(v),P=[];if(m.includes("amm"))for(let{poolKeys:T,poolInfo:L}of s)try{let{amountOut:k,minAmountOut:I,currentPrice:D,executionPrice:h,priceImpact:O,fee:M}=ye.computeAmountOut({poolKeys:T,poolInfo:L,amountIn:n,currencyOut:i,slippage:r});k.gt(l)&&(u=[{source:"amm",keys:T}],f="amm",l=k,b=I,y=D,d=h,g=O,P=[M])}catch(k){}if(m.includes("route")){let T=this.groupPools(s);for(let L of T){if(L.length!==2)continue;let[k,I]=L,{poolKeys:D,poolInfo:h}=k,{poolKeys:O,poolInfo:M}=I;try{let{amountOut:H,minAmountOut:te,executionPrice:Q,priceImpact:se,fee:ae}=dt.computeAmountOut({fromPoolKeys:D,toPoolKeys:O,fromPoolInfo:h,toPoolInfo:M,amountIn:n,currencyOut:i,slippage:r});H.gt(l)&&(u=[{source:"amm",keys:D},{source:"amm",keys:O}],f="route",l=H,b=te,d=Q,g=se,P=ae)}catch(H){}}}return{routes:u,routeType:f,amountOut:l,minAmountOut:b,fixedSide:"in",currentPrice:y,executionPrice:d,priceImpact:g,fee:P}}static getBestAmountIn({pools:e,markets:t,amountOut:n,currencyIn:i,slippage:r,features:o}){let s=e||[],a=t||[],m=o||po;It.debug("features:",m),It.assertArgument(s.length!==0||a.length!==0,"must provide at least one source of trade","pools, markets",{pools:e,markets:t});let u=[],f="amm",l=i instanceof B?new q(i,0):new me(i,0),b=l,y=null,d=null,g=new Ae(v);if(m.includes("amm"))for(let{poolKeys:P,poolInfo:T}of s){let{amountIn:L,maxAmountIn:k,currentPrice:I,executionPrice:D,priceImpact:h}=ye.computeAmountIn({poolKeys:P,poolInfo:T,amountOut:n,currencyIn:i,slippage:r});(L.lt(l)||l.isZero())&&(u=[{source:"amm",keys:P}],f="amm",l=L,b=k,y=I,d=D,g=h)}return{routes:u,routeType:f,amountIn:l,maxAmountIn:b,currentPrice:y,executionPrice:d,priceImpact:g}}};import yo from"bn.js";var Te=60,Gn=1024,j=class{static getTickArrayAddressByTick(e,t,n,i){let r=j.getTickArrayStartIndexByTick(n,i),{publicKey:o}=Se(e,t,r);return o}static getTickOffsetInArray(e,t){if(e%t!=0)throw new Error("tickIndex % tickSpacing not equal 0");let n=j.getTickArrayStartIndexByTick(e,t),i=Math.floor((e-n)/t);if(i<0||i>=Te)throw new Error("tick offset in array overflow");return i}static getTickArrayStartIndexByTick(e,t){let n=e/(Te*t);return e<0&&e%(Te*t)!=0?n=Math.ceil(n)-1:n=Math.floor(n),n*(t*Te)}static getTickArrayOffsetInBitmapByTick(e,t){let n=t*Te,i=Math.floor(e/n)+512;return Math.abs(i)}static checkTickArrayIsInitialized(e,t,n){let i=n*Te,r=Math.floor(t/i)+512,o=Math.abs(r);return{isInitialized:e.testn(o),startIndex:(o-512)*i}}static getNextTickArrayStartIndex(e,t,n){return n?e-t*Te:e+t*Te}static mergeTickArrayBitmap(e){return e[0].add(e[1].shln(64)).add(e[2].shln(128)).add(e[3].shln(192)).add(e[4].shln(256)).add(e[5].shln(320)).add(e[6].shln(384)).add(e[7].shln(448)).add(e[8].shln(512)).add(e[9].shln(576)).add(e[10].shln(640)).add(e[11].shln(704)).add(e[12].shln(768)).add(e[13].shln(832)).add(e[14].shln(896)).add(e[15].shln(960))}static getInitializedTickArrayInRange(e,t,n,i){if(n%(t*Te)!=0)throw new Error("Invild tickArrayStartIndex");let r=Math.floor(n/(t*Te))+512;return[...j.searchLowBitFromStart(e,r-1,0,i,t),...j.searchHightBitFromStart(e,r,Gn,i,t)]}static getAllInitializedTickArrayStartIndex(e,t){return j.searchHightBitFromStart(e,0,Gn,Gn,t)}static getAllInitializedTickArrayInfo(e,t,n,i){let r=[],o=j.getAllInitializedTickArrayStartIndex(n,i);for(let s of o){let{publicKey:a}=Se(e,t,s);r.push({tickArrayStartIndex:s,tickArrayAddress:a})}return r}static getAllInitializedTickInTickArray(e){return e.ticks.filter(t=>t.liquidityGross.gtn(0))}static searchLowBitFromStart(e,t,n,i,r){let o=0,s=[];for(let a=t;a>=n;a--){if(e.shrn(a).and(new yo(1)).eqn(1)){let m=(a-512)*(r*Te);s.push(m),o++}if(o>=i)break}return s}static searchHightBitFromStart(e,t,n,i,r){let o=0,s=[];for(let a=t;a<n;a++){if(e.shrn(a).and(new yo(1)).eqn(1)){let m=(a-512)*(r*Te);s.push(m),o++}if(o>=i)break}return s}};var Df=C([ce(8),V("bump"),rt("index"),R(""),he("protocolFeeRate"),he("tradeFeeRate"),rt("tickSpacing"),he("fundFeeRate"),F(he(),1,"padding"),R("fundOwner"),F(A(),3,"padding")]),fa=C([he("blockTimestamp"),K("sqrtPriceX64"),K("cumulativeTimePriceX64"),F(K(),1,"")]),Yn=C([ce(8),ln("initialized"),R("poolId"),F(fa,1e3,"observations"),F(K(),5,"")]),ya=C([V("rewardState"),A("openTime"),A("endTime"),A("lastUpdateTime"),K("emissionsPerSecondX64"),A("rewardTotalEmissioned"),A("rewardClaimed"),R("tokenMint"),R("tokenVault"),R("creator"),K("rewardGrowthGlobalX64")]),bo=C([ce(8),V("bump"),R("ammConfig"),R("creator"),R("mintA"),R("mintB"),R("vaultA"),R("vaultB"),R("observationId"),V("mintDecimalsA"),V("mintDecimalsB"),rt("tickSpacing"),K("liquidity"),K("sqrtPriceX64"),Be("tickCurrent"),rt("observationIndex"),rt("observationUpdateDuration"),K("feeGrowthGlobalX64A"),K("feeGrowthGlobalX64B"),A("protocolFeesTokenA"),A("protocolFeesTokenB"),K("swapInAmountTokenA"),K("swapOutAmountTokenB"),K("swapInAmountTokenB"),K("swapOutAmountTokenA"),V("status"),F(V(),7,""),F(ya,3,"rewardInfos"),F(A(),16,"tickArrayBitmap"),A("totalFeesTokenA"),A("totalFeesClaimedTokenA"),A("totalFeesTokenB"),A("totalFeesClaimedTokenB"),A("fundFeesTokenA"),A("fundFeesTokenB"),F(A(),15*4-2,"padding")]),ba=C([K("growthInsideLastX64"),A("rewardAmountOwed")]),Ao=C([ce(8),V("bump"),R("nftMint"),R("poolId"),Be("tickLower"),Be("tickUpper"),K("liquidity"),K("feeGrowthInsideLastX64A"),K("feeGrowthInsideLastX64B"),A("tokenFeesOwedA"),A("tokenFeesOwedB"),F(ba,3,"rewardInfos"),F(A(),8,"")]),Nf=C([ce(8),V("bump"),R("poolId"),Be("tickLowerIndex"),Be("tickUpperIndex"),K("liquidity"),K("feeGrowthInsideLastX64A"),K("feeGrowthInsideLastX64B"),A("tokenFeesOwedA"),A("tokenFeesOwedB"),F(K(),3,"rewardGrowthInside"),F(A(),8,"")]),Aa=C([Be("tick"),Ii("liquidityNet"),K("liquidityGross"),K("feeGrowthOutsideX64A"),K("feeGrowthOutsideX64B"),F(K(),3,"rewardGrowthsOutsideX64"),F(he(),13,"")]),Wt=C([ce(8),R("poolId"),Be("startTickIndex"),F(Aa,Te,"ticks"),V("initializedTickCount"),F(V(),115,"")]),go=C([ce(329),F(R(),100,"whitelistMints")]);import{ComputeBudgetProgram as So,TransactionInstruction as je}from"@solana/web3.js";var $e={createPool:[233,146,209,142,207,104,64,188],initReward:[95,135,192,196,242,129,230,68],setRewardEmissions:[112,52,167,75,32,201,211,137],openPosition:[135,128,47,77,15,152,240,49],closePosition:[123,134,81,0,49,68,98,98],increaseLiquidity:[46,156,243,118,13,205,251,178],decreaseLiquidity:[160,38,208,111,104,91,44,1],swap:[248,198,158,145,225,117,135,200],collectReward:[18,237,166,197,34,16,213,144]};function Po(p,e,t,n,i,r,o,s,a,m){let u=C([K("sqrtPriceX64")]),f=[{pubkey:t,isSigner:!0,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:W,isSigner:!1,isWritable:!1},{pubkey:pe,isSigner:!1,isWritable:!1},{pubkey:en,isSigner:!1,isWritable:!1}],l=Buffer.alloc(u.span);u.encode({sqrtPriceX64:m},l);let b=Buffer.from([...$e.createPool,...l]);return new je({keys:f,programId:p,data:b})}function To(p,e,t,n,i,r,o,s,a,m,u,f,l,b,y,d,g,P,T,L,k,I){let D=C([Be("tickLowerIndex"),Be("tickUpperIndex"),Be("tickArrayLowerStartIndex"),Be("tickArrayUpperStartIndex"),K("liquidity"),A("amountMinA"),A("amountMinB")]),h=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!0,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:b,isSigner:!1,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!0},{pubkey:en,isSigner:!1,isWritable:!1},{pubkey:pe,isSigner:!1,isWritable:!1},{pubkey:W,isSigner:!1,isWritable:!1},{pubkey:ci,isSigner:!1,isWritable:!1},{pubkey:Dt,isSigner:!1,isWritable:!1}],O=Buffer.alloc(D.span);D.encode({tickLowerIndex:d,tickUpperIndex:g,tickArrayLowerStartIndex:P,tickArrayUpperStartIndex:T,liquidity:L,amountMinA:k,amountMinB:I},O);let M=Buffer.from([...$e.openPosition,...O]);return new je({keys:h,programId:p,data:M})}function ko(p,e,t,n,i){let r=C([]),o=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:pe,isSigner:!1,isWritable:!1},{pubkey:W,isSigner:!1,isWritable:!1}],s=Buffer.alloc(r.span);r.encode({},s);let a=Buffer.from([...$e.closePosition,...s]);return new je({keys:o,programId:p,data:a})}function wo(p,e,t,n,i,r,o,s,a,m,u,f,l,b,y){let d=C([K("liquidity"),A("amountMaxA"),A("amountMaxB")]),g=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:W,isSigner:!1,isWritable:!1}],P=Buffer.alloc(d.span);d.encode({liquidity:l,amountMaxA:b,amountMaxB:y},P);let T=Buffer.from([...$e.increaseLiquidity,...P]);return new je({keys:g,programId:p,data:T})}function Lo(p,e,t,n,i,r,o,s,a,m,u,f,l,b,y,d){let g=C([K("liquidity"),A("amountMinA"),A("amountMinB")]),P=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:W,isSigner:!1,isWritable:!1},...l.map(k=>[{pubkey:k.poolRewardVault,isSigner:!1,isWritable:!0},{pubkey:k.ownerRewardVault,isSigner:!1,isWritable:!0}]).flat()],T=Buffer.alloc(g.span);g.encode({liquidity:b,amountMinA:y,amountMinB:d},T);let L=Buffer.from([...$e.decreaseLiquidity,...T]);return new je({keys:P,programId:p,data:L})}function Xn(p,e,t,n,i,r,o,s,a,m,u,f,l,b){let y=C([A("amount"),A("otherAmountThreshold"),K("sqrtPriceLimitX64"),ln("isBaseInput")]),d=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:W,isSigner:!1,isWritable:!1},...a.map(T=>({pubkey:T,isSigner:!1,isWritable:!0}))],g=Buffer.alloc(y.span);y.encode({amount:u,otherAmountThreshold:f,sqrtPriceLimitX64:l,isBaseInput:b},g);let P=Buffer.from([...$e.swap,...g]);return new je({keys:d,programId:p,data:P})}function Io(p,e,t,n,i,r,o,s,a,m,u){let f=C([A("openTime"),A("endTime"),K("emissionsPerSecondX64")]),l=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:W,isSigner:!1,isWritable:!1},{pubkey:pe,isSigner:!1,isWritable:!1},{pubkey:en,isSigner:!1,isWritable:!1}],b=Buffer.alloc(f.span);f.encode({openTime:E(a),endTime:E(m),emissionsPerSecondX64:u},b);let y=Buffer.from([...$e.initReward,...b]);return new je({keys:l,programId:p,data:y})}function ho(p,e,t,n,i,r,o,s,a,m,u){let f=C([V("rewardIndex"),K("emissionsPerSecondX64"),A("openTime"),A("endTime")]),l=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:W,isSigner:!1,isWritable:!1}],b=Buffer.alloc(f.span);f.encode({rewardIndex:s,emissionsPerSecondX64:u,openTime:E(a),endTime:E(m)},b);let y=Buffer.from([...$e.setRewardEmissions,...b]);return new je({keys:l,programId:p,data:y})}function Ro(p,e,t,n,i,r){let o=C([V("rewardIndex")]),s=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:W,isSigner:!1,isWritable:!1}],a=Buffer.alloc(o.span);o.encode({rewardIndex:r},a);let m=Buffer.from([...$e.collectReward,...a]);return new je({keys:s,programId:p,data:m})}function Ce(){return[So.setComputeUnitLimit({units:1e6}),So.setComputeUnitPrice({microLamports:1})]}import{Keypair as Eo,PublicKey as qe,SystemProgram as ka,Transaction as De}from"@solana/web3.js";import be from"bn.js";import Z from"decimal.js";import pt from"bn.js";var et=new pt(-1),Ye=new pt(1).shln(64),An=new pt(1).shln(128),Hn=Ye.sub(ie),Gt=64,xo=An.subn(1),ht=-307200,Yt=-ht,ve=new pt("3939943522091"),Ke=new pt("86367321006760116002434269"),Bo=-307200,Co=306600,Do=14,No="59543866431248",Oo="184467440737095516",_o="15793534762490258745",gn=new pt(10).pow(new pt(6)),ga=(n=>(n[n.rate_500=500]="rate_500",n[n.rate_3000=3e3]="rate_3000",n[n.rate_10000=1e4]="rate_10000",n))(ga||{}),Ff={[500]:10,[3e3]:60,[1e4]:200};import X from"bn.js";import Xt from"decimal.js";var Qn=15,Sn=class{static getTickArrays(e,t,n,i,r,o){return _(this,null,function*(){let s=j.mergeTickArrayBitmap(o),a=[],m=j.getTickArrayStartIndexByTick(i,r),u=j.getInitializedTickArrayInRange(s,r,m,Math.floor(Qn/2));for(let b=0;b<u.length;b++){let{publicKey:y}=Se(t,n,u[b]);a.push(y)}let f=(yield Ee(e,a)).map(b=>b!==null?Wt.decode(b.data):null),l={};for(let b=0;b<a.length;b++){let y=f[b];y!==null&&(l[y.startTickIndex]=oe(U({},y),{address:a[b]}))}return l})}static nextInitializedTick(e,t,n,i,r,o){let{initializedTick:s,tickArrayAddress:a,tickArrayStartTickIndex:m}=this.nextInitializedTickInOneArray(e,t,n,i,r,o);for(;s==null||s.liquidityGross.lten(0);){if(m=j.getNextTickArrayStartIndex(m,r,o),m<Bo||m>Co)throw new Error("No enough initialized tickArray");let u=n[m];if(u===void 0)continue;let{nextTick:f,tickArrayAddress:l,tickArrayStartTickIndex:b}=this.firstInitializedTickInOneArray(e,t,u,o);[s,a,m]=[f,l,b]}if(s==null)throw new Error("No invaild tickArray cache");return{nextTick:s,tickArrayAddress:a,tickArrayStartTickIndex:m}}static firstInitializedTickInOneArray(e,t,n,i){let r;if(i){let s=Te-1;for(;s>=0;){let a=n.ticks[s];if(a.liquidityGross.gtn(0)){r=a;break}s=s-1}}else{let s=0;for(;s<Te;){let a=n.ticks[s];if(a.liquidityGross.gtn(0)){r=a;break}s=s+1}}let{publicKey:o}=Se(e,t,n.startTickIndex);return{nextTick:r,tickArrayAddress:o,tickArrayStartTickIndex:n.startTickIndex}}static nextInitializedTickInOneArray(e,t,n,i,r,o){let s=j.getTickArrayStartIndexByTick(i,r),a=Math.floor((i-s)/r),m=n[s];if(m==null)return{initializedTick:void 0,tickArrayAddress:void 0,tickArrayStartTickIndex:s};let u;if(o)for(;a>=0;){let l=m.ticks[a];if(l.liquidityGross.gtn(0)){u=l;break}a=a-1}else for(a=a+1;a<Te;){let l=m.ticks[a];if(l.liquidityGross.gtn(0)){u=l;break}a=a+1}let{publicKey:f}=Se(e,t,s);return{initializedTick:u,tickArrayAddress:f,tickArrayStartTickIndex:m.startTickIndex}}};var G=class{static mulDivRoundingUp(e,t,n){let i=e.mul(t),r=i.div(n);return i.mod(n).eq(v)||(r=r.add(ie)),r}static mulDivFloor(e,t,n){if(n.eq(v))throw new Error("division by 0");return e.mul(t).div(n)}static mulDivCeil(e,t,n){if(n.eq(v))throw new Error("division by 0");return e.mul(t).add(n.sub(ie)).div(n)}static x64ToDecimal(e,t){return new Xt(e.toString()).div(Xt.pow(2,64)).toDecimalPlaces(t)}static decimalToX64(e){return new X(e.mul(Xt.pow(2,64)).floor().toFixed())}static wrappingSubU128(e,t){return e.add(An).sub(t).mod(An)}};function ke(p,e){return zn(p.mul(e),64,256)}function Sa(p,e,t){let n=p.toTwos(t).shln(e);return n.imaskn(t+1),n.fromTwos(t)}function zn(p,e,t){let n=p.toTwos(t).shrn(e);return n.imaskn(t-e+1),n.fromTwos(t-e)}var Y=class{static sqrtPriceX64ToPrice(e,t,n){return G.x64ToDecimal(e).pow(2).mul(Xt.pow(10,t-n))}static priceToSqrtPriceX64(e,t,n){return G.decimalToX64(e.mul(Xt.pow(10,n-t)).sqrt())}static getNextSqrtPriceX64FromInput(e,t,n,i){if(!e.gt(v))throw new Error("sqrtPriceX64 must greater than 0");if(!t.gt(v))throw new Error("liquidity must greater than 0");return i?this.getNextSqrtPriceFromTokenAmountARoundingUp(e,t,n,!0):this.getNextSqrtPriceFromTokenAmountBRoundingDown(e,t,n,!0)}static getNextSqrtPriceX64FromOutput(e,t,n,i){if(!e.gt(v))throw new Error("sqrtPriceX64 must greater than 0");if(!t.gt(v))throw new Error("liquidity must greater than 0");return i?this.getNextSqrtPriceFromTokenAmountBRoundingDown(e,t,n,!1):this.getNextSqrtPriceFromTokenAmountARoundingUp(e,t,n,!1)}static getNextSqrtPriceFromTokenAmountARoundingUp(e,t,n,i){if(n.eq(v))return e;let r=t.shln(Gt);if(i){let o=r,s=r.add(n.mul(e));return s.gte(o)?G.mulDivCeil(o,e,s):G.mulDivRoundingUp(o,ie,o.div(e).add(n))}else{let o=n.mul(e);if(!r.gt(o))throw new Error("getNextSqrtPriceFromTokenAmountARoundingUp,liquidityLeftShift must gt amountMulSqrtPrice");let s=r.sub(o);return G.mulDivCeil(r,e,s)}}static getNextSqrtPriceFromTokenAmountBRoundingDown(e,t,n,i){let r=n.shln(Gt);if(i)return e.add(r.div(t));{let o=G.mulDivRoundingUp(r,ie,t);if(!e.gt(o))throw new Error("getNextSqrtPriceFromTokenAmountBRoundingDown sqrtPriceX64 must gt amountDivLiquidity");return e.sub(o)}}static getSqrtPriceX64FromTick(e){if(!Number.isInteger(e))throw new Error("tick must be integer");if(e<ht||e>Yt)throw new Error("tick must be in MIN_TICK and MAX_TICK");let t=e<0?e*-1:e,n=(t&1)!=0?new X("18445821805675395072"):new X("18446744073709551616");return(t&2)!=0&&(n=ke(n,new X("18444899583751176192"))),(t&4)!=0&&(n=ke(n,new X("18443055278223355904"))),(t&8)!=0&&(n=ke(n,new X("18439367220385607680"))),(t&16)!=0&&(n=ke(n,new X("18431993317065453568"))),(t&32)!=0&&(n=ke(n,new X("18417254355718170624"))),(t&64)!=0&&(n=ke(n,new X("18387811781193609216"))),(t&128)!=0&&(n=ke(n,new X("18329067761203558400"))),(t&256)!=0&&(n=ke(n,new X("18212142134806163456"))),(t&512)!=0&&(n=ke(n,new X("17980523815641700352"))),(t&1024)!=0&&(n=ke(n,new X("17526086738831433728"))),(t&2048)!=0&&(n=ke(n,new X("16651378430235570176"))),(t&4096)!=0&&(n=ke(n,new X("15030750278694412288"))),(t&8192)!=0&&(n=ke(n,new X("12247334978884435968"))),(t&16384)!=0&&(n=ke(n,new X("8131365268886854656"))),(t&32768)!=0&&(n=ke(n,new X("3584323654725218816"))),(t&65536)!=0&&(n=ke(n,new X("696457651848324352"))),(t&131072)!=0&&(n=ke(n,new X("26294789957507116"))),(t&262144)!=0&&(n=ke(n,new X("37481735321082"))),e>0&&(n=xo.div(n)),n}static getTickFromPrice(e,t,n){return Y.getTickFromSqrtPriceX64(Y.priceToSqrtPriceX64(e,t,n))}static getTickFromSqrtPriceX64(e){if(e.gt(Ke)||e.lt(ve))throw new Error("Provided sqrtPrice is not within the supported sqrtPrice range.");let t=e.bitLength()-1,n=new X(t-64),i=Sa(n,32,128),r=new X("8000000000000000","hex"),o=0,s=new X(0),a=t>=64?e.shrn(t-63):e.shln(63-t);for(;r.gt(new X(0))&&o<Do;){a=a.mul(a);let y=a.shrn(127);a=a.shrn(63+y.toNumber()),s=s.add(r.mul(y)),r=r.shrn(1),o+=1}let m=s.shrn(32),f=i.add(m).mul(new X(No)),l=zn(f.sub(new X(Oo)),64,128).toNumber(),b=zn(f.add(new X(_o)),64,128).toNumber();return l==b?l:Y.getSqrtPriceX64FromTick(b).lte(e)?b:l}},Rt=class{static getTickWithPriceAndTickspacing(e,t,n,i){let o=Y.getTickFromSqrtPriceX64(Y.priceToSqrtPriceX64(e,n,i))/t;return o<0?o=Math.floor(o):o=Math.ceil(o),o*t}static roundPriceWithTickspacing(e,t,n,i){let r=Rt.getTickWithPriceAndTickspacing(e,t,n,i),o=Y.getSqrtPriceX64FromTick(r);return Y.sqrtPriceX64ToPrice(o,n,i)}},$=class{static addDelta(e,t){return e.add(t)}static getTokenAmountAFromLiquidity(e,t,n,i){if(e.gt(t)&&([e,t]=[t,e]),!e.gt(v))throw new Error("sqrtPriceX64A must greater than 0");let r=n.ushln(Gt),o=t.sub(e);return i?G.mulDivRoundingUp(G.mulDivCeil(r,o,t),ie,e):G.mulDivFloor(r,o,t).div(e)}static getTokenAmountBFromLiquidity(e,t,n,i){if(e.gt(t)&&([e,t]=[t,e]),!e.gt(v))throw new Error("sqrtPriceX64A must greater than 0");return i?G.mulDivCeil(n,t.sub(e),Ye):G.mulDivFloor(n,t.sub(e),Ye)}static getLiquidityFromTokenAmountA(e,t,n,i){e.gt(t)&&([e,t]=[t,e]);let r=n.mul(e).mul(t),o=t.sub(e),s=r.div(o);return i?G.mulDivRoundingUp(s,ie,Hn):s.shrn(Gt)}static getLiquidityFromTokenAmountB(e,t,n){return e.gt(t)&&([e,t]=[t,e]),G.mulDivFloor(n,Hn,t.sub(e))}static getLiquidityFromTokenAmounts(e,t,n,i,r){if(t.gt(n)&&([t,n]=[n,t]),e.lte(t))return $.getLiquidityFromTokenAmountA(t,n,i,!1);if(e.lt(n)){let o=$.getLiquidityFromTokenAmountA(e,n,i,!1),s=$.getLiquidityFromTokenAmountB(t,e,r);return o.lt(s)?o:s}else return $.getLiquidityFromTokenAmountB(t,n,r)}static getAmountsFromLiquidity(e,t,n,i,r){if(t.gt(n)&&([t,n]=[n,t]),e.lte(t))return{amountA:$.getTokenAmountAFromLiquidity(t,n,i,r),amountB:new X(0)};if(e.lt(n)){let o=$.getTokenAmountAFromLiquidity(e,n,i,r),s=$.getTokenAmountBFromLiquidity(t,e,i,r);return{amountA:o,amountB:s}}else return{amountA:new X(0),amountB:$.getTokenAmountBFromLiquidity(t,n,i,r)}}static getAmountsFromLiquidityWithSlippage(e,t,n,i,r,o,s){let{amountA:a,amountB:m}=$.getAmountsFromLiquidity(e,t,n,i,o),u=r?1+s:1-s,f=a.muln(u),l=m.muln(u);return{amountSlippageA:f,amountSlippageB:l}}},ft=class{static swapCompute(e,t,n,i,r,o,s,a,m,u,f,l){if(u.eq(v))throw new Error("amountSpecified must not be 0");if(l||(l=i?ve.add(ie):Ke.sub(ie)),i){if(l.lt(ve))throw new Error("sqrtPriceX64 must greater than MIN_SQRT_PRICE_X64");if(l.gte(m))throw new Error("sqrtPriceX64 must smaller than current")}else{if(l.gt(Ke))throw new Error("sqrtPriceX64 must smaller than MAX_SQRT_PRICE_X64");if(l.lte(m))throw new Error("sqrtPriceX64 must greater than current")}let b=u.gt(v),y={amountSpecifiedRemaining:u,amountCalculated:v,sqrtPriceX64:m,tick:s,accounts:[],liquidity:o,feeAmount:new X(0)},d=0;for(;!y.amountSpecifiedRemaining.eq(v)&&y.sqrtPriceX64!=l&&y.tick<Yt&&y.tick>ht;){if(d>10)throw Error("liquidity limit");let g={};g.sqrtPriceStartX64=y.sqrtPriceX64;let{nextTick:P,tickArrayAddress:T,tickArrayStartTickIndex:L}=Sn.nextInitializedTick(e,t,n,y.tick,a,i);g.tickNext=P.tick,g.initialized=P.liquidityGross.gtn(0),f!==L&&T&&(y.accounts.push(T),f=L),g.tickNext<ht?g.tickNext=ht:g.tickNext>Yt&&(g.tickNext=Yt),g.sqrtPriceNextX64=Y.getSqrtPriceX64FromTick(g.tickNext);let k;if(i&&g.sqrtPriceNextX64.lt(l)||!i&&g.sqrtPriceNextX64.gt(l)?k=l:k=g.sqrtPriceNextX64,[y.sqrtPriceX64,g.amountIn,g.amountOut,g.feeAmount]=ft.swapStepCompute(y.sqrtPriceX64,k,y.liquidity,y.amountSpecifiedRemaining,r),y.feeAmount=y.feeAmount.add(g.feeAmount),b?(y.amountSpecifiedRemaining=y.amountSpecifiedRemaining.sub(g.amountIn.add(g.feeAmount)),y.amountCalculated=y.amountCalculated.sub(g.amountOut)):(y.amountSpecifiedRemaining=y.amountSpecifiedRemaining.add(g.amountOut),y.amountCalculated=y.amountCalculated.add(g.amountIn.add(g.feeAmount))),y.sqrtPriceX64.eq(g.sqrtPriceNextX64)){if(g.initialized){let I=P.liquidityNet;i&&(I=I.mul(et)),y.liquidity=$.addDelta(y.liquidity,I)}y.tick=i?g.tickNext-1:g.tickNext}else y.sqrtPriceX64!=g.sqrtPriceStartX64&&(y.tick=Y.getTickFromSqrtPriceX64(y.sqrtPriceX64));++d}return{amountCalculated:y.amountCalculated,feeAmount:y.feeAmount,sqrtPriceX64:y.sqrtPriceX64,liquidity:y.liquidity,tickCurrent:y.tick,accounts:y.accounts}}static swapStepCompute(e,t,n,i,r){let o={sqrtPriceX64Next:new X(0),amountIn:new X(0),amountOut:new X(0),feeAmount:new X(0)},s=e.gte(t),a=i.gte(v);if(a){let u=G.mulDivFloor(i,gn.sub(new X(r.toString())),gn);o.amountIn=s?$.getTokenAmountAFromLiquidity(t,e,n,!0):$.getTokenAmountBFromLiquidity(e,t,n,!0),u.gte(o.amountIn)?o.sqrtPriceX64Next=t:o.sqrtPriceX64Next=Y.getNextSqrtPriceX64FromInput(e,n,u,s)}else o.amountOut=s?$.getTokenAmountBFromLiquidity(t,e,n,!1):$.getTokenAmountAFromLiquidity(e,t,n,!1),i.mul(et).gte(o.amountOut)?o.sqrtPriceX64Next=t:o.sqrtPriceX64Next=Y.getNextSqrtPriceX64FromOutput(e,n,i.mul(et),s);let m=t.eq(o.sqrtPriceX64Next);return s?(m&&a||(o.amountIn=$.getTokenAmountAFromLiquidity(o.sqrtPriceX64Next,e,n,!0)),m&&!a||(o.amountOut=$.getTokenAmountBFromLiquidity(o.sqrtPriceX64Next,e,n,!1))):(o.amountIn=m&&a?o.amountIn:$.getTokenAmountBFromLiquidity(e,o.sqrtPriceX64Next,n,!0),o.amountOut=m&&!a?o.amountOut:$.getTokenAmountAFromLiquidity(e,o.sqrtPriceX64Next,n,!1)),!a&&o.amountOut.gt(i.mul(et))&&(o.amountOut=i.mul(et)),a&&!o.sqrtPriceX64Next.eq(t)?o.feeAmount=i.sub(o.amountIn):o.feeAmount=G.mulDivCeil(o.amountIn,new X(r),gn.sub(new X(r))),[o.sqrtPriceX64Next,o.amountIn,o.amountOut,o.feeAmount]}};import{PublicKey as Pa}from"@solana/web3.js";import Ta from"bn.js";var xt=class{static getOutputAmountAndRemainAccounts(e,t,n,i,r){let o=n.equals(e.mintA.mint),s=[],{isExist:a,startIndex:m,nextAccountMeta:u}=this.getFirstInitializedTickArray(e,o);if(!a||m===void 0||!u)throw new Error("Invalid tick array");s.push(u);let{amountCalculated:f,accounts:l,sqrtPriceX64:b,feeAmount:y}=ft.swapCompute(e.programId,e.id,t,o,e.ammConfig.tradeFeeRate,e.liquidity,e.tickCurrent,e.tickSpacing,e.sqrtPriceX64,i,m,r);return s.push(...l),{expectedAmountOut:f.mul(et),remainingAccounts:s,executionPrice:b,feeAmount:y}}static getInputAmountAndRemainAccounts(e,t,n,i,r){let o=n.equals(e.mintB.mint),s=[],{isExist:a,startIndex:m,nextAccountMeta:u}=this.getFirstInitializedTickArray(e,o);if(!a||m===void 0||!u)throw new Error("Invalid tick array");s.push(u);let{amountCalculated:f,accounts:l,sqrtPriceX64:b,feeAmount:y}=ft.swapCompute(e.programId,e.id,t,o,e.ammConfig.tradeFeeRate,e.liquidity,e.tickCurrent,e.tickSpacing,e.sqrtPriceX64,i.mul(et),m,r);return s.push(...l),{expectedAmountIn:f,remainingAccounts:s,executionPrice:b,feeAmount:y}}static getFirstInitializedTickArray(e,t){let n=j.mergeTickArrayBitmap(e.tickArrayBitmap),{isInitialized:i,startIndex:r}=j.checkTickArrayIsInitialized(n,e.tickCurrent,e.tickSpacing);if(i){let{publicKey:a}=Se(e.programId,e.id,r);return{isExist:!0,startIndex:r,nextAccountMeta:a}}let{isExist:o,nextStartIndex:s}=this.nextInitializedTickArrayStartIndex(e,t);if(o){let{publicKey:a}=Se(e.programId,e.id,s);return{isExist:!0,startIndex:s,nextAccountMeta:a}}return{isExist:!1,nextAccountMeta:void 0,startIndex:void 0}}static nextInitializedTickArrayStartIndex(e,t){let n=j.mergeTickArrayBitmap(e.tickArrayBitmap),i=j.getTickArrayOffsetInBitmapByTick(e.tickCurrent,e.tickSpacing),r=t?j.searchLowBitFromStart(n,i-1,0,1,e.tickSpacing):j.searchHightBitFromStart(n,i,1024,1,e.tickSpacing);return r.length>0?{isExist:!0,nextStartIndex:r[0]}:{isExist:!1,nextStartIndex:0}}static updatePoolRewardInfos({chainTime:e,poolLiquidity:t,rewardInfos:n}){let i=[];for(let r of n){let o=oe(U({},r),{perSecond:G.x64ToDecimal(r.emissionsPerSecondX64),remainingRewards:void 0});if(o.tokenMint.equals(Pa.default))continue;if(e<=o.openTime.toNumber()||t.eq(v)){i.push(o);continue}let s=new Ta(Math.min(o.endTime.toNumber(),e)),a=s.sub(o.lastUpdateTime),m=G.mulDivFloor(a,o.emissionsPerSecondX64,t),u=o.rewardGrowthGlobalX64.add(m),f=G.mulDivFloor(a,o.emissionsPerSecondX64,Ye),l=o.rewardTotalEmissioned.add(f);i.push(oe(U({},o),{rewardGrowthGlobalX64:u,rewardTotalEmissioned:l,lastUpdateTime:s}))}return i}};import Bt from"bn.js";var Ht=class{static getfeeGrowthInside(e,t,n){let i=new Bt(0),r=new Bt(0);e.tickCurrent>=t.tick?(i=t.feeGrowthOutsideX64A,r=t.feeGrowthOutsideX64B):(i=e.feeGrowthGlobalX64A.sub(t.feeGrowthOutsideX64A),r=e.feeGrowthGlobalX64B.sub(t.feeGrowthOutsideX64B));let o=new Bt(0),s=new Bt(0);e.tickCurrent<n.tick?(o=n.feeGrowthOutsideX64A,s=n.feeGrowthOutsideX64B):(o=e.feeGrowthGlobalX64A.sub(n.feeGrowthOutsideX64A),s=e.feeGrowthGlobalX64B.sub(n.feeGrowthOutsideX64B));let a=G.wrappingSubU128(G.wrappingSubU128(e.feeGrowthGlobalX64A,i),o),m=G.wrappingSubU128(G.wrappingSubU128(e.feeGrowthGlobalX64B,r),s);return{feeGrowthInsideX64A:a,feeGrowthInsideBX64:m}}static GetPositionFees(e,t,n,i){let{feeGrowthInsideX64A:r,feeGrowthInsideBX64:o}=this.getfeeGrowthInside(e,n,i),s=G.mulDivFloor(G.wrappingSubU128(r,t.feeGrowthInsideLastX64A),t.liquidity,Ye),a=t.tokenFeesOwedA.add(s),m=G.mulDivFloor(G.wrappingSubU128(o,t.feeGrowthInsideLastX64B),t.liquidity,Ye),u=t.tokenFeesOwedB.add(m);return{tokenFeeAmountA:a,tokenFeeAmountB:u}}static GetPositionRewards(e,t,n,i){let r=[],o=this.getRewardGrowthInside(e.tickCurrent,n,i,e.rewardInfos);for(let s=0;s<o.length;s++){let a=o[s],m=t.rewardInfos[s],u=G.wrappingSubU128(a,m.growthInsideLastX64),f=G.mulDivFloor(u,t.liquidity,Ye),l=m.rewardAmountOwed.add(f);r.push(l)}return r}static getRewardGrowthInside(e,t,n,i){let r=[];for(let o=0;o<i.length;o++){let s=new Bt(0);t.liquidityGross.eqn(0)?s=i[o].rewardGrowthGlobalX64:e<t.tick?s=i[o].rewardGrowthGlobalX64.sub(t.rewardGrowthsOutsideX64[o]):s=t.rewardGrowthsOutsideX64[o];let a=new Bt(0);n.liquidityGross.eqn(0)||(e<n.tick?a=n.rewardGrowthsOutsideX64[o]:a=i[o].rewardGrowthGlobalX64.sub(n.rewardGrowthsOutsideX64[o])),r.push(G.wrappingSubU128(G.wrappingSubU128(i[o].rewardGrowthGlobalX64,s),a))}return r}};var Le=z.from("AmmV3"),tt=class extends Ie{static makeCreatePoolTransaction(a){return _(this,arguments,function*({connection:e,programId:t,owner:n,mint1:i,mint2:r,ammConfig:o,initialPrice:s}){let[m,u,f]=i.mint._bn.gt(r.mint._bn)?[r,i,new Z(1).div(s)]:[i,r,s],l=Y.priceToSqrtPriceX64(f,m.decimals,u.decimals),b=new De;b.add(...Ce());let y=yield this.makeCreatePoolInstructions({connection:e,programId:t,owner:n,mintA:m,mintB:u,ammConfigId:o.id,initialPriceX64:l});return b.add(...y.instructions),{signers:y.signers,transaction:b,mockPoolInfo:{id:y.address.poolId,mintA:{mint:m.mint,vault:y.address.mintAVault,decimals:m.decimals},mintB:{mint:u.mint,vault:y.address.mintBVault,decimals:u.decimals},ammConfig:o,observationId:y.address.observationId,creator:n,programId:t,version:6,tickSpacing:o.tickSpacing,liquidity:v,sqrtPriceX64:l,currentPrice:f,tickCurrent:0,observationIndex:0,observationUpdateDuration:0,feeGrowthGlobalX64A:v,feeGrowthGlobalX64B:v,protocolFeesTokenA:v,protocolFeesTokenB:v,swapInAmountTokenA:v,swapOutAmountTokenB:v,swapInAmountTokenB:v,swapOutAmountTokenA:v,tickArrayBitmap:[],rewardInfos:[],day:{volume:0,volumeFee:0,feeA:0,feeB:0,feeApr:0,rewardApr:{A:0,B:0,C:0},apr:0,priceMax:0,priceMin:0},week:{volume:0,volumeFee:0,feeA:0,feeB:0,feeApr:0,rewardApr:{A:0,B:0,C:0},apr:0,priceMax:0,priceMin:0},month:{volume:0,volumeFee:0,feeA:0,feeB:0,feeApr:0,rewardApr:{A:0,B:0,C:0},apr:0,priceMax:0,priceMin:0},tvl:0}}})}static makeOpenPositionTransaction(m){return _(this,arguments,function*({connection:e,poolInfo:t,ownerInfo:n,tickLower:i,tickUpper:r,liquidity:o,slippage:s,associatedOnly:a=!0}){let u=[],f=[],l=[],{amountSlippageA:b,amountSlippageB:y}=$.getAmountsFromLiquidityWithSlippage(t.sqrtPriceX64,Y.getSqrtPriceX64FromTick(i),Y.getSqrtPriceX64FromTick(r),o,!0,!0,s),d=n.useSOLBalance&&t.mintA.mint.equals(B.WSOL.mint),g=n.useSOLBalance&&t.mintB.mint.equals(B.WSOL.mint),P=yield this._selectOrCreateTokenAccount({mint:t.mintA.mint,tokenAccounts:d?[]:n.tokenAccounts,owner:n.wallet,createInfo:d?{connection:e,payer:n.feePayer,amount:b,frontInstructions:u,endInstructions:f,signers:l}:void 0,associatedOnly:d?!1:a}),T=yield this._selectOrCreateTokenAccount({mint:t.mintB.mint,tokenAccounts:g?[]:n.tokenAccounts,owner:n.wallet,createInfo:g?{connection:e,payer:n.feePayer,amount:y,frontInstructions:u,endInstructions:f,signers:l}:void 0,associatedOnly:g?!1:a});Le.assertArgument(P!==void 0&&T!==void 0,"cannot found target token accounts","tokenAccounts",n.tokenAccounts);let L=new De;L.add(...Ce());let k=this.makeOpenPositionInstructions({poolInfo:t,ownerInfo:oe(U({},n),{tokenAccountA:P,tokenAccountB:T}),tickLower:i,tickUpper:r,liquidity:o,amountSlippageA:b,amountSlippageB:y});return L.add(...u,...k.instructions,...f),{signers:[...l,...k.signers],transaction:L,address:U({},k.address)}})}static makeIncreaseLiquidityTransaction(s){return _(this,arguments,function*({connection:e,poolInfo:t,ownerPosition:n,ownerInfo:i,liquidity:r,slippage:o}){let a=[],m=[],u=[],{amountSlippageA:f,amountSlippageB:l}=$.getAmountsFromLiquidityWithSlippage(t.sqrtPriceX64,Y.getSqrtPriceX64FromTick(n.tickLower),Y.getSqrtPriceX64FromTick(n.tickUpper),r,!0,!0,o),b,y;t.mintA.mint.equals(new qe(fe.mint))&&i.useSOLBalance?b=yield this._handleTokenAccount({connection:e,side:"in",amount:f,mint:t.mintA.mint,tokenAccount:null,owner:i.wallet,payer:i.feePayer,frontInstructions:a,endInstructions:m,signers:u,bypassAssociatedCheck:!0}):b=this._selectTokenAccount({tokenAccounts:i.tokenAccounts,mint:t.mintA.mint,owner:i.wallet,config:{associatedOnly:!1}}),t.mintB.mint.equals(new qe(fe.mint))&&i.useSOLBalance?y=yield this._handleTokenAccount({connection:e,side:"in",amount:l,mint:t.mintB.mint,tokenAccount:null,owner:i.wallet,payer:i.feePayer,frontInstructions:a,endInstructions:m,signers:u,bypassAssociatedCheck:!0}):y=this._selectTokenAccount({tokenAccounts:i.tokenAccounts,mint:t.mintB.mint,owner:i.wallet,config:{associatedOnly:!1}}),Le.assertArgument(!!b||!!y,"cannot found target token accounts","tokenAccounts",i.tokenAccounts);let d=new De;d.add(...Ce());let g=this.makeIncreaseLiquidityInstructions({poolInfo:t,ownerPosition:n,ownerInfo:{wallet:i.wallet,tokenAccountA:b,tokenAccountB:y},liquidity:r,amountSlippageA:f,amountSlippageB:l});return d.add(...a,...g.instructions,...m),{signers:[...u,...g.signers],transaction:d,address:U({},g.address)}})}static makeDecreaseLiquidityTransaction(u){return _(this,arguments,function*({connection:e,poolInfo:t,ownerPosition:n,ownerInfo:i,liquidity:r,amountMinA:o,amountMinB:s,slippage:a,associatedOnly:m=!0}){let f=[],l=[],b=[],y,d;if(o!==void 0&&s!==void 0)y=o,d=s;else{let{amountSlippageA:h,amountSlippageB:O}=$.getAmountsFromLiquidityWithSlippage(t.sqrtPriceX64,Y.getSqrtPriceX64FromTick(n.tickLower),Y.getSqrtPriceX64FromTick(n.tickUpper),r,!1,!0,a!=null?a:0);y=h,d=O}let g=i.useSOLBalance&&t.mintA.mint.equals(B.WSOL.mint),P=i.useSOLBalance&&t.mintB.mint.equals(B.WSOL.mint),T=yield this._selectOrCreateTokenAccount({mint:t.mintA.mint,tokenAccounts:g?[]:i.tokenAccounts,owner:i.wallet,createInfo:{connection:e,payer:i.feePayer,amount:0,frontInstructions:f,signers:b},associatedOnly:g?!1:m}),L=yield this._selectOrCreateTokenAccount({mint:t.mintB.mint,tokenAccounts:P?[]:i.tokenAccounts,owner:i.wallet,createInfo:{connection:e,payer:i.feePayer,amount:0,frontInstructions:f,signers:b},associatedOnly:P?!1:m}),k=[];for(let h of t.rewardInfos){let O=i.useSOLBalance&&h.tokenMint.equals(B.WSOL.mint),M=yield this._selectOrCreateTokenAccount({mint:h.tokenMint,tokenAccounts:O?[]:i.tokenAccounts,owner:i.wallet,createInfo:{connection:e,payer:i.feePayer,amount:0,frontInstructions:f,endInstructions:O?l:[],signers:b},associatedOnly:O?!1:m});k.push(M)}Le.assertArgument(!!T||!!L,"cannot found target token accounts","tokenAccounts",i.tokenAccounts);let I=new De;I.add(...Ce());let D=this.makeDecreaseLiquidityInstructions({poolInfo:t,ownerPosition:n,ownerInfo:{wallet:i.wallet,tokenAccountA:T,tokenAccountB:L,rewardAccounts:k},liquidity:r,amountMinA:y,amountMinB:d});return I.add(...f,...D.instructions,...l),i.closePosition&&I.add(...this.makeClosePositionInstructions({poolInfo:t,ownerInfo:i,ownerPosition:n}).instructions),{signers:[...b,...D.signers],transaction:I,address:U({},D.address)}})}static makeSwapBaseInTransaction(m){return _(this,arguments,function*({connection:e,poolInfo:t,ownerInfo:n,inputMint:i,amountIn:r,amountOutMin:o,priceLimit:s,remainingAccounts:a}){let u=[],f=[],l=[],b;!s||s.equals(new Z(0))?b=i.equals(t.mintA.mint)?ve.add(ie):Ke.sub(ie):b=Y.priceToSqrtPriceX64(s,t.mintA.decimals,t.mintB.decimals);let y=t.mintA.mint.equals(i),d,g;t.mintA.mint.equals(new qe(fe.mint))&&n.useSOLBalance?d=yield this._handleTokenAccount({connection:e,side:"in",amount:y?r:0,mint:t.mintA.mint,tokenAccount:null,owner:n.wallet,payer:n.feePayer,frontInstructions:u,endInstructions:f,signers:l,bypassAssociatedCheck:!0}):d=this._selectTokenAccount({tokenAccounts:n.tokenAccounts,mint:t.mintA.mint,owner:n.wallet,config:{associatedOnly:!1}}),t.mintB.mint.equals(new qe(fe.mint))&&n.useSOLBalance?g=yield this._handleTokenAccount({connection:e,side:"in",amount:y?0:r,mint:t.mintB.mint,tokenAccount:null,owner:n.wallet,payer:n.feePayer,frontInstructions:u,endInstructions:f,signers:l,bypassAssociatedCheck:!0}):g=this._selectTokenAccount({tokenAccounts:n.tokenAccounts,mint:t.mintB.mint,owner:n.wallet,config:{associatedOnly:!1}}),Le.assertArgument(!!d||!!g,"cannot found target token accounts","tokenAccounts",n.tokenAccounts);let P=new De;P.add(...Ce());let T=this.makeSwapBaseInInstructions({poolInfo:t,ownerInfo:{wallet:n.wallet,tokenAccountA:d,tokenAccountB:g},inputMint:i,amountIn:r,amountOutMin:o,sqrtPriceLimitX64:b,remainingAccounts:a});return P.add(...u,...T.instructions,...f),{signers:[...l,...T.signers],transaction:P,address:U({},T.address)}})}static makeSwapBaseOutTransaction(m){return _(this,arguments,function*({connection:e,poolInfo:t,ownerInfo:n,outputMint:i,amountOut:r,amountInMax:o,priceLimit:s,remainingAccounts:a}){let u=[],f=[],l=[],b;!s||s.equals(new Z(0))?b=i.equals(t.mintB.mint)?ve.add(ie):Ke.sub(ie):b=Y.priceToSqrtPriceX64(s,t.mintA.decimals,t.mintB.decimals);let y=t.mintA.mint.equals(i),d,g;t.mintA.mint.equals(new qe(fe.mint))&&n.useSOLBalance?d=yield this._handleTokenAccount({connection:e,side:"in",amount:y?o:0,mint:t.mintA.mint,tokenAccount:null,owner:n.wallet,payer:n.feePayer,frontInstructions:u,endInstructions:f,signers:l,bypassAssociatedCheck:!0}):d=this._selectTokenAccount({tokenAccounts:n.tokenAccounts,mint:t.mintA.mint,owner:n.wallet,config:{associatedOnly:!1}}),t.mintB.mint.equals(new qe(fe.mint))&&n.useSOLBalance?g=yield this._handleTokenAccount({connection:e,side:"in",amount:y?0:o,mint:t.mintB.mint,tokenAccount:null,owner:n.wallet,payer:n.feePayer,frontInstructions:u,endInstructions:f,signers:l,bypassAssociatedCheck:!0}):g=this._selectTokenAccount({tokenAccounts:n.tokenAccounts,mint:t.mintB.mint,owner:n.wallet,config:{associatedOnly:!1}}),Le.assertArgument(!!d||!!g,"cannot found target token accounts","tokenAccounts",n.tokenAccounts);let P=new De;P.add(...Ce());let T=this.makeSwapBaseOutInstructions({poolInfo:t,ownerInfo:{wallet:n.wallet,tokenAccountA:d,tokenAccountB:g},outputMint:i,amountOut:r,amountInMax:o,sqrtPriceLimitX64:b,remainingAccounts:a});return P.add(...u,...T.instructions,...f),{signers:[...l,...T.signers],transaction:P,address:U({},T.address)}})}static makeCLosePositionTransaction({poolInfo:e,ownerPosition:t,ownerInfo:n}){let i=this.makeClosePositionInstructions({poolInfo:e,ownerInfo:n,ownerPosition:t}),r=new De;return r.add(...i.instructions),{signers:i.signers,transaction:r,address:U({},i.address)}}static makeInitRewardTransaction(o){return _(this,arguments,function*({connection:e,poolInfo:t,ownerInfo:n,rewardInfo:i,associatedOnly:r=!0}){Le.assertArgument(i.endTime>i.openTime,"reward time error","rewardInfo",i);let s=[],a=[],m=[],u=n.useSOLBalance&&i.mint.equals(B.WSOL.mint),f=yield this._selectOrCreateTokenAccount({mint:i.mint,tokenAccounts:u?[]:n.tokenAccounts,owner:n.wallet,createInfo:u?{connection:e,payer:n.feePayer,amount:new be(new Z(i.perSecond.sub(i.endTime-i.openTime).toFixed(0)).gte(i.perSecond.sub(i.endTime-i.openTime))?i.perSecond.sub(i.endTime-i.openTime).toFixed(0):i.perSecond.sub(i.endTime-i.openTime).add(1).toFixed(0)),frontInstructions:s,endInstructions:a,signers:m}:void 0,associatedOnly:u?!1:r});Le.assertArgument(f,"no money","ownerRewardAccount",n.tokenAccounts);let l=new De;l.add(...Ce());let b=this.makeInitRewardInstructions({poolInfo:t,ownerInfo:{wallet:n.wallet,tokenAccount:f},rewardInfo:{mint:i.mint,openTime:i.openTime,endTime:i.endTime,emissionsPerSecondX64:G.decimalToX64(i.perSecond)}});return l.add(...s,...b.instructions,...a),{signers:[...m,...b.signers],transaction:l,address:U({},b.address)}})}static makeInitRewardsTransaction(o){return _(this,arguments,function*({connection:e,poolInfo:t,ownerInfo:n,rewardInfos:i,associatedOnly:r=!0}){for(let l of i)Le.assertArgument(l.endTime>l.openTime,"reward time error","rewardInfo",l);let s=new De;s.add(...Ce());let a=[],m=[],u=[],f=[];for(let l of i){let b=n.useSOLBalance&&l.mint.equals(B.WSOL.mint),y=yield this._selectOrCreateTokenAccount({mint:l.mint,tokenAccounts:b?[]:n.tokenAccounts,owner:n.wallet,createInfo:b?{connection:e,payer:n.feePayer,amount:new be(new Z(l.perSecond.sub(l.endTime-l.openTime).toFixed(0)).gte(l.perSecond.sub(l.endTime-l.openTime))?l.perSecond.sub(l.endTime-l.openTime).toFixed(0):l.perSecond.sub(l.endTime-l.openTime).add(1).toFixed(0)),frontInstructions:a,endInstructions:m,signers:f}:void 0,associatedOnly:b?!1:r});Le.assertArgument(y,"no money","ownerRewardAccount",n.tokenAccounts);let d=this.makeInitRewardInstructions({poolInfo:t,ownerInfo:{wallet:n.wallet,tokenAccount:y},rewardInfo:{mint:l.mint,openTime:l.openTime,endTime:l.endTime,emissionsPerSecondX64:G.decimalToX64(l.perSecond)}});u.push(...d.instructions)}return s.add(...a,...u,...m),{signers:[...f],transaction:s,address:{}}})}static makeSetRewardTransaction(o){return _(this,arguments,function*({connection:e,poolInfo:t,ownerInfo:n,rewardInfo:i,associatedOnly:r=!0}){Le.assertArgument(i.endTime>i.openTime,"reward time error","rewardInfo",i);let s=[],a=[],m=[],u=n.useSOLBalance&&i.mint.equals(B.WSOL.mint),f=yield this._selectOrCreateTokenAccount({mint:i.mint,tokenAccounts:u?[]:n.tokenAccounts,owner:n.wallet,createInfo:u?{connection:e,payer:n.feePayer,amount:new be(new Z(i.perSecond.sub(i.endTime-i.openTime).toFixed(0)).gte(i.perSecond.sub(i.endTime-i.openTime))?i.perSecond.sub(i.endTime-i.openTime).toFixed(0):i.perSecond.sub(i.endTime-i.openTime).add(1).toFixed(0)),frontInstructions:s,endInstructions:a,signers:m}:void 0,associatedOnly:u?!1:r});Le.assertArgument(f,"no money","ownerRewardAccount",n.tokenAccounts);let l=new De;l.add(...Ce());let b=this.makeSetRewardInstructions({poolInfo:t,ownerInfo:{wallet:n.wallet,tokenAccount:f},rewardInfo:{mint:i.mint,openTime:i.openTime,endTime:i.endTime,emissionsPerSecondX64:G.decimalToX64(i.perSecond)}});return l.add(...s,...b.instructions,...a),{signers:[...m,...b.signers],transaction:l,address:U({},b.address)}})}static makeSetRewardsTransaction(o){return _(this,arguments,function*({connection:e,poolInfo:t,ownerInfo:n,rewardInfos:i,associatedOnly:r=!0}){let s=[],a=[],m=[],u=[],f=new De;f.add(...Ce());for(let l of i){Le.assertArgument(l.endTime>l.openTime,"reward time error","rewardInfo",l);let b=n.useSOLBalance&&l.mint.equals(B.WSOL.mint),y=yield this._selectOrCreateTokenAccount({mint:l.mint,tokenAccounts:b?[]:n.tokenAccounts,owner:n.wallet,createInfo:b?{connection:e,payer:n.feePayer,amount:new be(new Z(l.perSecond.sub(l.endTime-l.openTime).toFixed(0)).gte(l.perSecond.sub(l.endTime-l.openTime))?l.perSecond.sub(l.endTime-l.openTime).toFixed(0):l.perSecond.sub(l.endTime-l.openTime).add(1).toFixed(0)),frontInstructions:s,endInstructions:a,signers:u}:void 0,associatedOnly:b?!1:r});Le.assertArgument(y,"no money","ownerRewardAccount",n.tokenAccounts);let d=this.makeSetRewardInstructions({poolInfo:t,ownerInfo:{wallet:n.wallet,tokenAccount:y},rewardInfo:{mint:l.mint,openTime:l.openTime,endTime:l.endTime,emissionsPerSecondX64:G.decimalToX64(l.perSecond)}});m.push(...d.instructions)}return f.add(...s,...m,...a),{signers:[...u],transaction:f,address:{}}})}static makeCollectRewardTransaction(o){return _(this,arguments,function*({connection:e,poolInfo:t,ownerInfo:n,rewardMint:i,associatedOnly:r=!0}){let s=[],a=[],m=[],u=n.useSOLBalance&&i.equals(B.WSOL.mint),f=yield this._selectOrCreateTokenAccount({mint:i,tokenAccounts:u?[]:n.tokenAccounts,owner:n.wallet,createInfo:{connection:e,payer:n.feePayer,amount:0,frontInstructions:s,endInstructions:u?a:[],signers:m},associatedOnly:u?!1:r});Le.assertArgument(f,"no money","ownerRewardAccount",n.tokenAccounts);let l=new De;l.add(...Ce());let b=this.makeCollectRewardInstructions({poolInfo:t,ownerInfo:{wallet:n.wallet,tokenAccount:f},rewardMint:i});return l.add(...s,...b.instructions,...a),{signers:[...m,...b.signers],transaction:l,address:U({},b.address)}})}static makeCollectRewardsTransaction(o){return _(this,arguments,function*({connection:e,poolInfo:t,ownerInfo:n,rewardMints:i,associatedOnly:r=!0}){let s=[],a=[],m=[],u=new De;u.add(...Ce());let f=[];for(let l of i){let b=n.useSOLBalance&&l.equals(B.WSOL.mint),y=yield this._selectOrCreateTokenAccount({mint:l,tokenAccounts:b?[]:n.tokenAccounts,owner:n.wallet,createInfo:{connection:e,payer:n.feePayer,amount:0,frontInstructions:s,endInstructions:b?a:[],signers:f},associatedOnly:b?!1:r});Le.assertArgument(y,"no money","ownerRewardAccount",n.tokenAccounts);let d=this.makeCollectRewardInstructions({poolInfo:t,ownerInfo:{wallet:n.wallet,tokenAccount:y},rewardMint:l});m.push(...d.instructions)}return u.add(...s,...m,...a),{signers:[...f],transaction:u,address:{}}})}static makeHarvestAllRewardTransaction(r){return _(this,arguments,function*({connection:e,fetchPoolInfos:t,ownerInfo:n,associatedOnly:i=!0}){var b,y,d;let o={};for(let g of n.tokenAccounts)i?Ue(n.wallet,g.accountInfo.mint).publicKey.equals(g.pubkey)&&(o[g.accountInfo.mint.toString()]=g.pubkey):o[g.accountInfo.mint.toString()]=g.pubkey;let s=[],a=[],m=[],u=[];for(let g of Object.values(t)){if(g.positionAccount===void 0||!g.positionAccount.find(h=>!h.tokenFeeAmountA.isZero()||!h.tokenFeeAmountB.isZero()||h.rewardInfos.find(O=>!O.pendingReward.isZero())))continue;let P=g.state,T=n.useSOLBalance&&P.mintA.mint.equals(B.WSOL.mint),L=n.useSOLBalance&&P.mintB.mint.equals(B.WSOL.mint),k=(b=o[P.mintA.mint.toString()])!=null?b:yield this._selectOrCreateTokenAccount({mint:P.mintA.mint,tokenAccounts:T?[]:n.tokenAccounts,owner:n.wallet,createInfo:{connection:e,payer:n.feePayer,amount:0,frontInstructions:s,signers:u},associatedOnly:T?!1:i}),I=(y=o[P.mintB.mint.toString()])!=null?y:yield this._selectOrCreateTokenAccount({mint:P.mintB.mint,tokenAccounts:L?[]:n.tokenAccounts,owner:n.wallet,createInfo:{connection:e,payer:n.feePayer,amount:0,frontInstructions:s,signers:u},associatedOnly:L?!1:i});o[P.mintA.mint.toString()]=k,o[P.mintB.mint.toString()]=I;let D=[];for(let h of P.rewardInfos){let O=n.useSOLBalance&&h.tokenMint.equals(B.WSOL.mint),M=(d=o[h.tokenMint.toString()])!=null?d:yield this._selectOrCreateTokenAccount({mint:h.tokenMint,tokenAccounts:O?[]:n.tokenAccounts,owner:n.wallet,createInfo:{connection:e,payer:n.feePayer,amount:0,frontInstructions:s,endInstructions:O?a:[],signers:u},associatedOnly:O?!1:i});o[h.tokenMint.toString()]=M,D.push(M)}for(let h of g.positionAccount)m.push(...this.makeDecreaseLiquidityInstructions({poolInfo:P,ownerPosition:h,ownerInfo:{wallet:n.wallet,tokenAccountA:k,tokenAccountB:I,rewardAccounts:D},liquidity:v,amountMinA:v,amountMinB:v}).instructions)}let f=[...s,...m,...a];return{transactions:gt({instructions:f,signers:u,payer:n.wallet}),address:{}}})}static makeCreatePoolInstructions(a){return _(this,arguments,function*({connection:e,programId:t,owner:n,mintA:i,mintB:r,ammConfigId:o,initialPriceX64:s}){let m=new Eo,u=[ka.createAccount({fromPubkey:n,newAccountPubkey:m.publicKey,lamports:yield e.getMinimumBalanceForRentExemption(Yn.span),space:Yn.span,programId:t})],f=xi(t,o,i.mint,r.mint).publicKey,l=Mn(t,f,i.mint).publicKey,b=Mn(t,f,r.mint).publicKey;return u.push(Po(t,f,n,o,m.publicKey,i.mint,l,r.mint,b,s)),{signers:[m],instructions:u,address:{poolId:f,observationId:m.publicKey,mintAVault:l,mintBVault:b}}})}static makeOpenPositionInstructions({poolInfo:e,ownerInfo:t,tickLower:n,tickUpper:i,liquidity:r,amountSlippageA:o,amountSlippageB:s}){let a=[],m=new Eo;a.push(m);let u=j.getTickArrayStartIndexByTick(n,e.ammConfig.tickSpacing),f=j.getTickArrayStartIndexByTick(i,e.ammConfig.tickSpacing),{publicKey:l}=Se(e.programId,e.id,u),{publicKey:b}=Se(e.programId,e.id,f),{publicKey:y}=Ue(t.wallet,m.publicKey),{publicKey:d}=Ci(m.publicKey),{publicKey:g}=kt(e.programId,m.publicKey),{publicKey:P}=pn(e.programId,e.id,n,i),T=To(e.programId,t.feePayer,e.id,t.wallet,m.publicKey,y,d,P,l,b,g,t.tokenAccountA,t.tokenAccountB,e.mintA.vault,e.mintB.vault,n,i,u,f,r,o,s);return{signers:[m],instructions:[T],address:{}}}static makeIncreaseLiquidityInstructions({poolInfo:e,ownerPosition:t,ownerInfo:n,liquidity:i,amountSlippageA:r,amountSlippageB:o}){let s=j.getTickArrayStartIndexByTick(t.tickLower,e.ammConfig.tickSpacing),a=j.getTickArrayStartIndexByTick(t.tickUpper,e.ammConfig.tickSpacing),{publicKey:m}=Se(e.programId,e.id,s),{publicKey:u}=Se(e.programId,e.id,a),{publicKey:f}=Ue(n.wallet,t.nftMint),{publicKey:l}=kt(e.programId,t.nftMint),{publicKey:b}=pn(e.programId,e.id,t.tickLower,t.tickUpper),y=[];return y.push(wo(e.programId,n.wallet,f,l,e.id,b,m,u,n.tokenAccountA,n.tokenAccountB,e.mintA.vault,e.mintB.vault,i,r,o)),{signers:[],instructions:y,address:{}}}static makeDecreaseLiquidityInstructions({poolInfo:e,ownerPosition:t,ownerInfo:n,liquidity:i,amountMinA:r,amountMinB:o}){let s=j.getTickArrayStartIndexByTick(t.tickLower,e.ammConfig.tickSpacing),a=j.getTickArrayStartIndexByTick(t.tickUpper,e.ammConfig.tickSpacing),{publicKey:m}=Se(e.programId,e.id,s),{publicKey:u}=Se(e.programId,e.id,a),{publicKey:f}=Ue(n.wallet,t.nftMint),{publicKey:l}=kt(e.programId,t.nftMint),{publicKey:b}=pn(e.programId,e.id,t.tickLower,t.tickUpper),y=[];for(let g=0;g<e.rewardInfos.length;g++)y.push({poolRewardVault:e.rewardInfos[g].tokenVault,ownerRewardVault:n.rewardAccounts[g]});let d=[];return d.push(Lo(e.programId,n.wallet,f,l,e.id,b,m,u,n.tokenAccountA,n.tokenAccountB,e.mintA.vault,e.mintB.vault,y,i,r,o)),{signers:[],instructions:d,address:{}}}static makeClosePositionInstructions({poolInfo:e,ownerInfo:t,ownerPosition:n}){let{publicKey:i}=Ue(t.wallet,n.nftMint),{publicKey:r}=kt(e.programId,n.nftMint),o=[];return o.push(ko(e.programId,t.wallet,n.nftMint,i,r)),{signers:[],instructions:o,address:{}}}static makeSwapBaseInInstructions({poolInfo:e,ownerInfo:t,inputMint:n,amountIn:i,amountOutMin:r,sqrtPriceLimitX64:o,remainingAccounts:s}){let a=e.mintA.mint.equals(n),m=[Xn(e.programId,t.wallet,e.id,e.ammConfig.id,a?t.tokenAccountA:t.tokenAccountB,a?t.tokenAccountB:t.tokenAccountA,a?e.mintA.vault:e.mintB.vault,a?e.mintB.vault:e.mintA.vault,s,e.observationId,i,r,o,!0)];return{signers:[],instructions:m,address:{}}}static makeSwapBaseOutInstructions({poolInfo:e,ownerInfo:t,outputMint:n,amountOut:i,amountInMax:r,sqrtPriceLimitX64:o,remainingAccounts:s}){let a=e.mintA.mint.equals(n),m=[Xn(e.programId,t.wallet,e.id,e.ammConfig.id,a?t.tokenAccountB:t.tokenAccountA,a?t.tokenAccountA:t.tokenAccountB,a?e.mintB.vault:e.mintA.vault,a?e.mintA.vault:e.mintB.vault,s,e.observationId,i,r,o,!1)];return{signers:[],instructions:m,address:{}}}static makeInitRewardInstructions({poolInfo:e,ownerInfo:t,rewardInfo:n}){let i=Bi(e.programId,e.id,n.mint).publicKey,r=fn(e.programId).publicKey,o=[Io(e.programId,t.wallet,e.id,r,e.ammConfig.id,t.tokenAccount,n.mint,i,n.openTime,n.endTime,n.emissionsPerSecondX64)];return{signers:[],instructions:o,address:{}}}static makeSetRewardInstructions({poolInfo:e,ownerInfo:t,rewardInfo:n}){let i,r;for(let a=0;a<e.rewardInfos.length;a++)e.rewardInfos[a].tokenMint.equals(n.mint)&&(i=a,r=e.rewardInfos[a].tokenVault);Le.assertArgument(i!==void 0&&r!==void 0,"reward mint check error","no reward mint",e.rewardInfos);let o=fn(e.programId).publicKey,s=[ho(e.programId,t.wallet,e.id,o,e.ammConfig.id,t.tokenAccount,r,i,n.openTime,n.endTime,n.emissionsPerSecondX64)];return{signers:[],instructions:s,address:{}}}static makeCollectRewardInstructions({poolInfo:e,ownerInfo:t,rewardMint:n}){let i,r;for(let s=0;s<e.rewardInfos.length;s++)e.rewardInfos[s].tokenMint.equals(n)&&(i=s,r=e.rewardInfos[s].tokenVault);Le.assertArgument(i!==void 0&&r!==void 0,"reward mint check error","no reward mint",e.rewardInfos);let o=[Ro(e.programId,t.wallet,e.id,t.tokenAccount,r,i)];return{signers:[],instructions:o,address:{}}}static getLiquidityAmountOutFromAmountIn({poolInfo:e,inputA:t,tickLower:n,tickUpper:i,amount:r,slippage:o,add:s}){let a=e.sqrtPriceX64,m=Y.getSqrtPriceX64FromTick(n),u=Y.getSqrtPriceX64FromTick(i),f=s?1-o:1+o,l=r.mul(new be(Math.floor(f*1e6))).div(new be(1e6)),b;if(a.lte(m))b=t?$.getLiquidityFromTokenAmountA(m,u,l,!s):new be(0);else if(a.lte(u)){let g=$.getLiquidityFromTokenAmountA(a,u,l,!s),P=$.getLiquidityFromTokenAmountB(m,a,l);b=t?g:P}else b=t?new be(0):$.getLiquidityFromTokenAmountB(m,u,l);let y=$.getAmountsFromLiquidityWithSlippage(e.sqrtPriceX64,m,u,b,s,!s,o),d=$.getAmountsFromLiquidity(e.sqrtPriceX64,m,u,b,!s);return U(U({liquidity:b},y),d)}static getAmountsFromLiquidity({poolInfo:e,ownerPosition:t,liquidity:n,slippage:i,add:r}){let o=Y.getSqrtPriceX64FromTick(t.tickLower),s=Y.getSqrtPriceX64FromTick(t.tickUpper);return $.getAmountsFromLiquidityWithSlippage(e.sqrtPriceX64,o,s,n,r,r,i)}static getPriceAndTick({poolInfo:e,price:t,baseIn:n}){let i=n?t:new Z(1).div(t),r=Rt.getTickWithPriceAndTickspacing(i,e.ammConfig.tickSpacing,e.mintA.decimals,e.mintB.decimals),o=Y.getSqrtPriceX64FromTick(r),s=Y.sqrtPriceX64ToPrice(o,e.mintA.decimals,e.mintB.decimals);return n?{tick:r,price:s}:{tick:r,price:new Z(1).div(s)}}static getTickPrice({poolInfo:e,tick:t,baseIn:n}){let i=Y.getSqrtPriceX64FromTick(t),r=Y.sqrtPriceX64ToPrice(i,e.mintA.decimals,e.mintB.decimals);return n?{tick:t,price:r,tickSqrtPriceX64:i}:{tick:t,price:new Z(1).div(r),tickSqrtPriceX64:i}}static computeAmountOutFormat({poolInfo:e,tickArrayCache:t,amountIn:n,currencyOut:i,slippage:r}){let o=n instanceof q,s=(o?n.token:B.WSOL).mint,a=n.raw,m=r.numerator.toNumber()/r.denominator.toNumber(),{amountOut:u,minAmountOut:f,currentPrice:l,executionPrice:b,priceImpact:y,fee:d,remainingAccounts:g}=tt.computeAmountOut({poolInfo:e,tickArrayCache:t,baseMint:s,amountIn:a,slippage:m}),P=i instanceof B?new q(i,u):new me(i,u),T=i instanceof B?new q(i,f):new me(i,f),L=new le(o?n.token:n.currency,new be(10).pow(new be(20+(o?n.token:n.currency).decimals)),i instanceof B?i:B.WSOL,l.mul(new Z(Fe(10,20+(i instanceof B?i:B.WSOL).decimals))).toFixed(0)),k=new le(o?n.token:n.currency,new be(10).pow(new be(20+(o?n.token:n.currency).decimals)),i instanceof B?i:B.WSOL,b.mul(new Z(Fe(10,20+(i instanceof B?i:B.WSOL).decimals))).toFixed(0)),I=o?new q(n.token,d):new me(n.currency,d);return{amountOut:P,minAmountOut:T,currentPrice:L,executionPrice:k,priceImpact:y,fee:I,remainingAccounts:g}}static computeAmountOut({poolInfo:e,tickArrayCache:t,baseMint:n,amountIn:i,slippage:r,priceLimit:o=new Z(0)}){let s;o.equals(new Z(0))?s=n.equals(e.mintA.mint)?ve.add(ie):Ke.sub(ie):s=Y.priceToSqrtPriceX64(o,e.mintA.decimals,e.mintB.decimals);let{expectedAmountOut:a,remainingAccounts:m,executionPrice:u,feeAmount:f}=xt.getOutputAmountAndRemainAccounts(e,t,n,i,s),l=Y.sqrtPriceX64ToPrice(u,e.mintA.decimals,e.mintB.decimals),b=n.equals(e.mintA.mint)?l:new Z(1).div(l),y=a.mul(new be(Math.floor((1-r)*1e10))).div(new be(1e10)),d=e.mintA.mint.equals(n)?e.currentPrice:new Z(1).div(e.currentPrice),g=new Z(b).sub(d).abs(),P=d,T=new Ae(new Z(g).mul(Fe(10,15)).toFixed(0),new Z(P).mul(Fe(10,15)).toFixed(0));return{amountOut:a,minAmountOut:y,currentPrice:e.currentPrice,executionPrice:b,priceImpact:T,fee:f,remainingAccounts:m}}static computeAmountIn({poolInfo:e,tickArrayCache:t,baseMint:n,amountOut:i,slippage:r,priceLimit:o=new Z(0)}){let s;o.equals(new Z(0))?s=n.equals(e.mintB.mint)?ve.add(ie):Ke.sub(ie):s=Y.priceToSqrtPriceX64(o,e.mintA.decimals,e.mintB.decimals);let{expectedAmountIn:a,remainingAccounts:m,executionPrice:u,feeAmount:f}=xt.getInputAmountAndRemainAccounts(e,t,n,i,s),l=Y.sqrtPriceX64ToPrice(u,e.mintA.decimals,e.mintB.decimals),b=n.equals(e.mintA.mint)?l:new Z(1).div(l),y=a.mul(new be(Math.floor((1+r)*1e10))).div(new be(1e10)),d=e.mintA.mint.equals(n)?e.currentPrice:new Z(1).div(e.currentPrice),g=new Z(b).sub(d).abs(),P=d,T=new Ae(new Z(g).mul(Fe(10,15)).toFixed(0),new Z(P).mul(Fe(10,15)).toFixed(0));return{amountIn:a,maxAmountIn:y,currentPrice:e.currentPrice,executionPrice:b,priceImpact:T,fee:f,remainingAccounts:m}}static estimateAprsForPriceRangeMultiplier({poolInfo:e,aprType:t,positionTickLowerIndex:n,positionTickUpperIndex:i}){let r=e[t],o=this.getTickPrice({poolInfo:e,tick:n,baseIn:!0}).price.toNumber(),s=this.getTickPrice({poolInfo:e,tick:i,baseIn:!0}).price.toNumber(),a=Math.max(o,r.priceMin),u=Math.min(s,r.priceMax)-a,f=s-o,l=r.priceMax-r.priceMin,b;return u<=0?b=0:f===u?b=l/u:l===u?b=u/f:b=u/l*(u/f),{feeApr:r.feeApr*b,rewardsApr:[r.rewardApr.A*b,r.rewardApr.B*b,r.rewardApr.C*b],apr:r.apr*b}}static estimateAprsForPriceRangeDelta({poolInfo:e,aprType:t,mintPrice:n,rewardMintDecimals:i,liquidity:r,positionTickLowerIndex:o,positionTickUpperIndex:s,chainTime:a}){let m=t==="day"?1:t==="week"?7:t==="month"?30:0,u=e[t],f=n[e.mintA.mint.toString()],l=n[e.mintB.mint.toString()],b=e.mintA.decimals,y=e.mintB.decimals;if(!u||!f||!l)return{feeApr:0,rewardsApr:[0,0,0],apr:0};let d=Y.getSqrtPriceX64FromTick(o),g=Y.getSqrtPriceX64FromTick(s),{amountSlippageA:P,amountSlippageB:T}=$.getAmountsFromLiquidityWithSlippage(e.sqrtPriceX64,d,g,e.liquidity,!1,!1,0),{amountSlippageA:L,amountSlippageB:k}=$.getAmountsFromLiquidityWithSlippage(e.sqrtPriceX64,d,g,r,!1,!1,0),I=new Z(P.toString()).div(new Z(10).pow(b)).mul(f.toFixed(b)).add(new Z(T.toString()).div(new Z(10).pow(y)).mul(l.toFixed(y))),D=new Z(L.toString()).div(new Z(10).pow(b)).mul(f.toFixed(b)).add(new Z(k.toString()).div(new Z(10).pow(y)).mul(l.toFixed(y))),h=D.div(I.add(D)).div(D),M=new Z(u.volumeFee).mul(365).div(m).mul(h).mul(100).toNumber(),H=3600*24*365,te=e.rewardInfos.map(Q=>{let se=i[Q.tokenMint.toString()],ae=n[Q.tokenMint.toString()];return a<Q.openTime.toNumber()||a>Q.endTime.toNumber()||Q.perSecond.equals(0)||!ae||se===void 0?0:new Z(ae.toFixed(se)).mul(Q.perSecond.mul(H)).div(new Z(10).pow(se)).mul(h).mul(100).toNumber()});return{feeApr:M,rewardsApr:te,apr:M+te.reduce((Q,se)=>Q+se,0)}}static fetchMultiplePoolInfos(o){return _(this,arguments,function*({connection:e,poolKeys:t,ownerInfo:n,chainTime:i,batchRequest:r=!1}){var f;let s=yield Ee(e,t.map(l=>new qe(l.id)),{batchRequest:r}),a=[],m={},u=[];for(let l=0;l<t.length;l++){let b=t[l],y=s[l];if(y===null)continue;let d=bo.decode(y.data);m[b.id]={state:{id:new qe(b.id),mintA:{mint:d.mintA,vault:d.vaultA,decimals:d.mintDecimalsA},mintB:{mint:d.mintB,vault:d.vaultB,decimals:d.mintDecimalsB},observationId:d.observationId,ammConfig:oe(U({},b.ammConfig),{id:new qe(b.ammConfig.id)}),creator:d.creator,programId:y.owner,version:6,tickSpacing:d.tickSpacing,liquidity:d.liquidity,sqrtPriceX64:d.sqrtPriceX64,currentPrice:Y.sqrtPriceX64ToPrice(d.sqrtPriceX64,d.mintDecimalsA,d.mintDecimalsB),tickCurrent:d.tickCurrent,observationIndex:d.observationIndex,observationUpdateDuration:d.observationUpdateDuration,feeGrowthGlobalX64A:d.feeGrowthGlobalX64A,feeGrowthGlobalX64B:d.feeGrowthGlobalX64B,protocolFeesTokenA:d.protocolFeesTokenA,protocolFeesTokenB:d.protocolFeesTokenB,swapInAmountTokenA:d.swapInAmountTokenA,swapOutAmountTokenB:d.swapOutAmountTokenB,swapInAmountTokenB:d.swapInAmountTokenB,swapOutAmountTokenA:d.swapOutAmountTokenA,tickArrayBitmap:d.tickArrayBitmap,rewardInfos:xt.updatePoolRewardInfos({chainTime:i,poolLiquidity:d.liquidity,rewardInfos:d.rewardInfos.filter(g=>!g.tokenMint.equals(qe.default))}),day:b.day,week:b.week,month:b.month,tvl:b.tvl}},n&&u.push(...m[b.id].state.rewardInfos.filter(g=>g.creator.equals(n.wallet))),a.find(g=>g.equals(y.owner))||a.push(y.owner)}if(n){let l=n.tokenAccounts.filter(L=>L.accountInfo.amount.eq(new be(1))).map(L=>L.accountInfo.mint),b=[];for(let L of l)for(let k of a)b.push(kt(k,L).publicKey);let y=yield Ee(e,b,{batchRequest:r}),d={};for(let L of y){if(L===null)continue;let k=Ao.decode(L.data),I=k.poolId.toString(),D=m[I];if(D===void 0)continue;let h=D.state,O=this.getTickPrice({poolInfo:h,tick:k.tickLower,baseIn:!0}),M=this.getTickPrice({poolInfo:h,tick:k.tickUpper,baseIn:!0}),{amountA:H,amountB:te}=$.getAmountsFromLiquidity(h.sqrtPriceX64,O.tickSqrtPriceX64,M.tickSqrtPriceX64,k.liquidity,!1),Q=1/(1-Math.sqrt(Math.sqrt(O.price.div(M.price).toNumber())));m[I].positionAccount=[...(f=m[I].positionAccount)!=null?f:[],{poolId:k.poolId,nftMint:k.nftMint,priceLower:O.price,priceUpper:M.price,amountA:H,amountB:te,tickLower:k.tickLower,tickUpper:k.tickUpper,liquidity:k.liquidity,feeGrowthInsideLastX64A:k.feeGrowthInsideLastX64A,feeGrowthInsideLastX64B:k.feeGrowthInsideLastX64B,tokenFeesOwedA:k.tokenFeesOwedA,tokenFeesOwedB:k.tokenFeesOwedB,rewardInfos:k.rewardInfos.map(ue=>oe(U({},ue),{pendingReward:new be(0)})),leverage:Q,tokenFeeAmountA:new be(0),tokenFeeAmountB:new be(0)}];let se=j.getTickArrayAddressByTick(m[I].state.programId,k.poolId,k.tickLower,m[I].state.tickSpacing),ae=j.getTickArrayAddressByTick(m[I].state.programId,k.poolId,k.tickUpper,m[I].state.tickSpacing);d[`${m[I].state.programId.toString()}-${k.poolId.toString()}-${k.tickLower}`]=se,d[`${m[I].state.programId.toString()}-${k.poolId.toString()}-${k.tickUpper}`]=ae}let g=Object.values(d),P=yield Ee(e,g,{batchRequest:r}),T={};for(let L=0;L<g.length;L++){let k=P[L];if(k===null)continue;let I=g[L].toString();T[I]=Wt.decode(k.data)}for(let{state:L,positionAccount:k}of Object.values(m))if(!!k)for(let I of k){let D=`${L.programId.toString()}-${L.id.toString()}-${I.tickLower}`,h=`${L.programId.toString()}-${L.id.toString()}-${I.tickUpper}`,O=T[d[D].toString()],M=T[d[h].toString()],H=O.ticks[j.getTickOffsetInArray(I.tickLower,L.tickSpacing)],te=M.ticks[j.getTickOffsetInArray(I.tickUpper,L.tickSpacing)],{tokenFeeAmountA:Q,tokenFeeAmountB:se}=Ht.GetPositionFees(L,I,H,te),ae=Ht.GetPositionRewards(L,I,H,te);I.tokenFeeAmountA=Q.gte(v)?Q:v,I.tokenFeeAmountB=se.gte(v)?se:v;for(let ue=0;ue<ae.length;ue++)I.rewardInfos[ue].pendingReward=ae[ue].gte(v)?ae[ue]:v}}if(u.length>0){let l=u.map(d=>d.tokenVault),b=yield Ee(e,l,{batchRequest:r}),y={};for(let d=0;d<l.length;d++){let g=l[d].toString(),P=b[d];if(P===null)continue;let T=Ge.decode(P.data);y[g]=T.amount}for(let d of u){let g=y[d.tokenVault.toString()];d.remainingRewards=g!==void 0?g.sub(d.rewardTotalEmissioned):v}}return m})}static fetchMultiplePoolTickArrays(i){return _(this,arguments,function*({connection:e,poolKeys:t,batchRequest:n}){let r={},o=[];for(let m of t){let u=j.mergeTickArrayBitmap(m.tickArrayBitmap),f=j.getTickArrayStartIndexByTick(m.tickCurrent,m.tickSpacing),l=j.getInitializedTickArrayInRange(u,m.tickSpacing,f,Math.floor(Qn/2));for(let b of l){let{publicKey:y}=Se(m.programId,m.id,b);o.push({pubkey:y}),r[y.toString()]=m.id}}let s=yield _t(e,o,{batchRequest:n}),a={};for(let m of s){if(!m.accountInfo)continue;let u=r[m.pubkey.toString()];if(!u)continue;a[u]===void 0&&(a[u]={});let f=Wt.decode(m.accountInfo.data);a[u][f.startTickIndex]=oe(U({},f),{address:m.pubkey})}return a})}static getWhiteListMint(n){return _(this,arguments,function*({connection:e,programId:t}){let i=yield e.getAccountInfo(fn(t).publicKey);return i?go.decode(i.data).whitelistMints.filter(o=>!o.equals(qe.default)):[]})}};import{PublicKey as Pn,Transaction as nt}from"@solana/web3.js";import Qt from"bn.js";import{TOKEN_PROGRAM_ID as Vo}from"@solana/spl-token";import{PublicKey as st,TransactionInstruction as Uo}from"@solana/web3.js";function Mo(p,e,t,n,i,r,o,s,a,m,u){let f=C([V("instruction"),A("amountIn"),A("amountOut")]),l=[{pubkey:pe,isSigner:!1,isWritable:!1},{pubkey:Vo,isSigner:!1,isWritable:!1},{pubkey:new st(String(e.programId)),isSigner:!1,isWritable:!1},{pubkey:new st(String(e.id)),isSigner:!1,isWritable:!0},{pubkey:new st(String(t.id)),isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!0,isWritable:!1}];if(e.version===6){let y=e;l.push({pubkey:y.ammConfig.id,isSigner:!1,isWritable:!1},{pubkey:y.id,isSigner:!1,isWritable:!0},{pubkey:y.mintA.mint.equals(s)?y.mintA.vault:y.mintB.vault,isSigner:!1,isWritable:!0},{pubkey:y.mintA.mint.equals(s)?y.mintB.vault:y.mintA.vault,isSigner:!1,isWritable:!0},{pubkey:y.observationId,isSigner:!1,isWritable:!0},...u.map(d=>({pubkey:d,isSigner:!1,isWritable:!0})))}else if(e.version===5){let y=xe(e);l.push({pubkey:y.authority,isSigner:!1,isWritable:!1},{pubkey:y.marketProgramId,isSigner:!1,isWritable:!1},{pubkey:y.id,isSigner:!1,isWritable:!0},{pubkey:new st("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),isSigner:!1,isWritable:!1},{pubkey:y.openOrders,isSigner:!1,isWritable:!0},{pubkey:y.baseVault,isSigner:!1,isWritable:!0},{pubkey:y.quoteVault,isSigner:!1,isWritable:!0},{pubkey:y.marketId,isSigner:!1,isWritable:!0},{pubkey:y.marketBids,isSigner:!1,isWritable:!0},{pubkey:y.marketAsks,isSigner:!1,isWritable:!0},{pubkey:y.marketEventQueue,isSigner:!1,isWritable:!0},{pubkey:y.id,isSigner:!1,isWritable:!0},{pubkey:y.id,isSigner:!1,isWritable:!0})}else if(e.version===4){let y=xe(e);l.push({pubkey:y.authority,isSigner:!1,isWritable:!1},{pubkey:y.marketProgramId,isSigner:!1,isWritable:!1},{pubkey:y.marketAuthority,isSigner:!1,isWritable:!1},{pubkey:y.openOrders,isSigner:!1,isWritable:!0},{pubkey:y.baseVault,isSigner:!1,isWritable:!0},{pubkey:y.quoteVault,isSigner:!1,isWritable:!0},{pubkey:y.marketId,isSigner:!1,isWritable:!0},{pubkey:y.marketBids,isSigner:!1,isWritable:!0},{pubkey:y.marketAsks,isSigner:!1,isWritable:!0},{pubkey:y.marketEventQueue,isSigner:!1,isWritable:!0},...y.marketProgramId.toString()==="srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"?[{pubkey:y.marketBaseVault,isSigner:!1,isWritable:!0},{pubkey:y.marketQuoteVault,isSigner:!1,isWritable:!0}]:[{pubkey:y.id,isSigner:!1,isWritable:!0},{pubkey:y.id,isSigner:!1,isWritable:!0}])}let b=Buffer.alloc(f.span);return f.encode({instruction:4,amountIn:a,amountOut:m},b),new Uo({keys:l,programId:p,data:b})}function vo(p,e,t,n,i,r,o,s,a){let m=C([V("instruction")]),u=[{pubkey:pe,isSigner:!1,isWritable:!1},{pubkey:Vo,isSigner:!1,isWritable:!1},{pubkey:new st(String(t.programId)),isSigner:!1,isWritable:!1},{pubkey:new st(String(t.id)),isSigner:!1,isWritable:!0},{pubkey:new st(String(e.id)),isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!0,isWritable:!1}];if(t.version===6){let l=t;u.push({pubkey:l.ammConfig.id,isSigner:!1,isWritable:!1},{pubkey:l.id,isSigner:!1,isWritable:!0},{pubkey:l.mintA.mint.equals(s)?l.mintA.vault:l.mintB.vault,isSigner:!1,isWritable:!0},{pubkey:l.mintA.mint.equals(s)?l.mintB.vault:l.mintA.vault,isSigner:!1,isWritable:!0},{pubkey:l.observationId,isSigner:!1,isWritable:!0},...a.map(b=>({pubkey:b,isSigner:!1,isWritable:!0})))}else if(t.version===5){let l=xe(t);u.push({pubkey:l.authority,isSigner:!1,isWritable:!1},{pubkey:l.marketProgramId,isSigner:!1,isWritable:!1},{pubkey:l.id,isSigner:!1,isWritable:!0},{pubkey:new st("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),isSigner:!1,isWritable:!1},{pubkey:l.openOrders,isSigner:!1,isWritable:!0},{pubkey:l.baseVault,isSigner:!1,isWritable:!0},{pubkey:l.quoteVault,isSigner:!1,isWritable:!0},{pubkey:l.marketId,isSigner:!1,isWritable:!0},{pubkey:l.marketBids,isSigner:!1,isWritable:!0},{pubkey:l.marketAsks,isSigner:!1,isWritable:!0},{pubkey:l.marketEventQueue,isSigner:!1,isWritable:!0},{pubkey:l.id,isSigner:!1,isWritable:!0},{pubkey:l.id,isSigner:!1,isWritable:!0})}else if(t.version===4){let l=xe(t);u.push({pubkey:l.authority,isSigner:!1,isWritable:!1},{pubkey:l.marketProgramId,isSigner:!1,isWritable:!1},{pubkey:l.marketAuthority,isSigner:!1,isWritable:!1},{pubkey:l.openOrders,isSigner:!1,isWritable:!0},{pubkey:l.baseVault,isSigner:!1,isWritable:!0},{pubkey:l.quoteVault,isSigner:!1,isWritable:!0},{pubkey:l.marketId,isSigner:!1,isWritable:!0},{pubkey:l.marketBids,isSigner:!1,isWritable:!0},{pubkey:l.marketAsks,isSigner:!1,isWritable:!0},{pubkey:l.marketEventQueue,isSigner:!1,isWritable:!0},...l.marketProgramId.toString()==="srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"?[{pubkey:l.marketBaseVault,isSigner:!1,isWritable:!0},{pubkey:l.marketQuoteVault,isSigner:!1,isWritable:!0}]:[{pubkey:l.id,isSigner:!1,isWritable:!0},{pubkey:l.id,isSigner:!1,isWritable:!0}])}let f=Buffer.alloc(m.span);return m.encode({instruction:5},f),new Uo({keys:u,programId:p,data:f})}var Tn=class extends Ie{static getAllRoute({inputMint:e,outputMint:t,apiPoolList:n,ammV3List:i}){var b,y;let r={},o={},s=[],a={};for(let d of i!=null?i:[]){if((d.mintA.mint.equals(e)&&d.mintB.mint.equals(t)||d.mintA.mint.equals(t)&&d.mintB.mint.equals(e))&&(s.push(d),o[d.id.toString()]=d),d.mintA.mint.equals(e)){let g=d.mintB.mint.toString();a[g]===void 0&&(a[g]={in:[],out:[],mDecimals:d.mintB.decimals}),a[g].in.push(d)}if(d.mintB.mint.equals(e)){let g=d.mintA.mint.toString();a[g]===void 0&&(a[g]={in:[],out:[],mDecimals:d.mintA.decimals}),a[g].in.push(d)}if(d.mintA.mint.equals(t)){let g=d.mintB.mint.toString();a[g]===void 0&&(a[g]={in:[],out:[],mDecimals:d.mintB.decimals}),a[g].out.push(d)}if(d.mintB.mint.equals(t)){let g=d.mintA.mint.toString();a[g]===void 0&&(a[g]={in:[],out:[],mDecimals:d.mintA.decimals}),a[g].out.push(d)}}let m=[],u=e.toString(),f=t.toString();for(let d of(b=(n!=null?n:{}).official)!=null?b:[])(d.baseMint===u&&d.quoteMint===f||d.baseMint===f&&d.quoteMint===u)&&(s.push(d),r[d.id]=d,m.push(d)),d.baseMint===u&&(a[d.quoteMint]===void 0&&(a[d.quoteMint]={in:[],out:[],mDecimals:d.quoteDecimals}),a[d.quoteMint].in.push(d)),d.quoteMint===u&&(a[d.baseMint]===void 0&&(a[d.baseMint]={in:[],out:[],mDecimals:d.baseDecimals}),a[d.baseMint].in.push(d)),d.baseMint===f&&(a[d.quoteMint]===void 0&&(a[d.quoteMint]={in:[],out:[],mDecimals:d.quoteDecimals}),a[d.quoteMint].out.push(d)),d.quoteMint===f&&(a[d.baseMint]===void 0&&(a[d.baseMint]={in:[],out:[],mDecimals:d.baseDecimals}),a[d.baseMint].out.push(d));let l=m.length===0;for(let d of(y=(n!=null?n:{}).unOfficial)!=null?y:[])(d.baseMint===u&&d.quoteMint===f||d.baseMint===f&&d.quoteMint===u)&&(s.push(d),r[d.id]=d,l&&m.push(d)),d.baseMint===u&&(a[d.quoteMint]===void 0&&(a[d.quoteMint]={in:[],out:[],mDecimals:d.quoteDecimals}),a[d.quoteMint].in.push(d)),d.quoteMint===u&&(a[d.baseMint]===void 0&&(a[d.baseMint]={in:[],out:[],mDecimals:d.baseDecimals}),a[d.baseMint].in.push(d)),d.baseMint===f&&(a[d.quoteMint]===void 0&&(a[d.quoteMint]={in:[],out:[],mDecimals:d.quoteDecimals}),a[d.quoteMint].out.push(d)),d.quoteMint===f&&(a[d.baseMint]===void 0&&(a[d.baseMint]={in:[],out:[],mDecimals:d.baseDecimals}),a[d.baseMint].out.push(d));for(let d of Object.keys(a)){if(a[d].in.length===1&&a[d].out.length===1&&String(a[d].in[0].id)===String(a[d].out[0].id)){delete a[d];continue}if(a[d].in.length===0||a[d].out.length===0){delete a[d];continue}let g=a[d];for(let P of g.in)for(let T of g.out)P.version===6&&o[P.id.toString()]===void 0?o[P.id.toString()]=P:P.version!==6&&r[P.id]===void 0&&(r[P.id]=P),T.version===6&&o[T.id.toString()]===void 0?o[T.id.toString()]=T:T.version!==6&&r[T.id]===void 0&&(r[T.id]=T)}return{directPath:s,addLiquidityPools:m,routePathDict:a,needSimulate:Object.values(r),needTickArray:Object.values(o)}}static fetchMultipleInfo(i){return _(this,arguments,function*({connection:e,pools:t,batchRequest:n=!0}){t.find(a=>a.version===5)&&(yield Wn(e));let r=t.map(a=>ye.makeSimulatePoolInfoInstruction({poolKeys:xe(a)})),o=yield tn(e,r,"GetPoolData",n),s={};for(let a of o){let m=nn(a,"GetPoolData"),u=JSON.parse(m).amm_id,f=new Qt(ge(m,"status")),l=Number(ge(m,"coin_decimals")),b=Number(ge(m,"pc_decimals")),y=Number(ge(m,"lp_decimals")),d=new Qt(ge(m,"pool_coin_amount")),g=new Qt(ge(m,"pool_pc_amount")),P=new Qt(ge(m,"pool_lp_supply")),T="0";try{T=ge(m,"pool_open_time")}catch(L){}s[u]={ammId:u,status:f,baseDecimals:l,quoteDecimals:b,lpDecimals:y,baseReserve:d,quoteReserve:g,lpSupply:P,startTime:new Qt(T)}}return s})}static getAddLiquidityDefaultPool({addLiquidityPools:e,poolInfosCache:t}){if(e.length===0)return;if(e.length===1||(e.sort((i,r)=>r.version-i.version),e[0].version!==e[1].version))return e[0];let n=e.filter(i=>i.version===e[0].version);return n.sort((i,r)=>this.ComparePoolSize(i,r,t)),n[0]}static ComparePoolSize(e,t,n){let i=n[e.id],r=n[t.id];return i===void 0?1:r===void 0?-1:e.baseMint===t.baseMint?i.baseReserve.sub(r.baseReserve).gte(v)?-1:1:i.baseReserve.sub(r.quoteReserve).gte(v)?-1:1}static getAllRouteComputeAmountOut({inputTokenAmount:e,outputToken:t,directPath:n,routePathDict:i,simulateCache:r,tickCache:o,slippage:s,chainTime:a}){let m=e,u=[];for(let f of n)if(f.version===6)try{let{amountOut:l,minAmountOut:b,currentPrice:y,executionPrice:d,priceImpact:g,fee:P,remainingAccounts:T}=tt.computeAmountOutFormat({poolInfo:f,tickArrayCache:o[f.id.toString()],amountIn:m,currencyOut:t,slippage:s});u.push({amountIn:m,amountOut:l,minAmountOut:b,currentPrice:y,executionPrice:d,priceImpact:g,fee:[P],remainingAccounts:[T],routeType:"amm",poolKey:[f],middleMint:void 0,poolReady:!0,poolType:"CLMM"})}catch(l){}else try{if(![1,6,7].includes(r[f.id].status.toNumber()))continue;let{amountOut:l,minAmountOut:b,currentPrice:y,executionPrice:d,priceImpact:g,fee:P}=ye.computeAmountOut({poolKeys:xe(f),poolInfo:r[f.id],amountIn:m,currencyOut:t,slippage:s});u.push({amountIn:m,amountOut:l,minAmountOut:b,currentPrice:y,executionPrice:d,priceImpact:g,fee:[P],routeType:"amm",poolKey:[f],remainingAccounts:[],middleMint:void 0,poolReady:r[f.id].startTime.toNumber()<a,poolType:f.version===5?"STABLE":void 0})}catch(l){}for(let[f,l]of Object.entries(i))for(let b of l.in)if(!(!r[b.id]&&!o[b.id.toString()])&&!(b.version!==6&&![1,6,7].includes(r[b.id].status.toNumber()))){for(let y of l.out)if(!(!r[y.id]&&!o[y.id.toString()])&&!(y.version!==6&&![1,6,7].includes(r[y.id].status.toNumber())))try{let{amountOut:d,minAmountOut:g,executionPrice:P,priceImpact:T,fee:L,remainingAccounts:k}=Tn.computeAmountOut({middleMintInfo:{mint:new Pn(f),decimals:l.mDecimals},amountIn:m,currencyOut:t,slippage:s,fromPool:b,toPool:y,simulateCache:r,tickCache:o}),I=b.version===6?!0:r[b.id].startTime.toNumber()<a,D=y.version===6?!0:r[y.id].startTime.toNumber()<a,h=b.version===6?"CLMM":b.version===5?"STABLE":void 0,O=y.version===6?"CLMM":y.version===5?"STABLE":void 0;u.push({amountIn:m,amountOut:d,minAmountOut:g,currentPrice:void 0,executionPrice:P,priceImpact:T,fee:L,routeType:"route",poolKey:[b,y],remainingAccounts:k,middleMint:new Pn(f),poolReady:I&&D,poolType:[h,O]})}catch(d){}}return u.sort((f,l)=>f.amountOut.raw.sub(l.amountOut.raw).gt(v)?-1:1),u}static computeAmountOut({middleMintInfo:e,amountIn:t,currencyOut:n,slippage:i,fromPool:r,toPool:o,simulateCache:s,tickCache:a}){let m=new B(e.mint,e.decimals),u,f,l,b,y=new Ae(0,100);if(r.version===6){let{minAmountOut:O,priceImpact:M,fee:H,remainingAccounts:te}=tt.computeAmountOutFormat({poolInfo:r,tickArrayCache:a[r.id.toString()],amountIn:t,currencyOut:m,slippage:y});u=O,f=M,l=H,b=te}else{let{minAmountOut:O,priceImpact:M,fee:H}=ye.computeAmountOut({poolKeys:xe(r),poolInfo:s[r.id],amountIn:t,currencyOut:m,slippage:y});u=O,f=M,l=H}let d,g,P,T,L;if(o.version===6){let{amountOut:O,minAmountOut:M,priceImpact:H,fee:te,remainingAccounts:Q}=tt.computeAmountOutFormat({poolInfo:o,tickArrayCache:a[o.id.toString()],amountIn:u,currencyOut:n,slippage:i});d=O,g=M,P=H,T=te,L=Q}else{let{amountOut:O,minAmountOut:M,priceImpact:H,fee:te}=ye.computeAmountOut({poolKeys:xe(o),poolInfo:s[o.id],amountIn:u,currencyOut:n,slippage:i});d=O,g=M,P=H,T=te}let k=null,I=t.raw,D=d.raw,h=t instanceof q?t.token:t.currency;return!I.isZero()&&!D.isZero()&&(k=new le(h,I,n,D)),{minMiddleAmountOut:u,amountOut:d,minAmountOut:g,executionPrice:k,priceImpact:f.add(P),fee:[l,T],remainingAccounts:[b,L]}}static makeSwapInstruction({routeProgram:e,ownerInfo:t,inputMint:n,swapInfo:i}){if(i.routeType==="amm")if(i.poolKey[0].version===6){let r=i.poolKey[0],o=n.equals(r.mintA.mint)?ve.add(ie):Ke.sub(ie);return tt.makeSwapBaseInInstructions({poolInfo:r,ownerInfo:{wallet:t.wallet,tokenAccountA:r.mintA.mint.equals(n)?t.sourceToken:t.destinationToken,tokenAccountB:r.mintA.mint.equals(n)?t.destinationToken:t.sourceToken},inputMint:n,amountIn:i.amountIn.raw,amountOutMin:i.minAmountOut.raw,sqrtPriceLimitX64:o,remainingAccounts:i.remainingAccounts[0]})}else{let r=i.poolKey[0];return{signers:[],instructions:[ye.makeSwapInstruction({poolKeys:xe(r),userKeys:{tokenAccountIn:t.sourceToken,tokenAccountOut:t.destinationToken,owner:t.wallet},amountIn:i.amountIn.raw,amountOut:i.minAmountOut.raw,fixedSide:"in"})],address:{}}}else if(i.routeType==="route"){let r=i.poolKey[0],o=i.poolKey[1];return{signers:[],instructions:[Mo(e,r,o,t.sourceToken,t.routeToken,t.userPdaAccount,t.wallet,n,i.amountIn.raw,i.minAmountOut.raw,i.remainingAccounts[0]),vo(e,r,o,t.routeToken,t.destinationToken,t.userPdaAccount,t.wallet,i.middleMint,i.remainingAccounts[1])],address:{}}}else throw Error("route type error")}static makeSwapTranscation(r){return _(this,arguments,function*({connection:e,swapInfo:t,ownerInfo:n,checkTransaction:i}){let o=[],s=[],a=[],m=t.amountIn,u=t.amountOut,f=!(m instanceof q),l=!(u instanceof q),b=m instanceof q?m.token.mint:B.WSOL.mint,y=t.middleMint,d=u instanceof q?u.token.mint:B.WSOL.mint,g=new Pn("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),P=yield this._selectOrCreateTokenAccount({mint:b,tokenAccounts:f?[]:n.tokenAccounts,createInfo:f?{connection:e,payer:n.wallet,amount:m.raw,frontInstructions:o,endInstructions:s,signers:a}:void 0,owner:n.wallet,associatedOnly:f?!1:n.associatedOnly});if(P===void 0)throw Error("input account check error");let T=yield this._selectOrCreateTokenAccount({mint:d,tokenAccounts:n.tokenAccounts,createInfo:{connection:e,payer:n.wallet,amount:0,frontInstructions:o,endInstructions:l?s:void 0,signers:a},owner:n.wallet,associatedOnly:n.associatedOnly}),L;t.routeType==="route"&&(L=yield this._selectOrCreateTokenAccount({mint:y,tokenAccounts:n.tokenAccounts,createInfo:{connection:e,payer:n.wallet,amount:0,frontInstructions:o,endInstructions:s,signers:a},owner:n.wallet,associatedOnly:!1}));let k=this.makeSwapInstruction({routeProgram:g,inputMint:b,swapInfo:t,ownerInfo:{wallet:n.wallet,sourceToken:P,routeToken:L,destinationToken:T,userPdaAccount:t.poolKey.length===2?dt.getAssociatedMiddleStatusAccount({programId:g,fromPoolId:new Pn(String(t.poolKey[0].id)),owner:n.wallet,middleMint:t.middleMint}):void 0}}),I=[],D=[...o,...k.instructions,...s],h=[...a,...k.signers];if(i)if(ct(D,[n.wallet,...h.map(O=>O.publicKey)]))I.push({transaction:new nt().add(...D),signer:h});else{if(o.length>0&&I.push({transaction:new nt().add(...o),signer:[...a]}),ct(k.instructions,[n.wallet]))I.push({transaction:new nt().add(...k.instructions),signer:[...k.signers]});else for(let O of k.instructions)I.push({transaction:new nt().add(O),signer:[...k.signers]});s.length>0&&I.push({transaction:new nt().add(...s),signer:[]})}else t.routeType==="amm"?I.push({transaction:new nt().add(...D),signer:h}):(o.length>0&&I.push({transaction:new nt().add(...o),signer:[...a]}),I.push({transaction:new nt().add(...k.instructions),signer:[...k.signers]}),s.length>0&&I.push({transaction:new nt().add(...s),signer:[]}));return{transactions:I,address:U({},k.address)}})}};import{createInitializeAccountInstruction as Ko}from"@solana/spl-token";import{Keypair as yt,PublicKey as wa,SystemProgram as bt,Transaction as qo,TransactionInstruction as La}from"@solana/web3.js";import zt from"bn.js";function Ia(p="accountFlags"){let e=new mn(p);return e.addBoolean("initialized"),e.addBoolean("market"),e.addBoolean("openOrders"),e.addBoolean("requestQueue"),e.addBoolean("eventQueue"),e.addBoolean("bids"),e.addBoolean("asks"),e}var Fo=C([ce(5),Ia("accountFlags"),R("ownAddress"),A("vaultSignerNonce"),R("baseMint"),R("quoteMint"),R("baseVault"),A("baseDepositsTotal"),A("baseFeesAccrued"),R("quoteVault"),A("quoteDepositsTotal"),A("quoteFeesAccrued"),A("quoteDustThreshold"),R("requestQueue"),R("eventQueue"),R("bids"),R("asks"),A("baseLotSize"),A("quoteLotSize"),A("feeRateBps"),A("referrerRebatesAccrued"),ce(7)]),Wo=class extends Ie{static makeCreateMarketTransaction(a){return _(this,arguments,function*({connection:e,wallet:t,baseInfo:n,quoteInfo:i,lotSize:r,tickSize:o,dexProgramId:s}){let m=yt.generate(),u=yt.generate(),f=yt.generate(),l=yt.generate(),b=yt.generate(),y=yt.generate(),d=yt.generate(),g=0,P=new zt(100);function T(){let h=new zt(0);for(;;)try{return{vaultOwner:wa.createProgramAddressSync([m.publicKey.toBuffer(),h.toArrayLike(Buffer,"le",8)],s),vaultSignerNonce:h}}catch(O){if(h.iaddn(1),h.gt(new zt(25555)))throw Error("find vault owner error")}}let{vaultOwner:L,vaultSignerNonce:k}=T(),I=new zt(Math.round(Fe(10,n.decimals)*r)),D=new zt(Math.round(r*Fe(10,i.decimals)*o));if(I.eq(v))throw Error("lot size is too small");if(D.eq(v))throw Error("tick size or lot size is too small");return{transactions:yield this.makeCreateMarketInstruction({connection:e,wallet:t,marketInfo:{programId:s,id:m,baseMint:n.mint,quoteMint:i.mint,baseVault:y,quoteVault:d,vaultOwner:L,requestQueue:u,eventQueue:f,bids:l,asks:b,feeRateBps:g,quoteDustThreshold:P,vaultSignerNonce:k,baseLotSize:I,quoteLotSize:D}}),address:{id:m.publicKey}}})}static makeCreateMarketInstruction(i){return _(this,arguments,function*({connection:e,wallet:t,marketInfo:n}){let r=new qo;r.add(bt.createAccount({fromPubkey:t,newAccountPubkey:n.baseVault.publicKey,lamports:yield e.getMinimumBalanceForRentExemption(165),space:165,programId:W}),bt.createAccount({fromPubkey:t,newAccountPubkey:n.quoteVault.publicKey,lamports:yield e.getMinimumBalanceForRentExemption(165),space:165,programId:W}),Ko(n.baseVault.publicKey,n.baseMint,n.vaultOwner),Ko(n.quoteVault.publicKey,n.quoteMint,n.vaultOwner));let o=new qo;return o.add(bt.createAccount({fromPubkey:t,newAccountPubkey:n.id.publicKey,lamports:yield e.getMinimumBalanceForRentExemption(Fo.span),space:Fo.span,programId:n.programId}),bt.createAccount({fromPubkey:t,newAccountPubkey:n.requestQueue.publicKey,lamports:yield e.getMinimumBalanceForRentExemption(5120+12),space:5120+12,programId:n.programId}),bt.createAccount({fromPubkey:t,newAccountPubkey:n.eventQueue.publicKey,lamports:yield e.getMinimumBalanceForRentExemption(262144+12),space:262144+12,programId:n.programId}),bt.createAccount({fromPubkey:t,newAccountPubkey:n.bids.publicKey,lamports:yield e.getMinimumBalanceForRentExemption(65536+12),space:65536+12,programId:n.programId}),bt.createAccount({fromPubkey:t,newAccountPubkey:n.asks.publicKey,lamports:yield e.getMinimumBalanceForRentExemption(65536+12),space:65536+12,programId:n.programId}),this.initializeMarket({programId:n.programId,marketInfo:{id:n.id.publicKey,requestQueue:n.requestQueue.publicKey,eventQueue:n.eventQueue.publicKey,bids:n.bids.publicKey,asks:n.asks.publicKey,baseVault:n.baseVault.publicKey,quoteVault:n.quoteVault.publicKey,baseMint:n.baseMint,quoteMint:n.quoteMint,baseLotSize:n.baseLotSize,quoteLotSize:n.quoteLotSize,feeRateBps:n.feeRateBps,vaultSignerNonce:n.vaultSignerNonce,quoteDustThreshold:n.quoteDustThreshold}})),[{transaction:r,signer:[n.baseVault,n.quoteVault]},{transaction:o,signer:[n.id,n.requestQueue,n.eventQueue,n.bids,n.asks]}]})}static initializeMarket({programId:e,marketInfo:t}){let n=C([V("version"),he("instruction"),A("baseLotSize"),A("quoteLotSize"),rt("feeRateBps"),A("vaultSignerNonce"),A("quoteDustThreshold")]),i=[{pubkey:t.id,isSigner:!1,isWritable:!0},{pubkey:t.requestQueue,isSigner:!1,isWritable:!0},{pubkey:t.eventQueue,isSigner:!1,isWritable:!0},{pubkey:t.bids,isSigner:!1,isWritable:!0},{pubkey:t.asks,isSigner:!1,isWritable:!0},{pubkey:t.baseVault,isSigner:!1,isWritable:!0},{pubkey:t.quoteVault,isSigner:!1,isWritable:!0},{pubkey:t.baseMint,isSigner:!1,isWritable:!1},{pubkey:t.quoteMint,isSigner:!1,isWritable:!1},{pubkey:t.authority?t.quoteMint:Oe,isSigner:!1,isWritable:!1}].concat(t.authority?{pubkey:t.authority,isSigner:!1,isWritable:!1}:[]).concat(t.authority&&t.pruneAuthority?{pubkey:t.pruneAuthority,isSigner:!1,isWritable:!1}:[]),r=Buffer.alloc(n.span);return n.encode({version:0,instruction:0,baseLotSize:t.baseLotSize,quoteLotSize:t.quoteLotSize,feeRateBps:t.feeRateBps,vaultSignerNonce:t.vaultSignerNonce,quoteDustThreshold:t.quoteDustThreshold},r),new La({keys:i,programId:e,data:r})}};import{PublicKey as ha,Transaction as Jt,TransactionInstruction as Ra}from"@solana/web3.js";import Go from"bn.js";var kn=class extends Ie{static getPdaPoolId(e,t){return ne([this.SEED_CONFIG.pool.id,t.toBuffer()],e)}static getPdaOwnerId(e,t,n,i){return ne([this.SEED_CONFIG.owner.id,t.toBuffer(),n.toBuffer(),Buffer.from(new Go(i).toArray())],e)}static getAllInfo(o){return _(this,arguments,function*({connection:e,programId:t,poolIds:n,wallet:i,chainTime:r}){if(n.length===0)return[];let s=n.map(f=>this.getPdaPoolId(t,f).publicKey),a=[];for(let f=0;f<this.VERSION_PROJECT.length;f++)a.push(...s.map(l=>this.getPdaOwnerId(t,l,i,f).publicKey));let m=yield Ee(e,[...s,...a]),u=[];for(let f=0;f<m.length;f++){let l=Math.floor(f/n.length),b=f%n.length,y=s[b],d=a[f],g=m[b],P=m[n.length+f];if(!(g&&P)||g.data.length!==this.POOL_LAYOUT.span||P.data.length!==this.OWNER_LAYOUT.span)continue;let T=this.POOL_LAYOUT.decode(g.data),L=this.OWNER_LAYOUT.decode(P.data),k=T.openTime.toNumber(),I=T.endTime.toNumber(),D=L.tokenInfo.map(M=>M.debtAmount.gt(new Go(0))).filter(M=>!M).length!==3,h=r>k&&r<I&&T.status===1,O=D&&h;u.push({programId:t,poolId:y,ammId:T.ammId,ownerAccountId:d,snapshotLpAmount:L.lpAmount,project:this.VERSION_PROJECT[l],openTime:k,endTime:I,canClaim:O,canClaimErrorType:D?h?void 0:"outOfOperationalTime":"alreadyClaimIt",tokenInfo:T.tokenInfo.map((M,H)=>({mintAddress:M.mintAddress,mintVault:M.mintVault,mintDecimals:M.mintDecimals,perLpLoss:M.perLpLoss,debtAmount:L.tokenInfo[H].debtAmount.add(L.tokenInfo[H].claimedAmount)}))})}return u})}static makeClaimTransaction(i){return _(this,arguments,function*({connection:e,poolInfo:t,ownerInfo:n}){let r=[],o=[],s=[],a=[],m=[];for(let u of t.tokenInfo)m.push(yield this._selectOrCreateTokenAccount({mint:u.mintAddress,tokenAccounts:u.mintAddress.equals(B.WSOL.mint)?[]:n.tokenAccounts,owner:n.wallet,createInfo:{connection:e,payer:n.wallet,amount:0,frontInstructions:r,endInstructions:u.mintAddress.equals(B.WSOL.mint)?o:[],signers:a},associatedOnly:u.mintAddress.equals(B.WSOL.mint)?!1:n.associatedOnly}));return s.push(this.makeClaimInstruction({programId:t.programId,poolInfo:t,ownerInfo:{wallet:n.wallet,ownerPda:t.ownerAccountId,claimAddress:m}})),[{transaction:new Jt().add(...r,...s,...o),signer:a}]})}static makeClaimAllTransaction(i){return _(this,arguments,function*({connection:e,poolInfos:t,ownerInfo:n}){var u;let r=[],o=[],s=[],a=[],m={};for(let f of t){let l=[];for(let b of f.tokenInfo){let y=(u=m[b.mintAddress.toString()])!=null?u:yield this._selectOrCreateTokenAccount({mint:b.mintAddress,tokenAccounts:b.mintAddress.equals(B.WSOL.mint)?[]:n.tokenAccounts,owner:n.wallet,createInfo:{connection:e,payer:n.wallet,amount:0,frontInstructions:r,endInstructions:b.mintAddress.equals(B.WSOL.mint)?o:[],signers:a},associatedOnly:b.mintAddress.equals(B.WSOL.mint)?!1:n.associatedOnly});m[b.mintAddress.toString()]=y,l.push(y)}s.push(this.makeClaimInstruction({programId:f.programId,poolInfo:f,ownerInfo:{wallet:n.wallet,ownerPda:f.ownerAccountId,claimAddress:l}}))}return ct([...r,...s,...o],[n.wallet,...a.map(f=>f.publicKey)])?[{transaction:new Jt().add(...r,...s,...o),signer:a}]:[{transaction:new Jt().add(...r),signer:a},{transaction:new Jt().add(...s),signer:[]},{transaction:new Jt().add(...o),signer:[]}]})}static makeClaimInstruction({programId:e,poolInfo:t,ownerInfo:n}){let i=C([]),r=[{pubkey:n.wallet,isSigner:!0,isWritable:!0},{pubkey:t.poolId,isSigner:!1,isWritable:!0},{pubkey:n.ownerPda,isSigner:!1,isWritable:!0},...n.claimAddress.map(a=>({pubkey:a,isSigner:!1,isWritable:!0})),...t.tokenInfo.map(({mintVault:a})=>({pubkey:a,isSigner:!1,isWritable:!0})),{pubkey:W,isSigner:!1,isWritable:!1}],o=Buffer.alloc(i.span);i.encode({},o);let s=Buffer.from([10,66,208,184,161,6,191,98,...o]);return new Ra({keys:r,programId:e,data:s})}},at=kn;at.CLAIMED_NUM=3,at.POOL_LAYOUT=C([ce(8),V("bump"),V("status"),A("openTime"),A("endTime"),R("ammId"),F(C([V("mintDecimals"),R("mintAddress"),R("mintVault"),A("perLpLoss"),A("totalClaimedAmount")]),kn.CLAIMED_NUM,"tokenInfo"),F(A(),10,"padding")]),at.OWNER_LAYOUT=C([ce(8),V("bump"),V("version"),R("poolId"),R("owner"),A("lpAmount"),F(C([R("mintAddress"),A("debtAmount"),A("claimedAmount")]),kn.CLAIMED_NUM,"tokenInfo"),F(A(),4,"padding")]),at.DEFAULT_POOL_ID=["58oQChx4yWmvKdwLLZzBi4ChoCc2fqCUWBkwMihLYQo2","6UmmUiYoBjSrhakAobJw8BvkmJtDVxaeBtbt7rxWo1mg","AVs9TA4nWDzfPJE9gGVNJMVhcQy3V9PGazuz33BfG2RA","DVa7Qmb5ct9RCpaU7UTpSaf3GVMYz17vNVU67XpdCRut","7XawhbbxtsRcQA8KTkHT9f9nc6d69UwqCDh6U5EEbEmX","6a1CsrpeZubDjEJE9s1CMVheB6HWM5d7m1cj2jkhyXhj","EoNrn8iUhwgJySD1pHu8Qxm5gSQqLK3za4m8xzD2RuEb","AceAyRTWt4PyB2pHqf2qhDgNZDtKVNaxgL8Ru3V4aN1P","6tmFJbMk5yVHFcFy7X2K8RwHjKLr6KVFLYXpgpBNeAxB"].map(e=>new ha(e)),at.SEED_CONFIG={pool:{id:Buffer.from("pool_seed","utf8")},owner:{id:Buffer.from("user_claim_seed","utf8")}},at.VERSION_PROJECT=[void 0,"Francium","Tulip"];export{ls as AMM_CONFIG_SEED,ci as ASSOCIATED_TOKEN_PROGRAM_ID,S as AccountMeta,w as AccountMetaReadonly,Df as AmmConfigLayout,tt as AmmV3,Do as BIT_PRECISION,Tt as BNLayout,Ie as Base,ju as BitStructure,Pi as Blob,We as Currency,me as CurrencyAmount,xd as DEVNET_FARM_POOLS,Uc as DEVNET_LP_TOKENS,Bp as DEVNET_OFFICIAL_LIQUIDITY_POOLS,Vc as DEVNET_SPL_TOKENS,ea as DataElement,ri as ErrorCode,ed as FARM_LEDGER_LAYOUT_V3_1,Ks as FARM_LEDGER_LAYOUT_V3_2,td as FARM_LEDGER_LAYOUT_V5_1,qs as FARM_LEDGER_LAYOUT_V5_2,Fs as FARM_LEDGER_LAYOUT_V6_1,Vi as FARM_PROGRAMID_TO_VERSION,Ds as FARM_PROGRAM_ID_V3,Ns as FARM_PROGRAM_ID_V5,Os as FARM_PROGRAM_ID_V6,Ms as FARM_STATE_LAYOUT_V3,vs as FARM_STATE_LAYOUT_V5,yn as FARM_STATE_LAYOUT_V6,vi as FARM_VERSION_TO_LEDGER_LAYOUT,Ui as FARM_VERSION_TO_PROGRAMID,Mi as FARM_VERSION_TO_STATE_LAYOUT,gn as FEE_RATE_DENOMINATOR,Qn as FETCH_TICKARRAY_COUNT,wc as FIVE,Je as Farm,ga as Fee,re as Fraction,Fn as LIQUIDITY_FEES_DENOMINATOR,io as LIQUIDITY_FEES_NUMERATOR,Wi as LIQUIDITY_PROGRAMID_TO_VERSION,Ys as LIQUIDITY_PROGRAM_ID_V4,Xs as LIQUIDITY_PROGRAM_ID_V5,Hs as LIQUIDITY_STATE_LAYOUT_V4,Qs as LIQUIDITY_STATE_LAYOUT_V5,Gi as LIQUIDITY_VERSION_TO_PROGRAMID,Yi as LIQUIDITY_VERSION_TO_SERUM_VERSION,Kn as LIQUIDITY_VERSION_TO_STATE_LAYOUT,No as LOG_B_2_X32,Oo as LOG_B_P_ERR_MARGIN_LOWER_X64,_o as LOG_B_P_ERR_MARGIN_UPPER_X64,Ut as Layout,ye as Liquidity,$ as LiquidityMath,la as LiquidityPoolStatus,oi as LogLevel,z as Logger,hd as MAINNET_FARM_POOLS,x as MAINNET_LP_TOKENS,Rp as MAINNET_OFFICIAL_LIQUIDITY_POOLS,c as MAINNET_SPL_TOKENS,Fo as MARKET_STATE_LAYOUT_V2,Zs as MARKET_STATE_LAYOUT_V3,zi as MARKET_VERSION_TO_STATE_LAYOUT,Ke as MAX_SQRT_PRICE_X64,Yt as MAX_TICK,Co as MAX_TICK_ARRAY_START_INDEX,Va as MEMO_PROGRAM_ID,Dt as METADATA_PROGRAM_ID,ve as MIN_SQRT_PRICE_X64,ht as MIN_TICK,Bo as MIN_TICK_ARRAY_START_INDEX,wt as Market,Wo as MarketV2,G as MathUtil,Hn as MaxU64,xo as MaxUint128,ta as ModelDataInfo,Ze as ModelDataPubkey,et as NEGATIVE_ONE,ie as ONE,bs as OPERATION_SEED,Yn as ObservationInfoLayout,fa as ObservationLayout,go as OperationLayout,_n as OptionLayout,fs as POOL_REWARD_VAULT_SEED,ds as POOL_SEED,ps as POOL_VAULT_SEED,Ri as POSITION_SEED,Ae as Percent,bo as PoolInfoLayout,xt as PoolUtils,Ao as PositionInfoLayout,ba as PositionRewardInfoLayout,Ht as PositionUtils,le as Price,Nf as ProtocolPositionLayout,An as Q128,Ye as Q64,_s as REAL_FARM_STATE_LAYOUT_V3,Es as REAL_FARM_STATE_LAYOUT_V5,Us as REAL_FARM_STATE_LAYOUT_V6,en as RENT_PROGRAM_ID,ro as ROUTE_PROGRAMID_TO_VERSION,Ft as ROUTE_PROGRAM_ID_V1,ao as ROUTE_VERSION_TO_LIQUIDITY_VERSION,so as ROUTE_VERSION_TO_PROGRAMID,ya as RewardInfo,hn as Rounding,dt as Route,Hi as SERUM_PROGRAMID_TO_VERSION,Js as SERUM_PROGRAM_ID_V3,Qi as SERUM_VERSION_TO_PROGRAMID,St as SOL,Ge as SPL_ACCOUNT_LAYOUT,Hm as SPL_MINT_LAYOUT,pe as SYSTEM_PROGRAM_ID,Nt as SYSVAR_CLOCK_PUBKEY,Oe as SYSVAR_RENT_PUBKEY,ee as Spl,Y as SqrtPriceMath,En as Structure,ft as SwapMath,He as TEN,Rd as TESTNET_FARM_POOLS,Fc as TESTNET_LP_TOKENS,xp as TESTNET_OFFICIAL_LIQUIDITY_POOLS,qc as TESTNET_SPL_TOKENS,kc as THREE,Gn as TICK_ARRAY_BITMAP_SIZE,ys as TICK_ARRAY_SEED,Te as TICK_ARRAY_SIZE,Ff as TICK_SPACINGS,W as TOKEN_PROGRAM_ID,Tc as TWO,Wt as TickArrayLayout,Aa as TickLayout,Rt as TickMath,Sn as TickQuery,j as TickUtils,B as Token,q as TokenAmount,yi as TokenList,fo as Trade,Tn as TradeV2,Gt as U64Resolution,Dn as UInt,Vn as Union,at as Utils1216,fe as WSOL,mn as WideBits,ze as WrappedLayout,v as ZERO,pi as _100,Lc as _1000,Ic as _10000,Ai as _100_PERCENT,Oi as _FARM_PROGRAM_ID_V3,_i as _FARM_PROGRAM_ID_V5,Ei as _FARM_PROGRAM_ID_V6,qi as _LIQUIDITY_PROGRAM_ID_V4,Fi as _LIQUIDITY_PROGRAM_ID_V5,oo as _ROUTE_PROGRAM_ID_V1,Xi as _SERUM_PROGRAM_ID_V3,Ce as addComputations,vm as array,Nn as bits,ce as blob,ln as bool,di as chunkArray,ko as closePositionInstruction,Ro as collectRewardInstruction,Po as createPoolInstruction,Rm as cstr,Qe as currencyEquals,as as decodeBool,Lo as decreaseLiquidityInstruction,xn as divCeil,cs as encodeBool,km as f32,wm as f32be,Lm as f64,Im as f64be,ne as findProgramAddress,ct as forecastTransactionSize,eo as formatLayout,Ue as getATAAddress,$i as getDxByDyBaseIn,ji as getDyByDxBaseIn,Ee as getMultipleAccountsInfo,_t as getMultipleAccountsInfoWithCustomFlags,tl as getPdaAmmConfigId,Ci as getPdaMetadataKey,fn as getPdaOperationAccount,kt as getPdaPersonalPositionAddress,xi as getPdaPoolId,Bi as getPdaPoolRewardVaulId,Mn as getPdaPoolVaultId,pn as getPdaProtocolPositionAddress,Se as getPdaTickArrayAddress,to as getStablePrice,$u as greedy,Ii as i128,zm as i16ToBytes,dn as i32ToBytes,Om as i64,wo as increaseLiquidityInstruction,Io as initRewardInstruction,Wn as initStableModelLayout,Ha as inspectAll,or as inspectBN,iu as inspectCurrency,ir as inspectPublicKey,ou as inspectToken,za as intersection,xe as jsonInfo2PoolKeys,ym as ns64,Tm as ns64be,im as nu64,um as nu64be,On as offset,To as openPositionInstruction,_m as option,E as parseBigNumberish,nn as parseSimulateLogToJson,ge as parseSimulateValue,ui as poolKeys2JsonInfo,vt as poolTypeV6,R as publicKey,Mm as rustEnum,lm as s16,bm as s16be,dm as s24,Am as s24be,Be as s32,gm as s32be,pm as s40,Sm as s40be,fm as s48,Pm as s48be,mm as s8,F as seq,ho as setRewardInstruction,tn as simulateMultipleInstruction,rr as simulateTransaction,pr as splitNumber,gt as splitTxAndSigners,Um as str,C as struct,Xn as swapInstruction,Vm as tagged,Rn as tenExponentiate,K as u128,rt as u16,hi as u16ToBytes,om as u16be,em as u24,rm as u24be,he as u32,Jm as u32ToBytes,sm as u32be,tm as u40,am as u40be,nm as u48,cm as u48be,A as u64,V as u8,Km as union,hm as unionLayoutDiscriminator,Za as uniq,Fl as unwarpSol,xm as utf8,it as validateAndParsePublicKey,Em as vec,us as vecU8,Ja as xor,qm as zeros};
//# sourceMappingURL=index.mjs.map